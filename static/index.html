<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI Hub</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/matlab.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/marked/12.0.0/marked.min.js"></script>
<style>
:root{--bg:#0f0f1a;--bg2:#1a1a2e;--bg3:#252542;--text:#e8e8f0;--text2:#8888a0;--accent:#6366f1;--accent2:#818cf8;--success:#22c55e;--warning:#f59e0b;--error:#ef4444;--border:#2d2d4a}
[data-theme="light"]{--bg:#f8f9fa;--bg2:#ffffff;--bg3:#e9ecef;--text:#212529;--text2:#6c757d;--border:#dee2e6}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:var(--bg);color:var(--text);height:100vh;display:flex;overflow:hidden}
::-webkit-scrollbar{width:6px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:var(--border);border-radius:3px}
.nav{width:220px;background:var(--bg2);display:flex;flex-direction:column;border-right:1px solid var(--border);flex-shrink:0}
.nav-header{padding:20px 16px;border-bottom:1px solid var(--border)}
.nav-logo{display:flex;align-items:center;gap:10px;font-size:18px;font-weight:600}
.nav-section{padding:12px 8px}
.nav-section-title{font-size:11px;color:var(--text2);padding:8px 12px;text-transform:uppercase;letter-spacing:1px}
.nav-item{display:flex;align-items:center;gap:12px;padding:10px 16px;border-radius:8px;cursor:pointer;font-size:14px;color:var(--text2);transition:all .15s;margin-bottom:2px}
.nav-item:hover{background:var(--bg3);color:var(--text)}
.nav-item.active{background:var(--accent);color:#fff}
.nav-item-icon{width:20px;text-align:center;font-size:16px}
.nav-divider{height:1px;background:var(--border);margin:8px 16px}
.nav-bottom{margin-top:auto;padding:12px 8px;border-top:1px solid var(--border)}
.main{flex:1;display:flex;overflow:hidden}
.page{display:none;flex:1;overflow:hidden}
.page.active{display:flex}
.sidebar{width:280px;background:var(--bg);border-right:1px solid var(--border);display:flex;flex-direction:column}
.sidebar-header{padding:16px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center}
.sidebar-header h3{font-size:15px;font-weight:600}
.sidebar-list{flex:1;overflow-y:auto;padding:8px}
.sidebar-item{display:flex;align-items:center;padding:12px;border-radius:10px;margin-bottom:4px;cursor:pointer;transition:all .15s}
.sidebar-item:hover{background:var(--bg3)}
.sidebar-item.active{background:var(--accent);color:#fff}
.sidebar-item-icon{width:36px;height:36px;border-radius:10px;background:var(--bg3);display:flex;align-items:center;justify-content:center;margin-right:12px;font-size:16px}
.sidebar-item.active .sidebar-item-icon{background:rgba(255,255,255,0.2)}
.sidebar-item-info{flex:1;min-width:0}
.sidebar-item-title{font-size:14px;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.sidebar-item-desc{font-size:12px;color:var(--text2);margin-top:2px}
.sidebar-item.active .sidebar-item-desc{color:rgba(255,255,255,0.7)}
.btn{padding:8px 16px;border:none;border-radius:8px;cursor:pointer;font-size:13px;font-weight:500;transition:all .15s;display:inline-flex;align-items:center;gap:6px}
.btn-primary{background:var(--accent);color:#fff}
.btn-primary:hover{background:var(--accent2)}
.btn-success{background:var(--success);color:#fff}
.btn-danger{background:var(--error);color:#fff}
.btn-ghost{background:transparent;color:var(--text2);border:1px solid var(--border)}
.btn-ghost:hover{background:var(--bg3);color:var(--text)}
.btn-sm{padding:6px 12px;font-size:12px}
.btn-icon{width:36px;height:36px;padding:0;justify-content:center}
.content{flex:1;display:flex;flex-direction:column;overflow:hidden}
.content-header{padding:16px 24px;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:16px}
.content-body{flex:1;overflow-y:auto;padding:24px}
.chat-messages{flex:1;overflow-y:auto;padding:24px}
.message{max-width:85%;margin-bottom:20px}
.message.user{margin-left:auto}
.message-content{padding:14px 18px;border-radius:16px;line-height:1.7;font-size:14px}
.message.user .message-content{background:var(--accent);color:#fff;border-bottom-right-radius:4px}
.message.assistant .message-content{background:var(--bg2);border-bottom-left-radius:4px}
.message.error .message-content{background:var(--error)}
.message-content pre{margin:12px 0;padding:14px;background:var(--bg);border-radius:8px;overflow-x:auto}
.message-content code{font-family:Consolas,monospace;font-size:13px}
.message-content p{margin:8px 0}
.message-actions{display:flex;gap:4px;margin-top:8px;opacity:0;transition:opacity .15s}
.message:hover .message-actions{opacity:1}
.message-action-btn{padding:4px 8px;border:none;background:var(--bg3);color:var(--text2);border-radius:4px;cursor:pointer;font-size:12px;transition:all .15s}
.message-action-btn:hover{background:var(--accent);color:#fff}
.message-time{font-size:11px;color:var(--text2);margin-top:4px}
.message-loading{display:flex;align-items:center;gap:8px;color:var(--text2);font-size:13px}
.message-loading .dots{display:flex;gap:4px}
.message-loading .dots span{width:6px;height:6px;background:var(--accent);border-radius:50%;animation:bounce 1.4s infinite ease-in-out both}
.message-loading .dots span:nth-child(1){animation-delay:-0.32s}
.message-loading .dots span:nth-child(2){animation-delay:-0.16s}
@keyframes bounce{0%,80%,100%{transform:scale(0)}40%{transform:scale(1)}}
.message-timer{font-size:12px;color:var(--accent);margin-left:8px}
.image-preview-item{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;background:var(--bg3);border-radius:8px;margin-right:8px}
.image-preview-item img{width:60px;height:60px;object-fit:cover;border-radius:6px}
.image-preview-item .remove-btn{cursor:pointer;color:var(--text2);font-size:16px}
.image-preview-item .remove-btn:hover{color:var(--error)}
.message-image{max-width:300px;max-height:200px;border-radius:8px;margin:8px 0;cursor:pointer}
.message-image:hover{opacity:0.9}
.chat-input-area{padding:16px 24px;border-top:1px solid var(--border);background:var(--bg2)}
.chat-input-box{display:flex;gap:12px;align-items:flex-end;background:var(--bg);border:1px solid var(--border);border-radius:12px;padding:8px 12px}
.chat-input-box textarea{flex:1;border:none;background:transparent;color:var(--text);font-size:14px;resize:none;max-height:150px;line-height:1.5}
.chat-input-box textarea:focus{outline:none}
.chat-toolbar{display:flex;gap:8px;margin-bottom:12px}
.settings-panel{width:100%;max-width:800px;margin:0 auto}
.settings-section{background:var(--bg2);border-radius:16px;padding:24px;margin-bottom:20px}
.settings-section h4{font-size:16px;margin-bottom:16px;display:flex;align-items:center;gap:10px}
.form-group{margin-bottom:20px}
.form-group label{display:block;font-size:13px;color:var(--text2);margin-bottom:8px;font-weight:500}
.form-group input,.form-group select,.form-group textarea{width:100%;padding:10px 14px;border:1px solid var(--border);border-radius:8px;background:var(--bg);color:var(--text);font-size:14px}
.form-group input:focus,.form-group select:focus,.form-group textarea:focus{outline:none;border-color:var(--accent)}
.form-row{display:flex;gap:12px}
.form-row>*{flex:1}
.card{background:var(--bg2);border-radius:12px;padding:20px;margin-bottom:16px}
.card-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}
.card-title{font-size:15px;font-weight:600}
.list-item{display:flex;align-items:center;padding:14px;background:var(--bg);border-radius:10px;margin-bottom:8px}
.list-item-icon{width:40px;height:40px;border-radius:10px;background:var(--bg3);display:flex;align-items:center;justify-content:center;margin-right:14px;font-size:18px}
.list-item-content{flex:1}
.list-item-title{font-size:14px;font-weight:500}
.list-item-desc{font-size:12px;color:var(--text2);margin-top:2px}
.list-item-actions{display:flex;gap:8px}
.modal{position:fixed;inset:0;background:rgba(0,0,0,0.6);display:none;align-items:center;justify-content:center;z-index:1000}
.modal.show{display:flex}
.modal-content{background:var(--bg2);border-radius:16px;width:90%;max-width:500px;max-height:90vh;overflow:hidden}
.modal-header{padding:20px 24px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center}
.modal-header h3{font-size:18px}
.modal-body{padding:24px;overflow-y:auto;max-height:60vh}
.empty-state{text-align:center;padding:60px 20px;color:var(--text2)}
.empty-state span{font-size:48px;display:block;margin-bottom:16px}
.switch{position:relative;width:44px;height:24px;display:inline-block}
.switch input{opacity:0;width:0;height:0}
.switch-slider{position:absolute;cursor:pointer;inset:0;background:var(--bg3);border-radius:24px;transition:.3s}
.switch-slider:before{position:absolute;content:"";height:18px;width:18px;left:3px;bottom:3px;background:#fff;border-radius:50%;transition:.3s}
.switch input:checked+.switch-slider{background:var(--accent)}
.switch input:checked+.switch-slider:before{transform:translateX(20px)}
.tag{display:inline-block;padding:4px 10px;border-radius:6px;font-size:12px;background:var(--bg3);color:var(--text2)}
.tag-primary{background:rgba(99,102,241,0.2);color:var(--accent2)}
.price-cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px}
.price-card{background:var(--bg3);border-radius:16px;padding:24px;text-align:center;border:2px solid transparent;cursor:pointer}
.price-card:hover{border-color:var(--accent)}
.price-card h4{font-size:18px;margin-bottom:8px}
.price-card .price{font-size:32px;font-weight:700;color:var(--accent);margin:16px 0}
.price-card .price span{font-size:14px;color:var(--text2)}
.price-card ul{text-align:left;margin:20px 0;list-style:none}
.price-card li{padding:6px 0;font-size:13px;color:var(--text2)}
.price-card li::before{content:'âœ“';color:var(--success);margin-right:8px}
.setting-row{display:flex;align-items:center;justify-content:space-between;padding:14px 0;border-bottom:1px solid var(--border)}
.setting-row:last-child{border-bottom:none}
.setting-row-label{font-size:14px}
.setting-row-label small{display:block;font-size:12px;color:var(--text2);margin-top:4px}
.slider-container{display:flex;align-items:center;gap:12px}
.slider-container input[type="range"]{width:150px;accent-color:var(--accent)}
.slider-value{min-width:40px;text-align:right;font-size:14px;color:var(--accent)}
.tabs{display:flex;border-bottom:1px solid var(--border);margin-bottom:20px}
.tab{padding:12px 20px;cursor:pointer;font-size:14px;color:var(--text2);border-bottom:2px solid transparent;transition:all .15s}
.tab:hover{color:var(--text)}
.tab.active{color:var(--accent);border-bottom-color:var(--accent)}
.assistant-card{display:flex;align-items:center;padding:16px;background:var(--bg);border-radius:12px;margin-bottom:12px;cursor:pointer;transition:all .15s}
.assistant-card:hover{background:var(--bg3)}
.assistant-card.active{background:var(--accent);color:#fff}
.assistant-avatar{width:48px;height:48px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:24px;margin-right:14px}
.assistant-info{flex:1}
.assistant-name{font-size:15px;font-weight:500}
.assistant-desc{font-size:12px;color:var(--text2);margin-top:4px}
.assistant-card.active .assistant-desc{color:rgba(255,255,255,0.7)}
.assistant-tag{padding:4px 8px;border-radius:4px;font-size:11px;background:var(--bg3);color:var(--text2)}
.changelog{max-height:400px;overflow-y:auto}
.changelog-item{padding:16px 0;border-bottom:1px solid var(--border)}
.changelog-item:last-child{border-bottom:none}
.changelog-version{font-size:16px;font-weight:600;color:var(--accent);margin-bottom:8px}
.changelog-date{font-size:12px;color:var(--text2);margin-left:12px}
.changelog-content{font-size:14px;color:var(--text2);line-height:1.8}
.changelog-content li{margin:4px 0}
.collapse-header{display:flex;align-items:center;justify-content:space-between;padding:14px 0;cursor:pointer;border-bottom:1px solid var(--border)}
.collapse-header h5{font-size:14px;display:flex;align-items:center;gap:8px}
.collapse-content{padding:16px 0;display:none}
.collapse-content.show{display:block}
.hotkey-row{display:flex;align-items:center;justify-content:space-between;padding:12px 0;border-bottom:1px solid var(--border)}
.hotkey-row:last-child{border-bottom:none}
.hotkey-row span:first-child{font-size:14px}
.hotkey-right{display:flex;align-items:center;gap:12px}
.hotkey-key{font-size:13px;color:var(--text2);min-width:120px;text-align:right}
.hotkey-info,.hotkey-lock{color:var(--text2);font-size:14px;cursor:pointer}
.shortcut-item{display:flex;align-items:center;padding:12px 0;border-bottom:1px solid var(--border);cursor:pointer}
.shortcut-item:hover{background:var(--bg3);margin:0 -16px;padding:12px 16px}
.shortcut-item:last-child{border-bottom:none}
.shortcut-item-icon{font-size:18px;margin-right:12px}
.shortcut-item-name{font-size:14px}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:0.5}}
.memory-item{display:flex;align-items:flex-start;padding:16px;background:var(--bg);border-radius:10px;margin-bottom:8px}
.memory-item-content{flex:1;font-size:14px;line-height:1.6}
.memory-item-meta{font-size:12px;color:var(--text2);margin-top:8px}
.memory-item-actions{display:flex;gap:4px;opacity:0;transition:opacity .15s}
.memory-item:hover .memory-item-actions{opacity:1}
.mcp-market-card{display:flex;justify-content:space-between;align-items:center;padding:14px 16px;background:var(--bg);border-radius:10px;cursor:pointer;transition:all .15s}
.mcp-market-card:hover{background:var(--bg3)}
.mcp-server-card{background:var(--bg);border-radius:10px;padding:16px;transition:all .15s}
.mcp-server-card:hover{background:var(--bg3)}
.mcp-server-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.mcp-server-desc{font-size:12px;color:var(--text2);line-height:1.6;margin-bottom:12px;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
.mcp-server-tags{display:flex;gap:6px;flex-wrap:wrap}
.mcp-add-btn{width:24px;height:24px;display:flex;align-items:center;justify-content:center;background:var(--bg3);border-radius:6px;cursor:pointer;font-size:16px;color:var(--text2)}
.mcp-add-btn:hover{background:var(--accent);color:#fff}
.settings-sidebar{width:200px;background:var(--bg);border-right:1px solid var(--border);padding:16px 8px;flex-shrink:0}
.settings-sidebar-item{display:flex;align-items:center;gap:10px;padding:10px 12px;border-radius:8px;cursor:pointer;font-size:13px;color:var(--text2);margin-bottom:2px}
.settings-sidebar-item:hover{background:var(--bg3);color:var(--text)}
.settings-sidebar-item.active{background:var(--accent);color:#fff}
.settings-sidebar-title{font-size:11px;color:var(--text2);padding:12px 12px 8px;text-transform:uppercase;letter-spacing:1px}
.theme-btn{width:60px;padding:6px 12px;border:1px solid var(--border);border-radius:6px;background:var(--bg);color:var(--text);font-size:12px;cursor:pointer;text-align:center}
.theme-btn.active{background:var(--accent);color:#fff;border-color:var(--accent)}
.color-picker{width:28px;height:28px;border-radius:50%;cursor:pointer;border:2px solid transparent;transition:all .15s}
.color-picker:hover{transform:scale(1.1)}
.color-picker.active{border-color:#fff;box-shadow:0 0 0 2px var(--accent)}
.hotkey-help-item{display:flex;justify-content:space-between;align-items:center;padding:10px 12px;background:var(--bg);border-radius:8px;font-size:13px}
.hotkey-help-key{padding:4px 8px;background:var(--bg3);border-radius:4px;font-family:monospace;font-size:12px;color:var(--accent)}
.toast{position:fixed;bottom:24px;left:50%;transform:translateX(-50%);padding:12px 24px;background:var(--bg2);border:1px solid var(--border);border-radius:8px;color:var(--text);font-size:14px;z-index:2000;animation:fadeInUp .3s}
@keyframes fadeInUp{from{opacity:0;transform:translateX(-50%) translateY(20px)}to{opacity:1;transform:translateX(-50%) translateY(0)}}
.context-menu div{padding:8px 12px;cursor:pointer;font-size:13px;border-radius:4px}
.context-menu div:hover{background:var(--bg3)}
.sidebar-item:hover .chat-delete-btn{opacity:1!important}
/* ç§»åŠ¨ç«¯é€‚é… */
@media(max-width:768px){
.nav{position:fixed;left:-220px;z-index:100;height:100vh;transition:left .3s}
.nav.show{left:0}
.sidebar{width:100%;position:fixed;left:-100%;z-index:99;height:100vh;transition:left .3s}
.sidebar.show{left:0}
.content{width:100%}
.mobile-menu-btn{display:flex!important}
.chat-input-box{flex-wrap:wrap}
.chat-toolbar{flex-wrap:wrap;gap:4px}
.chat-toolbar .btn{padding:6px 10px;font-size:11px}
.message{max-width:95%}
.settings-panel{padding:12px}
.form-row{flex-direction:column}
}
@media(min-width:769px){.mobile-menu-btn{display:none!important}}
.mobile-menu-btn{position:fixed;top:12px;left:12px;z-index:101;width:40px;height:40px;background:var(--bg2);border:1px solid var(--border);border-radius:8px;display:none;align-items:center;justify-content:center;cursor:pointer;font-size:20px}
.mobile-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.5);z-index:98;display:none}
.mobile-overlay.show{display:block}
</style>
</head>
<body>
<div class="mobile-menu-btn" onclick="toggleMobileNav()">â˜°</div>
<div class="mobile-overlay" onclick="closeMobileMenus()"></div>
<nav class="nav">
<div class="nav-header"><div class="nav-logo"><span>ğŸ¤–</span> AI Hub</div></div>
<div class="nav-section">
<div class="nav-section-title">æ¨¡å‹</div>
<div class="nav-item active" data-page="chat"><span class="nav-item-icon">ğŸ’¬</span> å¯¹è¯</div>
<div class="nav-item" data-page="assistants"><span class="nav-item-icon">ğŸ­</span> åŠ©æ‰‹</div>
<div class="nav-item" data-page="providers"><span class="nav-item-icon">ğŸ“¦</span> æ¨¡å‹æœåŠ¡</div>
<div class="nav-item" data-page="default-model"><span class="nav-item-icon">ğŸ¯</span> é»˜è®¤æ¨¡å‹</div>
<div class="nav-item" data-page="compare"><span class="nav-item-icon">âš–ï¸</span> æ¨¡å‹å¯¹æ¯”</div>
</div>
<div class="nav-divider"></div>
<div class="nav-section">
<div class="nav-section-title">è®¾ç½®</div>
<div class="nav-item" data-page="general"><span class="nav-item-icon">âš™ï¸</span> å¸¸è§„è®¾ç½®</div>
<div class="nav-item" data-page="display"><span class="nav-item-icon">ğŸ–¥ï¸</span> æ˜¾ç¤ºè®¾ç½®</div>
<div class="nav-item" data-page="data"><span class="nav-item-icon">ğŸ’¾</span> æ•°æ®è®¾ç½®</div>
<div class="nav-item" data-page="stats"><span class="nav-item-icon">ğŸ“Š</span> ä½¿ç”¨ç»Ÿè®¡</div>
<div class="nav-item" data-page="tokens"><span class="nav-item-icon">ğŸ”‘</span> API Token</div>
<div class="nav-item" data-page="teams"><span class="nav-item-icon">ğŸ‘¥</span> å›¢é˜Ÿç©ºé—´</div>
<div class="nav-item" data-page="knowledge"><span class="nav-item-icon">ğŸ“š</span> çŸ¥è¯†åº“</div>
</div>
<div class="nav-divider"></div>
<div class="nav-section">
<div class="nav-section-title">åŠŸèƒ½</div>
<div class="nav-item" data-page="mcp"><span class="nav-item-icon">ğŸ”Œ</span> MCP</div>
<div class="nav-item" data-page="notes"><span class="nav-item-icon">ğŸ“</span> ç¬”è®°</div>
<div class="nav-item" data-page="search"><span class="nav-item-icon">ğŸŒ</span> ç½‘ç»œæœç´¢</div>
<div class="nav-item" data-page="memory"><span class="nav-item-icon">ğŸ§ </span> å…¨å±€è®°å¿†</div>
<div class="nav-item" data-page="api-server"><span class="nav-item-icon">ğŸ–¥ï¸</span> API æœåŠ¡å™¨</div>
<div class="nav-item" data-page="documents"><span class="nav-item-icon">ğŸ“„</span> æ–‡æ¡£å¤„ç†</div>
<div class="nav-item" data-page="prompts"><span class="nav-item-icon">ğŸ“‹</span> Prompt æ¨¡æ¿</div>
<div class="nav-item" data-page="shortcuts"><span class="nav-item-icon">âš¡</span> å¿«æ·çŸ­è¯­</div>
<div class="nav-item" data-page="hotkeys"><span class="nav-item-icon">âŒ¨ï¸</span> å¿«æ·é”®</div>
</div>
<div class="nav-divider"></div>
<div class="nav-section">
<div class="nav-section-title">åŠ©æ‰‹</div>
<div class="nav-item" data-page="quick-assistant"><span class="nav-item-icon">ğŸš€</span> å¿«æ·åŠ©æ‰‹</div>
<div class="nav-item" data-page="selection-assistant"><span class="nav-item-icon">âœ‚ï¸</span> åˆ’è¯åŠ©æ‰‹</div>
</div>
<div class="nav-bottom">
<div class="nav-item" data-page="about"><span class="nav-item-icon">â„¹ï¸</span> å…³äºæˆ‘ä»¬</div>
<div class="nav-item" id="navUser" onclick="showAuthModal()"><span class="nav-item-icon">ğŸ‘¤</span> <span id="navUserName">ç™»å½•</span></div>
</div>
</nav>
<div class="main">
<!-- å¯¹è¯é¡µ -->
<div id="page-chat" class="page active">
<div class="sidebar">
<div class="sidebar-header">
<h3>å¯¹è¯åˆ—è¡¨</h3>
<div style="display:flex;gap:4px"><button class="btn btn-ghost btn-sm" onclick="searchChats()" title="æœç´¢">ğŸ”</button><button class="btn btn-primary btn-sm" onclick="newChat()">+</button></div>
</div>
<div style="padding:8px"><input type="text" id="chatSearchInput" placeholder="æœç´¢å¯¹è¯..." style="width:100%;padding:8px 12px;background:var(--bg3);border:1px solid var(--border);border-radius:8px;color:var(--text);font-size:13px;display:none" oninput="filterChats(this.value)"></div>
<div class="sidebar-list" id="chatList"></div>
</div>
<div class="content">
<div class="content-header">
<select id="chatAssistant" onchange="onAssistantChange()" style="padding:8px 12px;background:var(--bg);border:1px solid var(--border);border-radius:8px;color:var(--text)"></select>
<select id="chatProvider" onchange="onProviderChange()" style="padding:8px 12px;background:var(--bg);border:1px solid var(--border);border-radius:8px;color:var(--text)"></select>
<select id="chatModel" style="padding:8px 12px;background:var(--bg);border:1px solid var(--border);border-radius:8px;color:var(--text);min-width:150px"></select>
<div style="margin-left:auto;display:flex;gap:8px">
<button class="btn btn-ghost btn-sm" onclick="toggleWebSearch()" id="webSearchBtn" title="ç½‘ç»œæœç´¢">ğŸŒ</button>
<button class="btn btn-ghost btn-sm" onclick="showChatSettings()" title="è®¾ç½®">âš™ï¸</button>
</div>
</div>
<div class="chat-messages" id="chatMessages"><div class="empty-state"><span>ğŸ’¬</span><p>å¼€å§‹æ–°çš„å¯¹è¯</p><p style="font-size:12px;margin-top:8px;color:var(--text2)">Ctrl+N æ–°å»ºå¯¹è¯ Â· Enter å‘é€æ¶ˆæ¯</p></div></div>
<div class="chat-input-area">
<div id="imagePreview" style="display:none;padding:8px 0;margin-bottom:8px"></div>
<div class="chat-toolbar">
<button class="btn btn-ghost btn-sm" onclick="uploadImage()" title="ä¸Šä¼ å›¾ç‰‡">ğŸ–¼ï¸</button>
<button class="btn btn-ghost btn-sm" onclick="uploadFile()" title="ä¸Šä¼ æ–‡ä»¶">ğŸ“</button>
<button class="btn btn-ghost btn-sm" onclick="voiceInput()" title="è¯­éŸ³è¾“å…¥">ğŸ¤</button>
<button class="btn btn-ghost btn-sm" onclick="estimateTokens()" title="ä¼°ç®— Token">ğŸ”¢</button>
<button class="btn btn-ghost btn-sm" onclick="showSearchModal()" title="æœç´¢ Ctrl+K">ğŸ”</button>
<button class="btn btn-ghost btn-sm" onclick="toggleTheme()" title="åˆ‡æ¢ä¸»é¢˜ Ctrl+D">ğŸŒ“</button>
<div style="flex:1"></div>
<button class="btn btn-ghost btn-sm" onclick="clearChat()">ğŸ—‘ï¸ æ¸…ç©º</button>
<button class="btn btn-ghost btn-sm" onclick="shareChat()" title="åˆ†äº«å¯¹è¯">ğŸ”— åˆ†äº«</button>
<div style="position:relative;display:inline-block"><button class="btn btn-ghost btn-sm" onclick="this.nextElementSibling.style.display=this.nextElementSibling.style.display==='block'?'none':'block'">ğŸ“¥ å¯¼å‡º</button><div style="display:none;position:absolute;bottom:100%;left:0;background:var(--bg2);border:1px solid var(--border);border-radius:8px;padding:4px;min-width:100px;z-index:100"><div style="padding:8px 12px;cursor:pointer;border-radius:4px;font-size:12px" onclick="exportChat('txt');this.parentElement.style.display='none'" onmouseover="this.style.background='var(--bg3)'" onmouseout="this.style.background=''">ğŸ“„ TXT</div><div style="padding:8px 12px;cursor:pointer;border-radius:4px;font-size:12px" onclick="exportChat('md');this.parentElement.style.display='none'" onmouseover="this.style.background='var(--bg3)'" onmouseout="this.style.background=''">ğŸ“ Markdown</div><div style="padding:8px 12px;cursor:pointer;border-radius:4px;font-size:12px" onclick="exportChat('json');this.parentElement.style.display='none'" onmouseover="this.style.background='var(--bg3)'" onmouseout="this.style.background=''">ğŸ“‹ JSON</div></div></div>
</div>
<div class="chat-input-box">
<textarea id="chatInput" placeholder="è¾“å…¥æ¶ˆæ¯ï¼ŒEnter å‘é€ï¼ŒShift+Enter æ¢è¡Œ..." rows="1" onkeydown="handleChatKey(event)"></textarea>
<button class="btn btn-ghost btn-sm" onclick="stopGeneration()" id="stopBtn" style="display:none" title="åœæ­¢ç”Ÿæˆ">â¹ï¸</button>
<button class="btn btn-primary" onclick="sendMessage()" id="sendBtn">å‘é€</button>
</div>
<input type="file" id="imageInput" accept="image/*" style="display:none" onchange="handleImageSelect(event)">
</div>
</div>
</div>
<!-- åŠ©æ‰‹é¡µ -->
<div id="page-assistants" class="page">
<div class="sidebar">
<div class="sidebar-header"><h3>åŠ©æ‰‹åˆ—è¡¨</h3><button class="btn btn-primary btn-sm" onclick="addAssistant()">+ æ–°å»º</button></div>
<div class="sidebar-list" id="assistantList"></div>
</div>
<div class="content"><div class="content-body"><div class="settings-panel">
<div class="tabs"><div class="tab active" onclick="switchAssistantTab('info')">åŠ©æ‰‹</div><div class="tab" onclick="switchAssistantTab('settings')">è®¾ç½®</div></div>
<div id="assistantTabInfo">
<div class="settings-section"><h4><span>ğŸ­</span> åŠ©æ‰‹ä¿¡æ¯</h4>
<div class="form-group"><label>åç§°</label><input type="text" id="aName" placeholder="åŠ©æ‰‹åç§°"></div>
<div class="form-group"><label>å¤´åƒ Emoji</label><input type="text" id="aEmoji" placeholder="ğŸ˜€" maxlength="2"></div>
<div class="form-group"><label>æè¿°</label><input type="text" id="aDesc" placeholder="åŠ©æ‰‹æè¿°"></div>
<div class="form-group"><label>ç³»ç»Ÿæç¤ºè¯</label><textarea id="aPrompt" rows="6" placeholder="ä½ æ˜¯ä¸€ä¸ª..."></textarea></div>
<div style="display:flex;gap:12px"><button class="btn btn-primary" onclick="saveAssistant()">ğŸ’¾ ä¿å­˜</button><button class="btn btn-danger" onclick="deleteAssistant()">ğŸ—‘ï¸ åˆ é™¤</button></div>
</div>
</div>
<div id="assistantTabSettings" style="display:none">
<div class="settings-section"><h4><span>âš™ï¸</span> åŠ©æ‰‹è®¾ç½®</h4>
<div class="setting-row"><div class="setting-row-label">æ¨¡å‹æ¸©åº¦ <small>æ§åˆ¶å›å¤çš„éšæœºæ€§</small></div><div class="slider-container"><input type="range" id="aTemp" min="0" max="2" step="0.1" value="0.7" oninput="$('aTempVal').textContent=this.value"><span class="slider-value" id="aTempVal">0.7</span></div></div>
<div class="setting-row"><div class="setting-row-label">ä¸Šä¸‹æ–‡æ•° <small>å‘é€ç»™æ¨¡å‹çš„å†å²æ¶ˆæ¯æ•°</small></div><div class="slider-container"><input type="range" id="aContext" min="1" max="50" value="10" oninput="$('aContextVal').textContent=this.value"><span class="slider-value" id="aContextVal">10</span></div></div>
<div class="setting-row"><div class="setting-row-label">æµå¼è¾“å‡º</div><label class="switch"><input type="checkbox" id="aStream" checked><span class="switch-slider"></span></label></div>
<div class="setting-row"><div class="setting-row-label">æœ€å¤§ Token æ•° <small>é™åˆ¶å›å¤é•¿åº¦</small></div><div class="slider-container"><input type="range" id="aMaxTokens" min="256" max="8192" step="256" value="2048" oninput="$('aMaxTokensVal').textContent=this.value"><span class="slider-value" id="aMaxTokensVal">2048</span></div></div>
</div>
<div class="settings-section"><h4><span>ğŸ’¬</span> æ¶ˆæ¯è®¾ç½®</h4>
<div class="setting-row"><div class="setting-row-label">æ˜¾ç¤ºæç¤ºè¯</div><label class="switch"><input type="checkbox" id="aShowPrompt"><span class="switch-slider"></span></label></div>
<div class="setting-row"><div class="setting-row-label">ä½¿ç”¨è¡¬çº¿å­—ä½“</div><label class="switch"><input type="checkbox" id="aSerifFont"><span class="switch-slider"></span></label></div>
<div class="setting-row"><div class="setting-row-label">æ€è€ƒå†…å®¹è‡ªåŠ¨æŠ˜å </div><label class="switch"><input type="checkbox" id="aFoldThinking" checked><span class="switch-slider"></span></label></div>
<div class="setting-row"><div class="setting-row-label">æ˜¾ç¤ºæ¶ˆæ¯å¤§çº²</div><label class="switch"><input type="checkbox" id="aShowOutline"><span class="switch-slider"></span></label></div>
<div class="setting-row"><div class="setting-row-label">æ¶ˆæ¯æ ·å¼</div><select id="aMsgStyle" style="width:120px;padding:8px;background:var(--bg);border:1px solid var(--border);border-radius:6px;color:var(--text)"><option value="simple">ç®€æ´</option><option value="bubble">æ°”æ³¡</option><option value="card">å¡ç‰‡</option></select></div>
</div>
</div>
</div></div></div>
</div>
<!-- æ¨¡å‹æœåŠ¡é¡µ -->
<div id="page-providers" class="page">
<div class="sidebar"><div class="sidebar-header"><h3>æ¨¡å‹æœåŠ¡</h3><button class="btn btn-primary btn-sm" onclick="addProvider()">+ æ·»åŠ </button></div><div class="sidebar-list" id="providerList"></div></div>
<div class="content"><div class="content-body"><div class="settings-panel">
<div class="settings-section"><h4><span>ğŸ”§</span> æœåŠ¡é…ç½®</h4>
<div class="form-group"><label>æœåŠ¡åç§°</label><input type="text" id="pName" placeholder="OpenAI"></div>
<div class="form-group"><label>API åœ°å€</label><input type="text" id="pUrl" placeholder="https://api.openai.com/v1"></div>
<div class="form-row"><div class="form-group"><label>API Key</label><div style="position:relative"><input type="password" id="pKey" placeholder="sk-xxx" style="padding-right:40px"><button type="button" onclick="toggleProviderKey()" id="togglePKeyBtn" style="position:absolute;right:8px;top:50%;transform:translateY(-50%);background:none;border:none;color:var(--text2);cursor:pointer;font-size:16px;padding:4px">ğŸ‘ï¸</button></div></div><div class="form-group"><label>ç±»å‹</label><select id="pType"><option value="openai">OpenAI</option><option value="claude">Claude</option></select></div></div>
<div style="display:flex;gap:12px"><button class="btn btn-ghost" onclick="testProvider()">ğŸ” æµ‹è¯•</button><button class="btn btn-primary" onclick="saveProvider()">ğŸ’¾ ä¿å­˜</button><button class="btn btn-danger" onclick="deleteProvider()">ğŸ—‘ï¸ åˆ é™¤</button></div>
</div>
<div class="settings-section"><h4><span>ğŸ“‹</span> æ¨¡å‹åˆ—è¡¨</h4><div style="margin-bottom:12px"><button class="btn btn-ghost btn-sm" onclick="addModel()">+ æ·»åŠ </button><button class="btn btn-ghost btn-sm" onclick="fetchModels()">ğŸ”„ è·å–</button></div><div id="modelList"></div></div>
</div></div></div>
</div>
<!-- é»˜è®¤æ¨¡å‹é¡µ -->
<div id="page-default-model" class="page"><div class="content"><div class="content-body"><div class="settings-panel">
<div class="settings-section">
<h4><span>ğŸ¯</span> é»˜è®¤æ¨¡å‹</h4>
<p style="color:var(--text2);margin-bottom:20px">è®¾ç½®ä¸åŒåœºæ™¯ä½¿ç”¨çš„é»˜è®¤æ¨¡å‹</p>
<div class="form-group"><label>ğŸ’¬ å¯¹è¯æ¨¡å‹<br><small style="color:var(--text2)">ç”¨äºæ—¥å¸¸å¯¹è¯çš„é»˜è®¤æ¨¡å‹</small></label><div class="form-row"><select id="defaultChatProvider" onchange="onDefaultProviderChange('chat')" style="flex:1"></select><select id="defaultChatModel" style="flex:1"></select></div></div>
<div class="form-group"><label>ğŸŒ ç¿»è¯‘æ¨¡å‹<br><small style="color:var(--text2)">ç”¨äºæ–‡æœ¬ç¿»è¯‘çš„é»˜è®¤æ¨¡å‹</small></label><div class="form-row"><select id="defaultTranslateProvider" onchange="onDefaultProviderChange('translate')" style="flex:1"></select><select id="defaultTranslateModel" style="flex:1"></select></div></div>
<div class="form-group"><label>ğŸ“ æ‘˜è¦æ¨¡å‹<br><small style="color:var(--text2)">ç”¨äºå†…å®¹æ‘˜è¦çš„é»˜è®¤æ¨¡å‹</small></label><div class="form-row"><select id="defaultSummaryProvider" onchange="onDefaultProviderChange('summary')" style="flex:1"></select><select id="defaultSummaryModel" style="flex:1"></select></div></div>
<div class="form-group"><label>ğŸ’» ä»£ç æ¨¡å‹<br><small style="color:var(--text2)">ç”¨äºä»£ç ç”Ÿæˆå’Œåˆ†æçš„é»˜è®¤æ¨¡å‹</small></label><div class="form-row"><select id="defaultCodeProvider" onchange="onDefaultProviderChange('code')" style="flex:1"></select><select id="defaultCodeModel" style="flex:1"></select></div></div>
<div class="form-group"><label>ğŸš€ å¿«æ·åŠ©æ‰‹æ¨¡å‹<br><small style="color:var(--text2)">å¿«æ·åŠ©æ‰‹ä½¿ç”¨çš„é»˜è®¤æ¨¡å‹</small></label><div class="form-row"><select id="defaultQuickProvider" onchange="onDefaultProviderChange('quick')" style="flex:1"></select><select id="defaultQuickModel" style="flex:1"></select></div></div>
<button class="btn btn-primary" onclick="saveDefaultModels()">ğŸ’¾ ä¿å­˜è®¾ç½®</button>
</div>
</div></div></div></div>
<!-- æ¨¡å‹å¯¹æ¯”é¡µ -->
<div id="page-compare" class="page"><div class="content"><div class="content-body"><div class="settings-panel">
<div class="settings-section">
<h4><span>âš–ï¸</span> æ¨¡å‹å¯¹æ¯”</h4>
<p style="color:var(--text2);margin-bottom:20px">åŒæ—¶å‘å¤šä¸ªæ¨¡å‹å‘é€ç›¸åŒé—®é¢˜ï¼Œå¯¹æ¯”å›ç­”è´¨é‡å’Œé€Ÿåº¦</p>
<div class="form-group">
<label>é—®é¢˜</label>
<textarea id="compareQuestion" rows="3" placeholder="è¾“å…¥è¦å¯¹æ¯”çš„é—®é¢˜...">è¯·ç”¨ä¸€å¥è¯è§£é‡Šä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½</textarea>
</div>
<div class="form-group">
<label>é€‰æ‹©æ¨¡å‹ (æœ€å¤š5ä¸ª)</label>
<div id="compareModelList" style="display:flex;flex-wrap:wrap;gap:8px;margin-top:8px"></div>
</div>
<button class="btn btn-primary" onclick="runCompare()">ğŸš€ å¼€å§‹å¯¹æ¯”</button>
<button class="btn btn-ghost" onclick="initCompareModels()" style="margin-left:8px">ğŸ”„ åˆ·æ–°æ¨¡å‹</button>
</div>
<div class="settings-section" id="compareResults" style="display:none">
<h4><span>ğŸ“Š</span> å¯¹æ¯”ç»“æœ</h4>
<div id="compareResultsContent"></div>
</div>
</div></div></div></div>
<!-- å¸¸è§„è®¾ç½®é¡µ -->
<div id="page-general" class="page"><div class="content"><div class="content-body"><div class="settings-panel">
<div class="settings-section">
<h4><span>âš™ï¸</span> å¸¸è§„è®¾ç½®</h4>
<div class="setting-row"><div class="setting-row-label">è¯­è¨€</div><div style="display:flex;align-items:center;gap:8px"><span style="font-size:16px">ğŸ‡¨ğŸ‡³</span><select id="appLanguage" style="width:120px;padding:8px;background:var(--bg);border:1px solid var(--border);border-radius:6px;color:var(--text)"><option value="zh-CN">ä¸­æ–‡</option><option value="en">English</option><option value="ja">æ—¥æœ¬èª</option></select></div></div>
<div class="setting-row"><div class="setting-row-label">ä»£ç†æ¨¡å¼</div><select style="width:120px;padding:8px;background:var(--bg);border:1px solid var(--border);border-radius:6px;color:var(--text)"><option>ç³»ç»Ÿä»£ç†</option><option>è‡ªå®šä¹‰ä»£ç†</option><option>ä¸ä½¿ç”¨ä»£ç†</option></select></div>
<div class="setting-row"><div class="setting-row-label">æ‹¼å†™æ£€æŸ¥</div><label class="switch"><input type="checkbox"><span class="switch-slider"></span></label></div>
<div class="setting-row"><div class="setting-row-label">ç¦ç”¨ç¡¬ä»¶åŠ é€Ÿ</div><label class="switch"><input type="checkbox"><span class="switch-slider"></span></label></div>
</div>
<div class="settings-section">
<h4><span>ğŸ””</span> é€šçŸ¥è®¾ç½®</h4>
<div class="setting-row"><div class="setting-row-label">æ¡Œå­æ¶ˆæ¯ â“˜</div><label class="switch"><input type="checkbox"><span class="switch-slider"></span></label></div>
<div class="setting-row"><div class="setting-row-label">éŸ³æ•ˆ</div><label class="switch"><input type="checkbox"><span class="switch-slider"></span></label></div>
<div class="setting-row"><div class="setting-row-label">çŸ¥è¯†åº“</div><label class="switch"><input type="checkbox"><span class="switch-slider"></span></label></div>
</div>
<div class="settings-section">
<h4><span>ğŸš€</span> å¯åŠ¨</h4>
<div class="setting-row"><div class="setting-row-label">å¼€æœºå¯åŠ¨</div><label class="switch"><input type="checkbox"><span class="switch-slider"></span></label></div>
<div class="setting-row"><div class="setting-row-label">å¯åŠ¨æ—¶æœ€å°åŒ–åˆ°æ‰˜ç›˜</div><label class="switch"><input type="checkbox"><span class="switch-slider"></span></label></div>
</div>
<div class="settings-section">
<h4><span>ğŸ“Œ</span> æ‰˜ç›˜</h4>
<div class="setting-row"><div class="setting-row-label">æ˜¾ç¤ºæ‰˜ç›˜å›¾æ ‡</div><label class="switch"><input type="checkbox" checked><span class="switch-slider"></span></label></div>
<div class="setting-row"><div class="setting-row-label">å…³é—­æ—¶æœ€å°åŒ–åˆ°æ‰˜ç›˜</div><label class="switch"><input type="checkbox"><span class="switch-slider"></span></label></div>
</div>
<div class="settings-section">
<h4><span>ğŸ”’</span> éšç§è®¾ç½®</h4>
<div class="setting-row"><div class="setting-row-label">åŒ¿åå‘é€é”™è¯¯æŠ¥å‘Šå’Œæ•°æ®ç»Ÿè®¡</div><label class="switch"><input type="checkbox"><span class="switch-slider"></span></label></div>
</div>
<div class="settings-section">
<h4><span>ğŸ› ï¸</span> å¼€å‘è€…æ¨¡å¼</h4>
<div class="setting-row"><div class="setting-row-label">å¯ç”¨å¼€å‘è€…æ¨¡å¼<br><small style="color:var(--text2)">å¯ç”¨åå¯ä»¥ä½¿ç”¨å¼€å‘è€…å·¥å…·å’Œè°ƒè¯•åŠŸèƒ½</small></div><label class="switch"><input type="checkbox"><span class="switch-slider"></span></label></div>
</div>
</div></div></div></div>
<!-- æ˜¾ç¤ºè®¾ç½®é¡µ -->
<div id="page-display" class="page"><div class="content"><div class="content-body"><div class="settings-panel">
<div class="settings-section">
<h4><span>ğŸ¨</span> æ˜¾ç¤ºè®¾ç½®</h4>
<div class="setting-row"><div class="setting-row-label">ä¸»é¢˜</div><div style="display:flex;gap:8px"><button class="theme-btn" onclick="setTheme('light')">â˜€ï¸ æµ…è‰²</button><button class="theme-btn active" onclick="setTheme('dark')">ğŸŒ™ æ·±è‰²</button><button class="theme-btn" onclick="setTheme('auto')">ğŸ’» ç³»ç»Ÿ</button></div></div>
<div class="setting-row"><div class="setting-row-label">ä¸»é¢˜é¢œè‰²</div><div style="display:flex;gap:8px;align-items:center"><div class="color-picker" style="background:#22c55e" onclick="setAccent('#22c55e')"></div><div class="color-picker" style="background:#ef4444" onclick="setAccent('#ef4444')"></div><div class="color-picker" style="background:#06b6d4" onclick="setAccent('#06b6d4')"></div><div class="color-picker" style="background:#3b82f6" onclick="setAccent('#3b82f6')"></div><div class="color-picker active" style="background:#6366f1" onclick="setAccent('#6366f1')"></div><div class="color-picker" style="background:#8b5cf6" onclick="setAccent('#8b5cf6')"></div><div class="color-picker" style="background:#ec4899" onclick="setAccent('#ec4899')"></div><div class="color-picker" style="background:#f59e0b" onclick="setAccent('#f59e0b')"></div><div class="color-picker" style="background:#14b8a6" onclick="setAccent('#14b8a6')"></div><input type="text" value="#00B96B" style="width:80px;padding:6px;background:var(--bg);border:1px solid var(--border);border-radius:6px;color:var(--text);font-size:12px"></div></div>
</div>
<div class="settings-section">
<div style="display:flex;align-items:center;gap:8px;margin-bottom:16px"><h4 style="margin:0"><span>ğŸ“</span> å¯¼èˆªæ è®¾ç½®</h4><span class="tag tag-primary" style="font-size:10px">New</span></div>
<div class="setting-row"><div class="setting-row-label">å¯¼èˆªæ ä½ç½®</div><div style="display:flex;gap:8px"><button class="theme-btn active">å·¦ä¾§</button><button class="theme-btn">é¡¶éƒ¨</button></div></div>
</div>
<div class="settings-section">
<h4><span>ğŸ”</span> ç¼©æ”¾è®¾ç½®</h4>
<div class="setting-row"><div class="setting-row-label">ç¼©æ”¾</div><div style="display:flex;align-items:center;gap:12px"><button class="btn btn-ghost btn-sm">âˆ’</button><span>100%</span><button class="btn btn-ghost btn-sm">+</button><button class="btn btn-ghost btn-sm">â†º</button></div></div>
</div>
<div class="settings-section">
<div style="display:flex;align-items:center;gap:8px;margin-bottom:16px"><h4 style="margin:0"><span>ğŸ”¤</span> å­—ä½“è®¾ç½®</h4><span class="tag tag-primary" style="font-size:10px">New</span></div>
<div class="setting-row"><div class="setting-row-label">å…¨å±€å­—ä½“</div><div style="display:flex;align-items:center;gap:8px"><select style="width:100px;padding:8px;background:var(--bg);border:1px solid var(--border);border-radius:6px;color:var(--text)"><option>é»˜è®¤</option><option>å¾®è½¯é›…é»‘</option><option>æ€æºé»‘ä½“</option></select><button class="btn btn-ghost btn-sm">â†º</button></div></div>
<div class="setting-row"><div class="setting-row-label">ä»£ç å­—ä½“</div><div style="display:flex;align-items:center;gap:8px"><select style="width:100px;padding:8px;background:var(--bg);border:1px solid var(--border);border-radius:6px;color:var(--text)"><option>é»˜è®¤</option><option>Consolas</option><option>Fira Code</option></select><button class="btn btn-ghost btn-sm">â†º</button></div></div>
</div>
<div class="settings-section">
<h4><span>ğŸ’¬</span> è¯é¢˜è®¾ç½®</h4>
<div class="setting-row"><div class="setting-row-label">è¯é¢˜ä½ç½®</div><div style="display:flex;gap:8px"><button class="theme-btn">å·¦ä¾§</button><button class="theme-btn active">å³ä¾§</button></div></div>
<div class="setting-row"><div class="setting-row-label">è‡ªåŠ¨åˆ‡æ¢åˆ°è¯é¢˜</div><label class="switch"><input type="checkbox" checked><span class="switch-slider"></span></label></div>
<div class="setting-row"><div class="setting-row-label">æ˜¾ç¤ºè¯é¢˜æ—¶é—´</div><label class="switch"><input type="checkbox"><span class="switch-slider"></span></label></div>
<div class="setting-row"><div class="setting-row-label">å›ºå®šè¯é¢˜ç½®é¡¶</div><label class="switch"><input type="checkbox"><span class="switch-slider"></span></label></div>
</div>
<div class="settings-section">
<h4><span>ğŸ¤–</span> åŠ©æ‰‹è®¾ç½®</h4>
<div class="setting-row"><div class="setting-row-label">æ¨¡å‹å›¾æ ‡è¡Œä¸º</div><div style="display:flex;gap:8px"><select style="width:120px;padding:8px;background:var(--bg);border:1px solid var(--border);border-radius:6px;color:var(--text)"><option>Emoji å­—ä½“</option><option>ç³»ç»Ÿå­—ä½“</option></select></div></div>
<div class="setting-row"><div class="setting-row-label">ä»£ç å—æ˜¾ç¤ºè¡Œå·<br><small style="color:var(--text2)">åœ¨ä»£ç å—ä¸­æ˜¾ç¤ºè¡Œå·</small></div><label class="switch"><input type="checkbox" id="showLineNumbers"><span class="switch-slider"></span></label></div>
</div>
<div class="settings-section">
<h4><span>ğŸ–¥ï¸</span> ç•Œé¢å¸ƒå±€</h4>
<div class="setting-row"><div class="setting-row-label">ä¾§è¾¹æ å®½åº¦<br><small style="color:var(--text2)">è°ƒæ•´å·¦ä¾§å¯¼èˆªæ å®½åº¦</small></div><div class="slider-container"><input type="range" min="180" max="300" value="220" id="sidebarWidth" oninput="this.nextElementSibling.textContent=this.value+'px'"><span class="slider-value">220px</span></div></div>
<div class="setting-row"><div class="setting-row-label">å¯¹è¯åˆ—è¡¨å®½åº¦<br><small style="color:var(--text2)">è°ƒæ•´å¯¹è¯åˆ—è¡¨åŒºåŸŸå®½åº¦</small></div><div class="slider-container"><input type="range" min="200" max="400" value="280" id="chatListWidth" oninput="this.nextElementSibling.textContent=this.value+'px'"><span class="slider-value">280px</span></div></div>
<div class="setting-row"><div class="setting-row-label">æ˜¾ç¤ºå¯¹è¯å¯¼èˆªæŒ‰é’®<br><small style="color:var(--text2)">åœ¨å¯¹è¯åŒºåŸŸæ˜¾ç¤ºä¸Šä¸‹å¯¼èˆªæŒ‰é’®</small></div><label class="switch"><input type="checkbox" id="showNavButtons" checked><span class="switch-slider"></span></label></div>
</div>
<div class="settings-section">
<button class="btn btn-primary" onclick="saveDisplaySettings()">ğŸ’¾ ä¿å­˜è®¾ç½®</button>
<button class="btn btn-ghost" onclick="resetDisplaySettings()" style="margin-left:12px">é‡ç½®ä¸ºé»˜è®¤</button>
</div>
</div></div></div></div>
<!-- æ•°æ®è®¾ç½®é¡µ -->
<div id="page-data" class="page">
<div class="settings-sidebar">
<div class="settings-sidebar-title">æ•°æ®å’Œå¤‡ä»½è®¾ç½®</div>
<div class="settings-sidebar-item active" onclick="switchDataTab('directory')">ğŸ“ æ•°æ®ç›®å½•</div>
<div class="settings-sidebar-title">äº‘å¤‡ä»½è®¾ç½®</div>
<div class="settings-sidebar-item" onclick="switchDataTab('local')">ğŸ’¾ æœ¬åœ°å¤‡ä»½</div>
<div class="settings-sidebar-item" onclick="switchDataTab('webdav')">â˜ï¸ WebDAV</div>
<div class="settings-sidebar-item" onclick="switchDataTab('icloud')">ğŸ åšæœäº‘é…ç½®</div>
<div class="settings-sidebar-item" onclick="switchDataTab('s3')">ğŸ“¦ S3 å…¼å®¹å­˜å‚¨</div>
<div class="settings-sidebar-title">å¿«æ·æŒ‰é’®</div>
<div class="settings-sidebar-item" onclick="switchDataTab('export')">ğŸ“¤ ä»¥å¯¹è¯å•ä½å¯¼å‡º</div>
<div class="settings-sidebar-item" onclick="switchDataTab('markdown')">ğŸ“ Markdown å¯¼å‡º</div>
<div class="settings-sidebar-title">ç¬¬ä¸‰æ–¹åŒæ­¥</div>
<div class="settings-sidebar-item" onclick="switchDataTab('notion')">ğŸ““ Notion é…ç½®</div>
<div class="settings-sidebar-item" onclick="switchDataTab('yuque')">ğŸ“– è¯­é›€é…ç½®</div>
<div class="settings-sidebar-item" onclick="switchDataTab('joplin')">ğŸµ Joplin é…ç½®</div>
<div class="settings-sidebar-item" onclick="switchDataTab('obsidian')">ğŸ’ Obsidian é…ç½®</div>
<div class="settings-sidebar-item" onclick="switchDataTab('siyuan')">ğŸ“” æ€æºç¬”è®°é…ç½®</div>
<div class="settings-sidebar-item" onclick="switchDataTab('zhishiku')">ğŸ’¡ æ™ºèƒ½ä½“é…ç½®</div>
</div>
<div class="content"><div class="content-body"><div class="settings-panel">
<div class="settings-section">
<h4><span>ğŸ’¾</span> æ•°æ®è®¾ç½®</h4>
<div class="setting-row"><div class="setting-row-label">æ•°æ®å¤‡ä»½ä¸æ¢å¤</div><div style="display:flex;gap:8px"><button class="btn btn-ghost" onclick="exportAllData()">å¤‡ä»½</button><button class="btn btn-ghost" onclick="importData()">æ¢å¤</button></div></div>
<div class="setting-row"><div class="setting-row-label">ç®€æ˜“å¤‡ä»½<br><small style="color:var(--text2)">å¤‡ä»½åŒ…æ‹¬å·²å¤‡ä»½çš„æ•°æ®ï¼Œå¦‚å¯¹è¯è®°å½•/æ¨¡å‹äººå·¥ä¸Šæ¶å’Œé…ç½®ï¼Œå‡å°‘ç©ºé—´å ç”¨ï¼Œå¿«é€Ÿå¤‡ä»½æ¢å¤</small></div><label class="switch"><input type="checkbox" checked><span class="switch-slider"></span></label></div>
<div class="setting-row"><div class="setting-row-label">å¯¼å‡ºè‡³æ‰‹æœº</div><button class="btn btn-ghost btn-sm">ğŸ“± å±€åŸŸç½‘ä¼ è¾“</button></div>
</div>
<div class="settings-section">
<h4><span>ğŸ“</span> æ•°æ®ç›®å½•</h4>
<div class="setting-row"><div class="setting-row-label">åº”ç”¨æ•°æ®</div><div style="display:flex;gap:8px;align-items:center"><input type="text" value="C:\Users\legion\AppData\Roaming\AIHub" readonly style="width:350px;background:var(--bg3);font-size:12px"><button class="btn btn-ghost btn-sm">ä¿®æ”¹ç›®å½•</button></div></div>
<div class="setting-row"><div class="setting-row-label">åº”ç”¨ Logs</div><div style="display:flex;gap:8px;align-items:center"><input type="text" value="C:\Users\legion\AppData\Roaming\AIHub\logs" readonly style="width:350px;background:var(--bg3);font-size:12px"><button class="btn btn-ghost btn-sm">æ‰“å¼€æ—¥å¿—</button></div></div>
<div class="setting-row"><div class="setting-row-label">çŸ¥è¯†å°æ–‡ä»¶</div><button class="btn btn-ghost btn-sm">ğŸ“ ç›¸å…³æ–‡ä»¶</button></div>
<div class="setting-row"><div class="setting-row-label">æ¸…é™¤ç¼“å­˜ <small style="color:var(--text2)">(5.2MB)</small></div><button class="btn btn-ghost btn-sm">æ¸…é™¤ç¼“å­˜</button></div>
</div>
<div class="settings-section">
<h4><span>âš ï¸</span> é‡ç½®æ•°æ®</h4>
<button class="btn btn-danger" onclick="clearAllData()">âš ï¸ é‡ç½®æ•°æ®</button>
</div>
<div class="settings-section">
<h4><span>ğŸ“Š</span> å­˜å‚¨ç»Ÿè®¡</h4>
<div class="setting-row"><div class="setting-row-label">å¯¹è¯æ•°é‡</div><span id="statChats">0</span></div>
<div class="setting-row"><div class="setting-row-label">åŠ©æ‰‹æ•°é‡</div><span id="statAssistants">0</span></div>
<div class="setting-row"><div class="setting-row-label">å¿«æ·çŸ­è¯­</div><span id="statShortcuts">0</span></div>
<div class="setting-row"><div class="setting-row-label">æœ¬åœ°å­˜å‚¨ä½¿ç”¨</div><span id="statStorage">0 KB</span></div>
</div>
<div class="settings-section">
<h4><span>ğŸ™</span> GitHub æ¨é€</h4>
<p style="color:var(--text2);font-size:13px;margin-bottom:16px">é…ç½® GitHub ä»“åº“ï¼Œå¯å°† AI ç”Ÿæˆçš„ä»£ç ç›´æ¥æ¨é€åˆ°ä»“åº“</p>
<div class="form-group"><label>ä»“åº“åœ°å€</label><input type="text" id="githubRepoUrl" placeholder="https://github.com/username/repo" style="font-family:monospace"></div>
<div class="form-group"><label>Personal Access Token</label><div style="display:flex;gap:8px"><input type="password" id="githubToken" placeholder="ghp_xxxxxxxxxxxx" style="flex:1;font-family:monospace"><button class="btn btn-ghost btn-sm" onclick="togglePassword('githubToken')">ğŸ‘ï¸</button></div><a href="https://github.com/settings/tokens/new" target="_blank" style="font-size:12px;color:var(--accent)">ç‚¹å‡»è¿™é‡Œè·å– Token (éœ€è¦ repo æƒé™)</a></div>
<div class="form-group"><label>é»˜è®¤åˆ†æ”¯</label><input type="text" id="githubBranch" value="main" style="width:150px"></div>
<div style="display:flex;gap:8px"><button class="btn btn-ghost" onclick="testGithub()">ğŸ” æµ‹è¯•è¿æ¥</button><button class="btn btn-primary" onclick="saveGithubSettings()">ğŸ’¾ ä¿å­˜</button></div>
</div>
<div class="settings-section">
<h4><span>ğŸ“‚</span> æœ¬åœ° Git ä»“åº“</h4>
<p style="color:var(--text2);font-size:13px;margin-bottom:16px">é…ç½®æœ¬åœ° Git ä»“åº“è·¯å¾„ï¼Œå¯å°†ä»£ç æ¨é€åˆ°æœ¬åœ°ä»“åº“</p>
<div class="form-group"><label>ä»“åº“è·¯å¾„</label><input type="text" id="localGitPath" placeholder="D:\projects\my-repo" style="font-family:monospace"></div>
<div style="display:flex;gap:8px"><button class="btn btn-ghost" onclick="testLocalGit()">ğŸ” æµ‹è¯•ä»“åº“</button><button class="btn btn-primary" onclick="saveLocalGitSettings()">ğŸ’¾ ä¿å­˜</button></div>
</div>
</div></div></div></div>
<!-- ä½¿ç”¨ç»Ÿè®¡é¡µ -->
<div id="page-stats" class="page"><div class="content"><div class="content-body"><div class="settings-panel">
<div class="settings-section">
<h4><span>ğŸ“Š</span> ä½¿ç”¨ç»Ÿè®¡</h4>
<div style="display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin-bottom:24px">
<div style="background:var(--bg);padding:20px;border-radius:12px;text-align:center">
<div style="font-size:28px;font-weight:700;color:var(--accent)" id="statTodayCalls">0</div>
<div style="font-size:12px;color:var(--text2);margin-top:4px">ä»Šæ—¥è°ƒç”¨</div>
</div>
<div style="background:var(--bg);padding:20px;border-radius:12px;text-align:center">
<div style="font-size:28px;font-weight:700;color:var(--success)" id="statTotalCalls">0</div>
<div style="font-size:12px;color:var(--text2);margin-top:4px">æ€»è°ƒç”¨æ¬¡æ•°</div>
</div>
<div style="background:var(--bg);padding:20px;border-radius:12px;text-align:center">
<div style="font-size:28px;font-weight:700;color:var(--warning)" id="statTokensInput">0</div>
<div style="font-size:12px;color:var(--text2);margin-top:4px">è¾“å…¥ Tokens</div>
</div>
<div style="background:var(--bg);padding:20px;border-radius:12px;text-align:center">
<div style="font-size:28px;font-weight:700;color:var(--error)" id="statTokensOutput">0</div>
<div style="font-size:12px;color:var(--text2);margin-top:4px">è¾“å‡º Tokens</div>
</div>
</div>
<button class="btn btn-ghost" onclick="loadStats()">ğŸ”„ åˆ·æ–°ç»Ÿè®¡</button>
</div>
<div class="settings-section">
<h4><span>ğŸ“ˆ</span> 7å¤©ä½¿ç”¨è¶‹åŠ¿</h4>
<div id="usageChart" style="background:var(--bg);border-radius:8px;padding:20px;height:200px;display:flex;align-items:flex-end;gap:8px"></div>
</div>
<div class="settings-section">
<h4><span>ğŸ’°</span> æˆæœ¬ä¼°ç®—</h4>
<div style="display:grid;grid-template-columns:repeat(3,1fr);gap:16px">
<div style="background:var(--bg);padding:16px;border-radius:10px;text-align:center">
<div style="font-size:24px;font-weight:700;color:var(--accent)" id="costToday">$0.00</div>
<div style="font-size:12px;color:var(--text2);margin-top:4px">ä»Šæ—¥æˆæœ¬</div>
</div>
<div style="background:var(--bg);padding:16px;border-radius:10px;text-align:center">
<div style="font-size:24px;font-weight:700;color:var(--warning)" id="costMonth">$0.00</div>
<div style="font-size:12px;color:var(--text2);margin-top:4px">æœ¬æœˆæˆæœ¬</div>
</div>
<div style="background:var(--bg);padding:16px;border-radius:10px;text-align:center">
<div style="font-size:24px;font-weight:700;color:var(--success)" id="costTotal">$0.00</div>
<div style="font-size:12px;color:var(--text2);margin-top:4px">æ€»æˆæœ¬</div>
</div>
</div>
<p style="font-size:11px;color:var(--text2);margin-top:12px">* æˆæœ¬æŒ‰ GPT-4 ä»·æ ¼ä¼°ç®—ï¼šè¾“å…¥ $0.03/1Kï¼Œè¾“å‡º $0.06/1K</p>
</div>
<div class="settings-section">
<h4><span>â­</span> æ¨¡å‹è¯„åˆ†ç»Ÿè®¡</h4>
<div id="ratingStats" style="background:var(--bg);border-radius:8px;padding:16px"></div>
</div>
<div class="settings-section">
<h4><span>ğŸ“Š</span> æ¨¡å‹ä½¿ç”¨æ’è¡Œ</h4>
<div id="modelStatsTable" style="background:var(--bg);border-radius:8px;overflow:hidden">
<div style="padding:20px;text-align:center;color:var(--text2)">æš‚æ— æ•°æ®</div>
</div>
</div>
<div class="settings-section">
<h4><span>ğŸ“‹</span> æœ€è¿‘è°ƒç”¨æ—¥å¿—</h4>
<div id="apiLogsTable" style="background:var(--bg);border-radius:8px;overflow:hidden;max-height:400px;overflow-y:auto">
<div style="padding:20px;text-align:center;color:var(--text2)">æš‚æ— æ—¥å¿—</div>
</div>
</div>
</div></div></div></div>
<!-- API Token é¡µ -->
<div id="page-tokens" class="page"><div class="content"><div class="content-body"><div class="settings-panel">
<div class="settings-section">
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px">
<h4 style="margin:0"><span>ğŸ”‘</span> API Token ç®¡ç†</h4>
<button class="btn btn-primary btn-sm" onclick="showCreateTokenModal()">+ åˆ›å»º Token</button>
</div>
<p style="color:var(--text2);margin-bottom:20px">åˆ›å»º API Token ç”¨äºç¬¬ä¸‰æ–¹åº”ç”¨è®¿é—®</p>
<div id="tokenList"></div>
</div>
</div></div></div></div>
<!-- å›¢é˜Ÿç©ºé—´é¡µ -->
<div id="page-teams" class="page"><div class="content"><div class="content-body"><div class="settings-panel">
<div class="settings-section">
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px">
<h4 style="margin:0"><span>ğŸ‘¥</span> å›¢é˜Ÿç©ºé—´</h4>
<button class="btn btn-primary btn-sm" onclick="showCreateTeamModal()">+ åˆ›å»ºå›¢é˜Ÿ</button>
</div>
<p style="color:var(--text2);margin-bottom:20px">ä¸å›¢é˜Ÿæˆå‘˜å…±äº«å¯¹è¯å’Œæ¨¡æ¿</p>
<div id="teamList"></div>
</div>
</div></div></div></div>
<!-- çŸ¥è¯†åº“é¡µ -->
<div id="page-knowledge" class="page"><div class="content"><div class="content-body"><div class="settings-panel">
<div class="settings-section">
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px">
<h4 style="margin:0"><span>ğŸ“š</span> çŸ¥è¯†åº“</h4>
<button class="btn btn-primary btn-sm" onclick="showCreateKBModal()">+ åˆ›å»ºçŸ¥è¯†åº“</button>
</div>
<p style="color:var(--text2);margin-bottom:20px">ä¸Šä¼ æ–‡æ¡£å»ºç«‹ç§æœ‰çŸ¥è¯†åº“ï¼Œè®© AI åŸºäºä½ çš„èµ„æ–™å›ç­”</p>
<div id="kbList"></div>
</div>
</div></div></div></div>
<!-- MCPé¡µ -->
<div id="page-mcp" class="page"><div class="content"><div class="content-body"><div class="settings-panel">
<div class="settings-section" style="text-align:center;padding:40px">
<div style="font-size:48px;margin-bottom:16px;opacity:0.5">ğŸ”Œ</div>
<p style="color:var(--text2)">æœªå¯ç”¨æœåŠ¡å™¨</p>
</div>
<div class="settings-section">
<h4><span>ğŸŒ</span> æ›´å¤š MCP</h4>
<div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px">
<div class="mcp-market-card" onclick="window.open('https://bigmodel.cn/mcp','_blank')"><div style="display:flex;align-items:center;gap:10px"><span style="font-size:20px">ğŸ”µ</span><div><div style="font-weight:500">BigModel MCP Market</div><div style="font-size:12px;color:var(--text2)">æœºå™¨MCPï¼Œåº”æœ‰å°½æœ‰</div></div></div><span style="color:var(--text2)">â†—</span></div>
<div class="mcp-market-card" onclick="window.open('https://modelscope.cn/mcp','_blank')"><div style="display:flex;align-items:center;gap:10px"><span style="font-size:20px">ğŸŸ¢</span><div><div style="font-weight:500">modelscope.cn</div><div style="font-size:12px;color:var(--text2)">é­”æ­ç¤¾åŒº MCP æœåŠ¡å™¨</div></div></div><span style="color:var(--text2)">â†—</span></div>
<div class="mcp-market-card" onclick="window.open('https://mcp.higress.ai','_blank')"><div style="display:flex;align-items:center;gap:10px"><span style="font-size:20px">ğŸŸ£</span><div><div style="font-weight:500">mcp.higress.ai</div><div style="font-size:12px;color:var(--text2)">Higress MCP æœåŠ¡å™¨</div></div></div><span style="color:var(--text2)">â†—</span></div>
<div class="mcp-market-card" onclick="window.open('https://mcp.so','_blank')"><div style="display:flex;align-items:center;gap:10px"><span style="font-size:20px">â“‚ï¸</span><div><div style="font-weight:500">mcp.so</div><div style="font-size:12px;color:var(--text2)">MCP æœåŠ¡å‘ç°å¹³å°</div></div></div><span style="color:var(--text2)">â†—</span></div>
<div class="mcp-market-card" onclick="window.open('https://smithery.ai','_blank')"><div style="display:flex;align-items:center;gap:10px"><span style="font-size:20px">ğŸ”¨</span><div><div style="font-weight:500">smithery.ai</div><div style="font-size:12px;color:var(--text2)">Smithery MCP å·¥å…·</div></div></div><span style="color:var(--text2)">â†—</span></div>
<div class="mcp-market-card" onclick="window.open('https://glama.ai/mcp','_blank')"><div style="display:flex;align-items:center;gap:10px"><span style="font-size:20px">ğŸŸ¡</span><div><div style="font-weight:500">glama.ai</div><div style="font-size:12px;color:var(--text2)">Glama MCP æœåŠ¡å™¨ç›®å½•</div></div></div><span style="color:var(--text2)">â†—</span></div>
<div class="mcp-market-card" onclick="window.open('https://pulsemcp.com','_blank')"><div style="display:flex;align-items:center;gap:10px"><span style="font-size:20px;color:#ec4899">ğŸ…¿ï¸</span><div><div style="font-weight:500">pulsemcp.com</div><div style="font-size:12px;color:var(--text2)">Pulse MCP æœåŠ¡å™¨</div></div></div><span style="color:var(--text2)">â†—</span></div>
<div class="mcp-market-card" onclick="window.open('https://mcp.composio.dev','_blank')"><div style="display:flex;align-items:center;gap:10px"><span style="font-size:20px">âš¡</span><div><div style="font-weight:500">mcp.composio.dev</div><div style="font-size:12px;color:var(--text2)">Composio MCP å¼€å‘å·¥å…·</div></div></div><span style="color:var(--text2)">â†—</span></div>
<div class="mcp-market-card" onclick="window.open('https://github.com/modelcontextprotocol/servers','_blank')"><div style="display:flex;align-items:center;gap:10px"><span style="font-size:20px">ğŸ“‹</span><div><div style="font-weight:500">Model Context Protocol Servers</div><div style="font-size:12px;color:var(--text2)">å®˜æ–¹ MCP æœåŠ¡å™¨ä»“åº“</div></div></div><span style="color:var(--text2)">â†—</span></div>
<div class="mcp-market-card" onclick="window.open('https://github.com/punkpeye/awesome-mcp-servers','_blank')"><div style="display:flex;align-items:center;gap:10px"><span style="font-size:20px">â­</span><div><div style="font-weight:500">Awesome MCP Servers</div><div style="font-size:12px;color:var(--text2)">ç²¾é€‰ MCP æœåŠ¡å™¨åˆ—è¡¨</div></div></div><span style="color:var(--text2)">â†—</span></div>
</div>
</div>
<div class="settings-section">
<h4><span>ğŸ› ï¸</span> å†…ç½®æœåŠ¡å™¨</h4>
<div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:12px">
<div class="mcp-server-card"><div class="mcp-server-header"><span style="font-weight:500">@cherry/mcp-auto-install</span><span class="mcp-add-btn">+</span></div><div class="mcp-server-desc">è‡ªåŠ¨å®‰è£… MCP æœåŠ¡ï¼ˆæµ‹è¯•ç‰ˆï¼‰</div><div class="mcp-server-tags"><span class="tag" style="background:var(--accent);color:#fff">å†…ç½®</span></div></div>
<div class="mcp-server-card"><div class="mcp-server-header"><span style="font-weight:500">@cherry/memory</span><span class="mcp-add-btn">+</span></div><div class="mcp-server-desc">è®©å¤§æ¨¡å‹è®°ä½ä½ çš„å¯¹è¯ä¸Šä¸‹æ–‡ï¼ŒåŒ…å«å…¨å±€è®°å¿†åŠŸèƒ½ï¼Œä¿å­˜ AI åŠ©æ‰‹çš„è®°å¿†ï¼Œè®©å¯¹è¯æ›´è¿è´¯</div><div class="mcp-server-tags"><span class="tag" style="background:var(--accent);color:#fff">å†…ç½®</span><span class="tag" style="background:var(--warning);color:#fff">éœ€è¦é…ç½®</span></div></div>
<div class="mcp-server-card"><div class="mcp-server-header"><span style="font-weight:500">@cherry/sequentialthinking</span><span class="mcp-add-btn">+</span></div><div class="mcp-server-desc">è®© MCP æœåŠ¡å™¨æ·±åº¦æ€è€ƒï¼Œæ”¯æŒ/è¿½æº¯é—®é¢˜æ¥æºå¹¶è¿›è¡Œåˆ†æï¼Œè®© AI æ›´æœ‰é€»è¾‘æ€§åœ°å›ç­”é—®é¢˜</div><div class="mcp-server-tags"><span class="tag" style="background:var(--accent);color:#fff">å†…ç½®</span></div></div>
<div class="mcp-server-card"><div class="mcp-server-header"><span style="font-weight:500">@cherry/brave-search</span><span class="mcp-add-btn">+</span></div><div class="mcp-server-desc">ä½¿ç”¨ Brave æœç´¢ API è¿›è¡Œ MCP æœåŠ¡å™¨æœç´¢æ–‡æ¡£ï¼Œæ”¯æŒæœç´¢ç½‘é¡µå’Œæ–°é—»ï¼Œéœ€è¦é…ç½® BRAVE_API_KEY ç¯å¢ƒå˜é‡</div><div class="mcp-server-tags"><span class="tag" style="background:var(--accent);color:#fff">å†…ç½®</span><span class="tag" style="background:var(--warning);color:#fff">éœ€è¦é…ç½®</span></div></div>
<div class="mcp-server-card"><div class="mcp-server-header"><span style="font-weight:500">@cherry/fetch</span><span class="mcp-add-btn">+</span></div><div class="mcp-server-desc">ç”¨äºè·å– URL ç½‘é¡µå†…å®¹çš„ MCP æœåŠ¡å™¨</div><div class="mcp-server-tags"><span class="tag" style="background:var(--accent);color:#fff">å†…ç½®</span></div></div>
<div class="mcp-server-card"><div class="mcp-server-header"><span style="font-weight:500">@cherry/filesystem</span><span class="mcp-add-btn">+</span></div><div class="mcp-server-desc">è®©æ¨¡å‹æ–‡ä»¶ç³»ç»Ÿæ“ä½œçš„æ¨¡å‹ä¸Šä¸‹æ–‡åè®®ï¼ˆMCPï¼‰çš„ Node.js æœåŠ¡å™¨ï¼Œæ”¯æŒè¯»å–ã€å†™å…¥å’Œåˆ é™¤æ–‡ä»¶</div><div class="mcp-server-tags"><span class="tag" style="background:var(--accent);color:#fff">å†…ç½®</span><span class="tag" style="background:var(--warning);color:#fff">éœ€è¦é…ç½®</span></div></div>
<div class="mcp-server-card"><div class="mcp-server-header"><span style="font-weight:500">@cherry/dify-knowledge</span><span class="mcp-add-btn">+</span></div><div class="mcp-server-desc">Dify çš„ MCP æœåŠ¡å™¨å®ç°ï¼Œä½¿ç”¨äº†ä¸€ä¸ªç®€å•çš„ API æ¥æ£€ç´¢ Dify çŸ¥è¯†åº“ï¼Œéœ€è¦é…ç½® Dify Key</div><div class="mcp-server-tags"><span class="tag" style="background:var(--accent);color:#fff">å†…ç½®</span><span class="tag" style="background:var(--warning);color:#fff">éœ€è¦é…ç½®</span></div></div>
<div class="mcp-server-card"><div class="mcp-server-header"><span style="font-weight:500">@cherry/python</span><span class="mcp-add-btn">+</span></div><div class="mcp-server-desc">åœ¨å®‰å…¨çš„æ²™ç®±ç¯å¢ƒä¸­æ‰§è¡Œ Python ä»£ç ï¼Œä½¿ç”¨ Pyodide è¿è¡Œ Pythonï¼Œæ”¯æŒäººå·¥å®¡æ ¸å’Œä»£ç æ‰§è¡Œ</div><div class="mcp-server-tags"><span class="tag" style="background:var(--accent);color:#fff">å†…ç½®</span></div></div>
<div class="mcp-server-card"><div class="mcp-server-header"><span style="font-weight:500">@cherry/didi-mcp</span><span class="mcp-add-btn">+</span></div><div class="mcp-server-desc">ä¸€ä¸ªç”Ÿæˆäº†æ»´æ»´ MCP æœåŠ¡å™¨å®ç°ï¼Œå¸®åŠ©ç”¨æˆ·æ‰“è½¦æœåŠ¡åŒ…æ‹¬è·¯çº¿æŸ¥è¯¢ã€ä»·æ ¼é¢„ä¼°ã€è®¢å•ç®¡ç†å’Œå¸æœºè°ƒåº¦ï¼Œä»…æ”¯æŒä¸­å›½...</div><div class="mcp-server-tags"><span class="tag" style="background:var(--accent);color:#fff">å†…ç½®</span><span class="tag" style="background:var(--error);color:#fff">å®éªŒæ€§åŠŸèƒ½</span></div></div>
</div>
</div>
</div></div></div></div>
<!-- ç¬”è®°é¡µ -->
<div id="page-notes" class="page"><div class="content"><div class="content-body"><div class="settings-panel">
<div class="settings-section">
<h4><span>ğŸ“</span> æ•°æ®è®¾ç½®</h4>
<div class="setting-row"><div class="setting-row-label">å½“å‰å·¥ä½œç›®å½•</div></div>
<div style="display:flex;gap:8px;margin-bottom:16px">
<input type="text" id="notesWorkDir" value="C:\Users\legion\AppData\Roaming\AIHub\Data\Notes" readonly style="flex:1;background:var(--bg3)">
<button class="btn btn-ghost btn-sm" onclick="selectNotesDir()">ğŸ“ é€‰æ‹©</button>
</div>
<div style="display:flex;gap:8px;margin-bottom:8px">
<button class="btn btn-ghost btn-sm" onclick="applyNotesDir()">ğŸ”„ åº”ç”¨</button>
<button class="btn btn-ghost btn-sm" onclick="resetNotesDir()">é‡ç½®ä¸ºé»˜è®¤</button>
</div>
<p style="font-size:12px;color:var(--text2)">å·¥ä½œç›®å½•ä¿å­˜ç¬”è®°æ–‡ä»¶ä½ç½®ï¼Œæ›´æ¢å·¥ä½œç›®å½•ä¸ä¼šç§»åŠ¨åŸæœ‰æ–‡ä»¶ï¼Œè¯·æ‰‹åŠ¨è¿ç§»æ–‡ä»¶ã€‚</p>
</div>
<div class="settings-section">
<h4><span>âœï¸</span> ç¼–è¾‘å™¨è®¾ç½®</h4>
<div class="setting-row"><div class="setting-row-label">é»˜è®¤è§†å›¾<br><small style="color:var(--text2)">æ–°å»ºç¬”è®°æ—¶çš„è§†å›¾æ¨¡å¼</small></div><select id="noteDefaultView" style="width:120px;padding:8px;background:var(--bg);border:1px solid var(--border);border-radius:6px;color:var(--text)"><option value="edit">ç¼–è¾‘æ¨¡å¼</option><option value="preview">é¢„è§ˆæ¨¡å¼</option><option value="split">åˆ†å±æ¨¡å¼</option></select></div>
<div class="setting-row"><div class="setting-row-label">é»˜è®¤ç¼–è¾‘è§†å›¾<br><small style="color:var(--text2)">åœ¨ç¼–è¾‘æ¨¡å¼ä¸‹ï¼Œæ–°å»ºç¬”è®°æ—¶é‡‡ç”¨çš„ç¼–è¾‘æ¨¡å¼</small></div><select id="noteEditView" style="width:120px;padding:8px;background:var(--bg);border:1px solid var(--border);border-radius:6px;color:var(--text)"><option value="source">æºç æ¨¡å¼</option><option value="wysiwyg">å®æ—¶é¢„è§ˆ</option></select></small></div><select style="width:120px;padding:8px;background:var(--bg);border:1px solid var(--border);border-radius:6px;color:var(--text)"><option>å®æ—¶é¢„è§ˆ</option><option>æºç æ¨¡å¼</option></select></div>
</div>
<div class="settings-section">
<h4><span>ğŸ–¥ï¸</span> æ˜¾ç¤ºè®¾ç½®</h4>
<div class="setting-row"><div class="setting-row-label">ç¼©å‡è¡Œå®½<br><small style="color:var(--text2)">å¼€å¯åå°†é™åˆ¶æ¯è¡Œå­—æ•°ï¼Œä½¿æ®µè½æ›´æ˜“é˜…è¯»</small></div><label class="switch"><input type="checkbox"><span class="switch-slider"></span></label></div>
<div class="setting-row"><div class="setting-row-label">å­—ä½“å¤§å°<br><small style="color:var(--text2)">è°ƒæ•´å­—ä½“å¤§å°ä»¥è·å¾—æ›´å¥½çš„é˜…è¯»ä½“éªŒ (10-30px)</small></div><div class="slider-container"><input type="range" min="10" max="30" value="16" oninput="this.nextElementSibling.textContent=this.value+'px'"><span class="slider-value">16px</span></div></div>
<div class="setting-row"><div class="setting-row-label">æ˜¾ç¤ºç›®å½•å¤§çº²<br><small style="color:var(--text2)">æ˜¾ç¤ºç›®å½•å¤§çº²å¯¼èˆªæ ï¼Œæ–¹ä¾¿æ–‡æ¡£å¯¼èˆª</small></div><label class="switch"><input type="checkbox" checked><span class="switch-slider"></span></label></div>
</div>
</div>
<!-- ç®€åŒ–ç‰ˆç¬”è®°åŒºåŸŸï¼Œé¿å…æ¸²æŸ“ç©ºèŠ‚ç‚¹å¯¼è‡´çš„ JS æŠ¥é”™ -->
<div style="margin-top:16px;display:grid;grid-template-columns:240px 1fr;gap:12px">
  <div style="background:var(--bg2);border:1px solid var(--border);border-radius:12px;min-height:200px;padding:12px">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
      <div style="font-weight:600">ç¬”è®°åˆ—è¡¨</div>
      <button class="btn btn-ghost btn-sm" onclick="newNote()">+ æ–°å»º</button>
    </div>
    <div id="noteList" style="display:flex;flex-direction:column;gap:6px"></div>
  </div>
  <div style="background:var(--bg2);border:1px solid var(--border);border-radius:12px;padding:12px;min-height:200px;display:flex;flex-direction:column;gap:8px">
    <input id="noteTitle" placeholder="æ ‡é¢˜" style="padding:10px;border:1px solid var(--border);border-radius:8px;background:var(--bg3);color:var(--text)">
    <textarea id="noteContent" placeholder="å†…å®¹" style="flex:1;min-height:180px;padding:10px;border:1px solid var(--border);border-radius:8px;background:var(--bg3);color:var(--text);resize:vertical"></textarea>
    <div style="display:flex;gap:8px;justify-content:flex-end">
      <button class="btn btn-ghost btn-sm" onclick="deleteNote()">åˆ é™¤</button>
      <button class="btn btn-primary btn-sm" onclick="saveNote()">ä¿å­˜</button>
    </div>
  </div>
</div></div></div></div>
<!-- ç½‘ç»œæœç´¢é¡µ -->
<div id="page-search" class="page"><div class="content"><div class="content-body"><div class="settings-panel">
<div class="settings-section">
<h4><span>ğŸŒ</span> ç½‘ç»œæœç´¢</h4>
<div class="setting-row"><div class="setting-row-label">æœç´¢æœåŠ¡å•†</div><select id="searchProvider" onchange="onSearchProviderChange()" style="width:180px;padding:8px;background:var(--bg);border:1px solid var(--border);border-radius:6px;color:var(--text)"><option value="zhipu">Zhipu (API å¯†é’¥)</option><option value="searxng">SearXNG</option><option value="tavily">Tavily</option><option value="exa">Exa</option></select></div>
</div>
<div class="settings-section" id="searchZhipuSection">
<div style="display:flex;align-items:center;gap:8px;margin-bottom:16px"><span style="color:var(--accent)">â—</span><span>Zhipu</span><a href="https://open.bigmodel.cn" target="_blank" style="color:var(--text2);font-size:12px">â†—</a></div>
<div class="form-group"><label>API å¯†é’¥</label><div style="display:flex;gap:8px"><input type="password" id="zhipuSearchKey" placeholder="è¾“å…¥ Zhipu API å¯†é’¥" style="flex:1"><button class="btn btn-ghost btn-sm" onclick="togglePassword('zhipuSearchKey')">ğŸ‘ï¸</button><button class="btn btn-ghost btn-sm" onclick="testSearchKey()">æ£€æµ‹</button></div><a href="#" style="font-size:12px;color:var(--accent)">ç‚¹å‡»è¿™é‡Œè·å–å¯†é’¥</a><span style="font-size:12px;color:var(--text2);margin-left:auto">å¤šä¸ªå¯†é’¥è¯·ç”¨é€—å·åˆ†éš”</span></div>
<div class="form-group"><label>API åœ°å€</label><input type="text" value="https://open.bigmodel.cn/api/paas/v4/web_search" readonly style="background:var(--bg3)"></div>
</div>
<div class="settings-section" id="searchSearxngSection" style="display:none">
<div style="display:flex;align-items:center;gap:8px;margin-bottom:16px"><span style="color:var(--success)">â—</span><span>SearXNG</span><a href="https://searx.space" target="_blank" style="color:var(--text2);font-size:12px">â†—</a></div>
<div class="form-group"><label>API åœ°å€</label><input type="text" id="searxngUrl" value="https://search.inetol.net" placeholder="https://search.inetol.net"></div>
<div class="form-group"><label>API å¯†é’¥</label><input type="password" id="searxngKey" placeholder="å¯é€‰ï¼ŒæŸäº›å®ä¾‹éœ€è¦"></div>
</div>
<div class="settings-section">
<h4><span>âš™ï¸</span> å¸¸è§„è®¾ç½®</h4>
<div class="setting-row"><div class="setting-row-label">æœç´¢å·²å¯ç”¨<br><small style="color:var(--text2)">å¯ç”¨åï¼ŒAI å¯ä»¥æœç´¢äº’è”ç½‘è·å–æœ€æ–°ä¿¡æ¯</small></div><label class="switch"><input type="checkbox" id="searchEnabled" checked><span class="switch-slider"></span></label></div>
<div class="setting-row"><div class="setting-row-label">æœç´¢ç»“æœä¸ªæ•°<br><small style="color:var(--text2)">æ¯æ¬¡æœç´¢è¿”å›çš„ç»“æœæ•°é‡ (1-100)</small></div><div class="slider-container"><input type="range" min="1" max="100" value="5" id="searchResultCount" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">5</span></div></div>
</div>
<div class="settings-section">
<h4><span>ğŸ“¦</span> æœç´¢ç»“æœå‹ç¼©</h4>
<div class="setting-row"><div class="setting-row-label">å‹ç¼©æ–¹æ³•<br><small style="color:var(--text2)">å¯¹æœç´¢ç»“æœè¿›è¡Œå‹ç¼©ä»¥èŠ‚çœ Token</small></div><select style="width:120px;padding:8px;background:var(--bg);border:1px solid var(--border);border-radius:6px;color:var(--text)"><option>ä¸å‹ç¼©</option><option>ç®€å•å‹ç¼©</option><option>AI å‹ç¼©</option></select></div>
</div>
<div class="settings-section">
<h4><span>ğŸš«</span> é»‘åå•</h4>
<div class="form-group"><label>åœ¨æœç´¢ç»“æœä¸­ä¸ä¼šå‡ºç°ä»¥ä¸‹ç½‘ç«™çš„ç»“æœ<br><small style="color:var(--text2)">è¯·æŒ‰ä»¥ä¸‹æ ¼å¼æ·»åŠ (æ¯è¡Œä¸€ä¸ª)</small></label><textarea rows="4" id="searchBlacklist" placeholder="å®Œæ•´åŸŸå: *.example.com/*&#10;æ­£åˆ™è¡¨è¾¾å¼: /.*example\.net\.org/"></textarea></div>
<button class="btn btn-primary" onclick="saveSearchSettings()">ä¿å­˜</button>
</div>
</div></div></div></div>
<!-- å…¨å±€è®°å¿†é¡µ -->
<div id="page-memory" class="page"><div class="content"><div class="content-body"><div class="settings-panel">
<div class="settings-section">
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px">
<div style="display:flex;align-items:center;gap:12px"><h4 style="margin:0"><span>ğŸ§ </span> å…¨å±€è®°å¿†</h4><span class="tag tag-primary">Beta</span></div>
<div style="display:flex;align-items:center;gap:12px"><label class="switch"><input type="checkbox" id="memoryEnabled" checked><span class="switch-slider"></span></label><button class="btn btn-ghost btn-sm">âš™ï¸</button></div>
</div>
</div>
<div class="settings-section">
<h4><span>ğŸ‘¤</span> ç”¨æˆ·ç®¡ç†</h4>
<div class="setting-row"><div class="setting-row-label">ç”¨æˆ· ID<br><small style="color:var(--text2)">0 æ¡è®°å¿†</small></div><div style="display:flex;align-items:center;gap:8px"><span style="display:flex;align-items:center;gap:6px;padding:6px 12px;background:var(--accent);color:#fff;border-radius:6px;font-size:13px">ğŸ‘¤ é»˜è®¤ç”¨æˆ·</span><select style="width:80px;padding:6px;background:var(--bg);border:1px solid var(--border);border-radius:6px;color:var(--text);font-size:12px"><option>é»˜è®¤</option></select><button class="btn btn-ghost btn-sm">ğŸ‘¤</button></div></div>
<div class="setting-row"><div class="setting-row-label">ç”¨æˆ·<br><small style="color:var(--text2)">ä¸´æ—¶</small></div><span class="tag" style="background:var(--success);color:#fff">0</span></div>
</div>
<div class="settings-section">
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px">
<h4 style="margin:0"><span>ğŸ“š</span> å…¨å±€è®°å¿†</h4>
<div style="display:flex;gap:8px;align-items:center">
<input type="text" placeholder="æœç´¢è®°å¿†..." style="width:150px;padding:6px 12px;background:var(--bg);border:1px solid var(--border);border-radius:6px;color:var(--text);font-size:13px">
<button class="btn btn-primary btn-sm" onclick="showAddMemoryModal()">+ æ·»åŠ è®°å¿†</button>
<button class="btn btn-ghost btn-sm">â‰¡ æ›´å¤š</button>
</div>
</div>
<div id="memoryList"></div>
</div>
</div></div></div></div>
<!-- APIæœåŠ¡å™¨é¡µ -->
<div id="page-api-server" class="page"><div class="content"><div class="content-body"><div class="settings-panel">
<div class="settings-section">
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px">
<div><h4 style="margin:0"><span>ğŸ–¥ï¸</span> API æœåŠ¡å™¨</h4><p style="color:var(--text2);font-size:13px;margin-top:4px">é€šè¿‡ OpenAI å…¼å®¹çš„ HTTP API æš´éœ² AI Hub çš„ AI åŠŸèƒ½</p></div>
<button class="btn btn-primary" onclick="window.open('/docs','_blank')">ğŸ“„ API æ–‡æ¡£</button>
</div>
<div class="card" style="background:var(--bg)">
<div style="display:flex;justify-content:space-between;align-items:center">
<div style="display:flex;align-items:center;gap:8px"><span style="width:10px;height:10px;background:var(--success);border-radius:50%;animation:pulse 2s infinite"></span><span style="color:var(--success);font-weight:500">è¿è¡Œä¸­</span><a href="http://localhost:8000" target="_blank" style="color:var(--text2);font-size:13px">http://localhost:8000</a></div>
<div style="display:flex;gap:8px"><button class="btn btn-ghost btn-sm" onclick="copyText('http://localhost:8000')">ğŸ“‹</button><button class="btn btn-ghost btn-sm">ğŸ—‘ï¸</button></div>
</div>
</div>
</div>
<div class="settings-section">
<h4><span>ğŸ”‘</span> API å¯†é’¥</h4>
<p style="color:var(--text2);font-size:13px;margin-bottom:16px">ç”¨äº API è®¤è¯çš„ä»¤ç‰Œ</p>
<div class="form-group"><label>API å¯†é’¥</label><div style="display:flex;gap:8px"><input type="text" id="apiServerKey" value="cs-sk-e6a3d630-0f63-40f8-95f3-d6d6bc8a8424" readonly style="flex:1;background:var(--bg3);font-family:monospace"><button class="btn btn-ghost btn-sm" onclick="copyText($('apiServerKey').value)">ğŸ“‹</button></div></div>
<div class="form-group"><label>æˆæƒæ ‡å¤´</label><input type="text" value="Authorization: Bearer cs-sk-e6a3d630-0f63-40f8-95f3-d6d6bc8a8424" readonly style="background:var(--bg3);font-family:monospace;font-size:12px"></div>
</div>
<div class="settings-section">
<h4><span>âš™ï¸</span> æœåŠ¡å™¨è®¾ç½®</h4>
<div class="setting-row"><div class="setting-row-label">å¯ç”¨ API æœåŠ¡å™¨</div><label class="switch"><input type="checkbox" checked><span class="switch-slider"></span></label></div>
<div class="setting-row"><div class="setting-row-label">ç«¯å£å·</div><input type="number" value="8000" style="width:100px;padding:8px;background:var(--bg);border:1px solid var(--border);border-radius:6px;color:var(--text)"></div>
<div class="setting-row"><div class="setting-row-label">å…è®¸è·¨åŸŸè¯·æ±‚ (CORS)</div><label class="switch"><input type="checkbox" checked><span class="switch-slider"></span></label></div>
</div>
<div class="settings-section">
<h4><span>ğŸ“–</span> ä½¿ç”¨è¯´æ˜</h4>
<div class="card" style="background:var(--bg)"><p style="font-size:13px;color:var(--text2);margin-bottom:8px">Base URL:</p><code style="display:block;padding:12px;background:var(--bg3);border-radius:8px;font-family:monospace">http://localhost:8000/v1</code></div>
<div class="card" style="background:var(--bg);margin-top:12px"><p style="font-size:13px;color:var(--text2);margin-bottom:8px">ç¤ºä¾‹è¯·æ±‚:</p><pre style="padding:12px;background:var(--bg3);border-radius:8px;font-size:12px;overflow-x:auto;margin:0"><code>curl http://localhost:8000/v1/chat/completions \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{"model":"gpt-4o","messages":[{"role":"user","content":"Hello"}]}'</code></pre></div>
</div>
</div></div></div></div>
<!-- æ–‡æ¡£å¤„ç†é¡µ -->
<div id="page-documents" class="page"><div class="content"><div class="content-body"><div class="settings-panel">
<div class="settings-section">
<h4><span>ğŸ”</span> OCR æœåŠ¡</h4>
<div class="tabs" style="margin-bottom:16px"><div class="tab active">ğŸ“„ å›¾ç‰‡</div></div>
<div class="setting-row"><div class="setting-row-label">OCR æœåŠ¡æä¾›å•†</div><select style="width:150px;padding:8px;background:var(--bg);border:1px solid var(--border);border-radius:6px;color:var(--text)"><option>ç³»ç»Ÿ OCR</option><option>ç™¾åº¦ OCR</option><option>è…¾è®¯ OCR</option></select></div>
</div>
<div class="settings-section">
<h4><span>ğŸ’»</span> ç³»ç»Ÿ OCR</h4>
<div class="setting-row"><div class="setting-row-label">æ”¯æŒçš„è¯­è¨€</div><div style="display:flex;gap:8px"><span class="tag">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</span><span class="tag">ğŸ‡ºğŸ‡¸ è‹±æ–‡</span></div></div>
</div>
<div class="settings-section">
<h4><span>ğŸ“„</span> æ–‡æ¡£å¤„ç†</h4>
<div class="setting-row"><div class="setting-row-label">æ–‡æ¡£å¤„ç†æœåŠ¡å•†</div><select style="width:150px;padding:8px;background:var(--bg);border:1px solid var(--border);border-radius:6px;color:var(--text)"><option>MinerU</option><option>æœ¬åœ°è§£æ</option></select></div>
</div>
<div class="settings-section">
<h4><span>ğŸ”—</span> MinerU</h4>
<div class="form-group"><label>API å¯†é’¥</label><div style="display:flex;gap:8px"><input type="password" id="mineruKey" placeholder="MinerU æä¾›æ¯æ—¥ 500 é¡µçš„å…è´¹é¢åº¦ï¼Œæ‚¨ä¸éœ€è¦è¾“å…¥å¯†é’¥" style="flex:1"><button class="btn btn-ghost btn-sm">ğŸ‘ï¸</button></div><a href="#" style="font-size:12px;color:var(--accent)">ç‚¹å‡»è¿™é‡Œè·å–å¯†é’¥</a><span style="font-size:12px;color:var(--text2);margin-left:auto">å¤šä¸ªå¯†é’¥è¯·ç”¨é€—å·åˆ†éš”</span></div>
<div class="form-group"><label>API åœ°å€</label><input type="text" value="https://mineru.net" readonly></div>
</div>
<div class="settings-section">
<h4><span>ğŸ“</span> ä¸Šä¼ æ–‡æ¡£</h4>
<div style="border:2px dashed var(--border);border-radius:12px;padding:40px;text-align:center;cursor:pointer" onclick="document.getElementById('fileInput').click()"><span style="font-size:48px;display:block;margin-bottom:12px">ğŸ“</span><p style="color:var(--text2)">ç‚¹å‡»ä¸Šä¼ æ–‡ä»¶</p><p style="color:var(--text2);font-size:12px;margin-top:8px">æ”¯æŒ PDF, DOCX, TXT, MD ç­‰æ ¼å¼</p></div>
<input type="file" id="fileInput" style="display:none" onchange="handleFileUpload(event)">
</div>
<div class="settings-section" id="docResult" style="display:none"><h4><span>ğŸ“</span> å†…å®¹</h4><div id="docContent" style="background:var(--bg);padding:16px;border-radius:8px;max-height:300px;overflow-y:auto;white-space:pre-wrap"></div><div style="margin-top:16px"><button class="btn btn-primary" onclick="summarizeDoc()">ğŸ“Š æ‘˜è¦</button><button class="btn btn-ghost" onclick="askAboutDoc()">ğŸ’¬ æé—®</button></div></div>
</div></div></div></div>
<!-- Prompt æ¨¡æ¿é¡µ -->
<div id="page-prompts" class="page"><div class="content"><div class="content-body"><div class="settings-panel">
<div class="settings-section">
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px">
<h4 style="margin:0"><span>ğŸ“‹</span> Prompt æ¨¡æ¿åº“</h4>
<button class="btn btn-primary btn-sm" onclick="showAddPromptModal()">+ æ–°å»ºæ¨¡æ¿</button>
</div>
<div style="display:flex;gap:8px;margin-bottom:16px;flex-wrap:wrap">
<button class="btn btn-ghost btn-sm prompt-cat-btn active" onclick="filterPrompts('all',this)">å…¨éƒ¨</button>
<button class="btn btn-ghost btn-sm prompt-cat-btn" onclick="filterPrompts('writing',this)">âœï¸ å†™ä½œ</button>
<button class="btn btn-ghost btn-sm prompt-cat-btn" onclick="filterPrompts('coding',this)">ğŸ’» ç¼–ç¨‹</button>
<button class="btn btn-ghost btn-sm prompt-cat-btn" onclick="filterPrompts('translate',this)">ğŸŒ ç¿»è¯‘</button>
<button class="btn btn-ghost btn-sm prompt-cat-btn" onclick="filterPrompts('analysis',this)">ğŸ“Š åˆ†æ</button>
<button class="btn btn-ghost btn-sm prompt-cat-btn" onclick="filterPrompts('creative',this)">ğŸ¨ åˆ›æ„</button>
</div>
<div id="promptList" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:12px"></div>
</div>
</div></div></div></div>
<!-- å¿«æ·çŸ­è¯­é¡µ -->
<div id="page-shortcuts" class="page"><div class="content"><div class="content-body"><div class="settings-panel">
<div class="settings-section" style="padding:16px">
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px">
<h4 style="margin:0"><span>âš¡</span> å¿«æ·çŸ­è¯­</h4>
<button class="btn btn-ghost btn-sm" onclick="showAddShortcutModal()">+</button>
</div>
<div id="shortcutList" style="min-height:200px"></div>
</div>
</div></div></div></div>
<!-- å¿«æ·é”®é¡µ -->
<div id="page-hotkeys" class="page"><div class="content"><div class="content-body"><div class="settings-panel">
<div class="settings-section" style="padding:16px">
<h4 style="margin-bottom:16px"><span>âŒ¨ï¸</span> å¿«æ·é”®</h4>
<div class="hotkey-row"><span>æ”¾å¤§ç•Œé¢</span><div class="hotkey-right"><span class="hotkey-key">Ctrl + =</span><span class="hotkey-info">â„¹ï¸</span><span class="hotkey-lock">ğŸ”’</span><label class="switch"><input type="checkbox" checked><span class="switch-slider"></span></label></div></div>
<div class="hotkey-row"><span>ç¼©å°ç•Œé¢</span><div class="hotkey-right"><span class="hotkey-key">Ctrl + -</span><span class="hotkey-info">â„¹ï¸</span><span class="hotkey-lock">ğŸ”’</span><label class="switch"><input type="checkbox" checked><span class="switch-slider"></span></label></div></div>
<div class="hotkey-row"><span>é‡ç½®ç¼©æ”¾</span><div class="hotkey-right"><span class="hotkey-key">Ctrl + 0</span><span class="hotkey-info">â„¹ï¸</span><span class="hotkey-lock">ğŸ”’</span><label class="switch"><input type="checkbox" checked><span class="switch-slider"></span></label></div></div>
<div class="hotkey-row"><span>æ‰“å¼€è®¾ç½®</span><div class="hotkey-right"><span class="hotkey-key">Ctrl + ,</span><span class="hotkey-info">â„¹ï¸</span><span class="hotkey-lock">ğŸ”’</span><label class="switch"><input type="checkbox" checked><span class="switch-slider"></span></label></div></div>
<div class="hotkey-row"><span>æ˜¾ç¤º/éšè—åº”ç”¨</span><div class="hotkey-right"><span class="hotkey-key">æŒ‰ä¸‹å¿«æ·é”®</span><span class="hotkey-info">â„¹ï¸</span><span class="hotkey-lock">ğŸ”’</span><label class="switch"><input type="checkbox" checked><span class="switch-slider"></span></label></div></div>
<div class="hotkey-row"><span>å¿«æ·åŠ©æ‰‹</span><div class="hotkey-right"><span class="hotkey-key">Ctrl + E</span><span class="hotkey-info">â„¹ï¸</span><span class="hotkey-lock">ğŸ”’</span><label class="switch"><input type="checkbox" checked><span class="switch-slider"></span></label></div></div>
<div class="hotkey-row"><span>å¼€å…³åˆ’è¯åŠ©æ‰‹</span><div class="hotkey-right"><span class="hotkey-key">æŒ‰ä¸‹å¿«æ·é”®</span><span class="hotkey-info">â„¹ï¸</span><span class="hotkey-lock">ğŸ”’</span><label class="switch"><input type="checkbox"><span class="switch-slider"></span></label></div></div>
<div class="hotkey-row"><span>åˆ’è¯åŠ©æ‰‹ï¼šå–è¯</span><div class="hotkey-right"><span class="hotkey-key">æŒ‰ä¸‹å¿«æ·é”®</span><span class="hotkey-info">â„¹ï¸</span><span class="hotkey-lock">ğŸ”’</span><label class="switch"><input type="checkbox"><span class="switch-slider"></span></label></div></div>
<div class="hotkey-row"><span>é€€å‡ºå…¨å±</span><div class="hotkey-right"><span class="hotkey-key">Escape</span><span class="hotkey-info">â„¹ï¸</span><span class="hotkey-lock">ğŸ”’</span><label class="switch"><input type="checkbox" checked><span class="switch-slider"></span></label></div></div>
<div class="hotkey-row"><span>æ–°å»ºè¯é¢˜</span><div class="hotkey-right"><span class="hotkey-key">Ctrl + N</span><span class="hotkey-info">â„¹ï¸</span><span class="hotkey-lock">ğŸ”’</span><label class="switch"><input type="checkbox" checked><span class="switch-slider"></span></label></div></div>
<div class="hotkey-row"><span>é‡å‘½åè¯é¢˜</span><div class="hotkey-right"><span class="hotkey-key">Ctrl + T</span><span class="hotkey-info">â„¹ï¸</span><span class="hotkey-lock">ğŸ”’</span><label class="switch"><input type="checkbox"><span class="switch-slider"></span></label></div></div>
<div class="hotkey-row"><span>åˆ‡æ¢åŠ©æ‰‹æ˜¾ç¤º</span><div class="hotkey-right"><span class="hotkey-key">Ctrl + [</span><span class="hotkey-info">â„¹ï¸</span><span class="hotkey-lock">ğŸ”’</span><label class="switch"><input type="checkbox" checked><span class="switch-slider"></span></label></div></div>
<div class="hotkey-row"><span>åˆ‡æ¢è¯é¢˜æ˜¾ç¤º</span><div class="hotkey-right"><span class="hotkey-key">Ctrl + ]</span><span class="hotkey-info">â„¹ï¸</span><span class="hotkey-lock">ğŸ”’</span><label class="switch"><input type="checkbox" checked><span class="switch-slider"></span></label></div></div>
<div class="hotkey-row"><span>å¤åˆ¶ä¸Šä¸€æ¡æ¶ˆæ¯</span><div class="hotkey-right"><span class="hotkey-key">Ctrl + Shift + C</span><span class="hotkey-info">â„¹ï¸</span><span class="hotkey-lock">ğŸ”’</span><label class="switch"><input type="checkbox"><span class="switch-slider"></span></label></div></div>
<div class="hotkey-row"><span>ç¼–è¾‘æœ€åä¸€æ¡ç”¨æˆ·æ¶ˆæ¯</span><div class="hotkey-right"><span class="hotkey-key">Ctrl + Shift + E</span><span class="hotkey-info">â„¹ï¸</span><span class="hotkey-lock">ğŸ”’</span><label class="switch"><input type="checkbox"><span class="switch-slider"></span></label></div></div>
</div>
</div></div></div></div>
<!-- å¿«æ·åŠ©æ‰‹é¡µ -->
<div id="page-quick-assistant" class="page"><div class="content"><div class="content-body"><div class="settings-panel">
<div class="settings-section">
<h4><span>ğŸš€</span> å¿«æ·åŠ©æ‰‹</h4>
<div class="setting-row"><div class="setting-row-label">å¯ç”¨å¿«æ·åŠ©æ‰‹</div><label class="switch"><input type="checkbox" checked><span class="switch-slider"></span></label></div>
<div class="setting-row"><div class="setting-row-label">ç‚¹å‡»æ‰˜ç›˜å›¾æ ‡å¯åŠ¨</div><label class="switch"><input type="checkbox" checked><span class="switch-slider"></span></label></div>
<div class="setting-row"><div class="setting-row-label">å¯åŠ¨æ—¶è¯»å–å‰ªè´´æ¿</div><label class="switch"><input type="checkbox" checked><span class="switch-slider"></span></label></div>
</div>
<div class="settings-section">
<div class="setting-row"><div class="setting-row-label">å¿«æ·åŠ©æ‰‹æ¨¡å‹</div>
<div style="display:flex;align-items:center;gap:12px">
<span style="display:flex;align-items:center;gap:6px">ğŸ˜€ é»˜è®¤åŠ©æ‰‹</span>
<select style="width:80px;padding:6px;background:var(--bg);border:1px solid var(--border);border-radius:6px;color:var(--text);font-size:12px"><option>é»˜è®¤</option></select>
<div style="display:flex;gap:4px">
<button class="btn btn-primary btn-sm">ä½¿ç”¨åŠ©æ‰‹</button>
<button class="btn btn-ghost btn-sm">é»˜è®¤æ¨¡å‹</button>
</div>
</div>
</div>
<div style="display:flex;gap:8px;margin:16px 0;justify-content:center">
<span style="font-size:20px;cursor:pointer" title="Suno">ğŸµ</span>
<span style="font-size:20px;cursor:pointer" title="ä¸­æ–‡">ä¸­</span>
<span style="font-size:20px;cursor:pointer" title="ç”»å›¾">ğŸ¨</span>
<span style="font-size:20px;cursor:pointer" title="é‚®ä»¶">ğŸ“§</span>
<span style="font-size:20px;cursor:pointer" title="Twitter">ğŸ¦</span>
<span style="font-size:20px;cursor:pointer" title="ä»£ç ">ğŸ’»</span>
<span style="font-size:20px;cursor:pointer" title="æ›´å¤š">ğŸ˜€</span>
</div>
</div>
<div class="settings-section">
<div style="display:flex;align-items:center;gap:12px;padding:12px;background:var(--bg);border-radius:10px;margin-bottom:16px">
<span style="font-size:24px">ğŸ˜€</span>
<span style="color:var(--text2)">è¯¢é—® é»˜è®¤åŠ©æ‰‹ è·å–å¸®åŠ©...</span>
</div>
<div style="background:var(--bg);border-radius:10px;padding:12px;margin-bottom:12px">
<div style="display:flex;align-items:center;gap:8px;color:var(--text2);font-size:14px">
<span>ğŸ’¬</span> å›ç­”æ­¤é—®é¢˜
<span style="margin-left:auto">â†µ</span>
</div>
</div>
<div class="list-item" style="cursor:pointer"><div class="list-item-icon" style="background:transparent;font-size:20px">ğŸŒ</div><div class="list-item-content"><div class="list-item-title">æ–‡æœ¬ç¿»è¯‘</div></div></div>
<div class="list-item" style="cursor:pointer"><div class="list-item-icon" style="background:transparent;font-size:20px">ğŸ“„</div><div class="list-item-content"><div class="list-item-title">å†…å®¹æ€»ç»“</div></div></div>
<div class="list-item" style="cursor:pointer"><div class="list-item-icon" style="background:transparent;font-size:20px">ğŸ’¡</div><div class="list-item-content"><div class="list-item-title">è§£é‡Šè¯´æ˜</div></div></div>
</div>
<div style="text-align:center;padding:12px;color:var(--text2);font-size:12px">âŒ˜ æŒ‰ ESC å…³é—­</div>
</div></div></div></div>
<!-- åˆ’è¯åŠ©æ‰‹é¡µ -->
<div id="page-selection-assistant" class="page"><div class="content"><div class="content-body"><div class="settings-panel">
<div class="settings-section">
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px">
<h4 style="margin:0"><span>âœ‚ï¸</span> åˆ’è¯åŠ©æ‰‹</h4>
<a href="#" style="color:var(--accent);font-size:13px">FAQ & åé¦ˆ</a>
</div>
<div class="setting-row"><div class="setting-row-label">å¯ç”¨</div><label class="switch"><input type="checkbox" checked><span class="switch-slider"></span></label></div>
</div>
<div class="settings-section">
<h4><span>ğŸ”§</span> å·¥å…·æ </h4>
<div class="setting-row">
<div class="setting-row-label">å–è¯æ–¹å¼<br><small style="color:var(--text2)">åˆ’è¯åï¼Œè§¦å‘åˆ’è¯åŠ©æ‰‹çš„æ–¹å¼</small></div>
<div style="display:flex;gap:8px">
<button class="btn btn-primary btn-sm">åˆ’è¯</button>
<button class="btn btn-ghost btn-sm">Ctrl é”®</button>
<button class="btn btn-ghost btn-sm">å¿«æ·é”®</button>
</div>
</div>
<div class="setting-row"><div class="setting-row-label">ç´§å‡‘æ¨¡å¼<br><small style="color:var(--text2)">ç´§å‡‘æ¨¡å¼ä¸‹ï¼Œåªæ˜¾ç¤ºå›¾æ ‡ï¼Œä¸æ˜¾ç¤ºæ–‡å­—</small></div><label class="switch"><input type="checkbox"><span class="switch-slider"></span></label></div>
</div>
<div class="settings-section">
<h4><span>ğŸªŸ</span> åŠŸèƒ½çª—å£</h4>
<div class="setting-row"><div class="setting-row-label">è·Ÿéšå·¥å…·æ <br><small style="color:var(--text2)">çª—å£ä½ç½®è·Ÿéšå·¥å…·æ æ˜¾ç¤ºï¼Œè®©å›ç­”å†…å®¹ç¦»åˆ’è¯ä½ç½®æ›´è¿‘</small></div><label class="switch"><input type="checkbox" checked><span class="switch-slider"></span></label></div>
<div class="setting-row"><div class="setting-row-label">é’‰ä½äººå°<br><small style="color:var(--text2)">é’‰ä½åï¼Œçª—å£ä¼šä¿æŒä¸Šæ¬¡è°ƒæ•´çš„å¤§å°æ˜¾ç¤º</small></div><label class="switch"><input type="checkbox"><span class="switch-slider"></span></label></div>
<div class="setting-row"><div class="setting-row-label">è‡ªåŠ¨å…³é—­<br><small style="color:var(--text2)">å½“é¼ æ ‡ä¸åœ¨çª—å£åŒºåŸŸæ—¶å…³é—­ï¼Œå°†è‡ªåŠ¨å…³é—­çª—å£</small></div><label class="switch"><input type="checkbox"><span class="switch-slider"></span></label></div>
<div class="setting-row"><div class="setting-row-label">è‡ªåŠ¨æœ—è¯»<br><small style="color:var(--text2)">é»˜è®¤å°†æœ—è¯»ä¸Šæ¬¡æ‰“å¼€çš„ç¿»è¯‘</small></div><label class="switch"><input type="checkbox"><span class="switch-slider"></span></label></div>
<div class="setting-row"><div class="setting-row-label">é€æ˜åº¦<br><small style="color:var(--text2)">è®¾ç½®çª—å£é€æ˜åº¦ï¼Œ100% ä¸ºå®Œå…¨ä¸é€æ˜</small></div><div class="slider-container"><span class="slider-value">100%</span><input type="range" min="50" max="100" value="100" style="width:150px"></div></div>
</div>
<div class="settings-section">
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px">
<h4 style="margin:0"><span>âš¡</span> åŠŸèƒ½</h4>
<div style="display:flex;gap:8px">
<button class="btn btn-ghost btn-sm">é‡ç½®</button>
<button class="btn btn-primary btn-sm">+ è‡ªå®šä¹‰åŠŸèƒ½</button>
</div>
</div>
<div style="display:flex;gap:8px;justify-content:center;margin-bottom:16px;padding:12px;background:var(--bg);border-radius:8px">
<span style="display:flex;align-items:center;gap:4px;padding:6px 12px;background:var(--error);color:#fff;border-radius:6px;font-size:13px">ğŸš« ç¦ç”¨</span>
<span style="display:flex;align-items:center;gap:4px;padding:6px 12px;background:var(--bg3);border-radius:6px;font-size:13px">ğŸŒ ç¿»è¯‘</span>
<span style="display:flex;align-items:center;gap:4px;padding:6px 12px;background:var(--bg3);border-radius:6px;font-size:13px">ğŸ“– è§£é‡Š</span>
<span style="display:flex;align-items:center;gap:4px;padding:6px 12px;background:var(--bg3);border-radius:6px;font-size:13px">ğŸ“Š æ€»ç»“</span>
<span style="display:flex;align-items:center;gap:4px;padding:6px 12px;background:var(--bg3);border-radius:6px;font-size:13px">ğŸ” æœç´¢</span>
<span style="display:flex;align-items:center;gap:4px;padding:6px 12px;background:var(--bg3);border-radius:6px;font-size:13px">ğŸ“‹ å¤åˆ¶</span>
</div>
<div class="list-item" style="cursor:pointer"><div class="list-item-icon" style="background:transparent;font-size:20px">ğŸŒ</div><div class="list-item-content"><div class="list-item-title">ç¿»è¯‘</div></div></div>
</div>
</div></div></div></div>
<!-- å…³äºæˆ‘ä»¬é¡µ -->
<div id="page-about" class="page"><div class="content"><div class="content-body"><div class="settings-panel">
<div class="settings-section">
<div style="display:flex;align-items:center;gap:20px;margin-bottom:24px">
<div style="width:80px;height:80px;background:linear-gradient(135deg,#6366f1,#ec4899);border-radius:20px;display:flex;align-items:center;justify-content:center;font-size:40px">ğŸ¤–</div>
<div><h2 style="font-size:24px;margin-bottom:4px">AI Hub</h2><p style="color:var(--text2)">ä¸€æ¬¾ä¸ºåˆ›é€ è€…è€Œç”Ÿçš„ AI åŠ©æ‰‹</p><span class="tag tag-primary" style="margin-top:8px;display:inline-block">v1.7.2</span></div>
<button class="btn btn-ghost" style="margin-left:auto" onclick="checkUpdate()">ç«‹å³æ›´æ–°</button>
</div>
<div class="setting-row"><div class="setting-row-label">è‡ªåŠ¨æ›´æ–°</div><label class="switch"><input type="checkbox" checked><span class="switch-slider"></span></label></div>
<div class="setting-row"><div class="setting-row-label">æµ‹è¯•è®¡åˆ’ <small>è·å–æœ€æ–°æµ‹è¯•ç‰ˆæœ¬</small></div><label class="switch"><input type="checkbox"><span class="switch-slider"></span></label></div>
</div>
<div class="settings-section">
<h4><span>ğŸ“‹</span> å‘ç°æ–°ç‰ˆæœ¬ 1.7.2</h4>
<div class="changelog">
<div class="changelog-item">
<div class="changelog-version">AI Hub 1.7.2 - ç¨³å®šæ€§ä¸ä½“éªŒæå‡<span class="changelog-date">2024-12-10</span></div>
<div class="changelog-content">æœ¬æ¬¡æ›´æ–°ä¸“æ³¨äºç¨³å®šæ€§æ”¹è¿›ï¼ŒåŒæ—¶ä¿®å¤ç”¨æˆ·ä½“éªŒé—®é¢˜ã€‚
<ul>
<li>ğŸ¨ <b>åŠŸèƒ½æ”¹è¿›</b></li>
<li>å¢å¼ºèŠå¤©å¯¹è¯æ¡†ç¡®è®¤åˆ é™¤çŠ¶æ€ç®¡ç†</li>
<li>ä¼˜åŒ–å› åªè¨€å·¦é”®å³é”®å¯¹é½ä½“éªŒ</li>
<li>æ”¹è¿›æ¸©åº¦å’Œ top_p å‚æ•°å¤„ç†é€»è¾‘</li>
<li>æ”¯æŒç”¨æˆ·è‡ªå®šä¹‰ OpenAI API è®¤è¯å¤´</li>
<li>ç¿»è¯‘åŠŸèƒ½çª—å£æ”¯æŒä¹‰æ ¼ä¹‰æ ¼ä¹‰ä»¶</li>
</ul>
<ul>
<li>ğŸ¤– <b>AI ä¸æ¨¡å‹</b></li>
<li>ä¸º Gemini 3 Pro Image æ·»åŠ å›¾ç‰‡å¼è¯·æ±‚ token æ”¯æŒ</li>
<li>æ›´æ–° DeepSeek æ¨¡å‹ä»¥é€‚é… DeepSeek v3.2</li>
<li>æ›´æ–° AiOnly é»˜è®¤æ¨¡å‹</li>
<li>æ›´æ–° AI æ¨¡å‹é…ç½®è‡³æœ€æ–°ç‰ˆæœ¬</li>
</ul>
<ul>
<li>â™¿ <b>æ— éšœç¢æ”¯æŒ</b></li>
<li>æ”¹è¿›å±å¹•é˜…è¯»å™¨ (NVDA) æ”¯æŒï¼Œæ·»åŠ  aria-label å±æ€§</li>
<li>æ–°å¢é˜´å½±æŒ‰é’®è¾¹æ¡†ä¸æ£€æŸ¥æ”¯æŒ</li>
</ul>
<ul>
<li>ğŸ› <b>é—®é¢˜ä¿®å¤</b></li>
<li>ä¿®å¤å¿«æ·åŠ©æ‰‹æ— æ³•æ³¨å†Œå¿«æ·é”®çš„é—®é¢˜</li>
<li>ä¿®å¤å¤šæ–‡ä»¶æµæ¶ˆæ¯æ—¶ UI æ´»åŠ¨é—®é¢˜ï¼ˆé€šè¿‡æ‰¹å¤„ç†ä¼˜åŒ–ï¼‰</li>
<li>ä¿®å¤ç¿»è¯‘ç»“æœç”¨åˆ° textBlock ä¸»é¢˜ä¸»é¢˜çš„é—®é¢˜</li>
</ul>
</div>
</div>
<div class="changelog-item">
<div class="changelog-version">AI Hub 1.7.1<span class="changelog-date">2024-12-05</span></div>
<div class="changelog-content">
<ul>
<li>æ–°å¢å¤šæ¨¡å‹åŒæ—¶å›ç­”åŠŸèƒ½</li>
<li>ä¼˜åŒ–æµå¼è¾“å‡ºæ€§èƒ½</li>
<li>ä¿®å¤è‹¥å¹²å·²çŸ¥é—®é¢˜</li>
</ul>
</div>
</div>
</div>
</div>
<div class="settings-section">
<h4><span>ğŸ“</span> è”ç³»æˆ‘ä»¬</h4>
<div class="list-item" style="cursor:pointer" onclick="window.open('mailto:support@aihub.com')"><div class="list-item-icon">ğŸ“§</div><div class="list-item-content"><div class="list-item-title">é‚®ç®±</div><div class="list-item-desc">support@aihub.com</div></div><span style="color:var(--accent)">â†—</span></div>
<div class="list-item" style="cursor:pointer" onclick="window.open('https://github.com/aihub','_blank')"><div class="list-item-icon">ğŸ™</div><div class="list-item-content"><div class="list-item-title">GitHub</div><div class="list-item-desc">github.com/aihub</div></div><span style="color:var(--accent)">â†—</span></div>
<div class="list-item" style="cursor:pointer" onclick="window.open('https://discord.gg/aihub','_blank')"><div class="list-item-icon">ğŸ’¬</div><div class="list-item-content"><div class="list-item-title">Discord</div><div class="list-item-desc">discord.gg/aihub</div></div><span style="color:var(--accent)">â†—</span></div>
<div class="list-item" style="cursor:pointer" onclick="window.open('https://twitter.com/aihub','_blank')"><div class="list-item-icon">ğŸ¦</div><div class="list-item-content"><div class="list-item-title">Twitter</div><div class="list-item-desc">@aihub</div></div><span style="color:var(--accent)">â†—</span></div>
</div>
<div class="settings-section">
<h4><span>ğŸ“œ</span> å¼€æºè®¸å¯</h4>
<p style="color:var(--text2);font-size:13px;line-height:1.8">AI Hub åŸºäº MIT è®¸å¯è¯å¼€æºã€‚æ„Ÿè°¢æ‰€æœ‰è´¡çŒ®è€…å’Œå¼€æºç¤¾åŒºçš„æ”¯æŒã€‚</p>
<div style="margin-top:16px;display:flex;gap:8px">
<button class="btn btn-ghost btn-sm" onclick="window.open('https://github.com/aihub/LICENSE','_blank')">æŸ¥çœ‹è®¸å¯è¯</button>
<button class="btn btn-ghost btn-sm" onclick="window.open('https://github.com/aihub/CONTRIBUTORS','_blank')">è´¡çŒ®è€…åå•</button>
</div>
</div>
</div></div></div></div>
</div>
<!-- æ¨¡æ€æ¡† -->
<div class="modal" id="authModal"><div class="modal-content" style="max-width:400px"><div class="modal-header"><h3 id="authTitle">ç™»å½•</h3><button class="btn btn-icon btn-ghost" onclick="closeModal('authModal')">âœ•</button></div><div class="modal-body"><div class="form-group"><label>ç”¨æˆ·å</label><input type="text" id="authUsername" placeholder="ç”¨æˆ·å"></div><div class="form-group"><label>å¯†ç </label><input type="password" id="authPassword" placeholder="å¯†ç "></div><div class="form-group" id="authEmailGroup" style="display:none"><label>é‚®ç®±</label><input type="email" id="authEmail" placeholder="é‚®ç®±"></div><button class="btn btn-primary" style="width:100%" onclick="submitAuth()" id="authSubmit">ç™»å½•</button><p style="text-align:center;margin-top:16px;font-size:14px;color:var(--text2)" id="authSwitch">æ²¡æœ‰è´¦å·ï¼Ÿ<a href="#" onclick="toggleAuthMode()" style="color:var(--accent)">æ³¨å†Œ</a></p></div></div></div>
<div class="modal" id="pricingModal"><div class="modal-content" style="max-width:800px"><div class="modal-header"><h3>é€‰æ‹©å¥—é¤</h3><button class="btn btn-icon btn-ghost" onclick="closeModal('pricingModal')">âœ•</button></div><div class="modal-body"><div class="price-cards" id="priceCards"></div></div></div></div>
<div class="modal" id="paymentModal"><div class="modal-content" style="max-width:400px"><div class="modal-header"><h3>æ”¯ä»˜</h3><button class="btn btn-icon btn-ghost" onclick="closeModal('paymentModal')">âœ•</button></div><div class="modal-body" style="text-align:center"><div id="paymentInfo"></div><div style="margin:24px 0;padding:24px;background:var(--bg);border-radius:12px"><p style="color:var(--text2);margin-bottom:12px">æ‰«ç æ”¯ä»˜</p><div style="width:150px;height:150px;background:var(--bg3);margin:0 auto;border-radius:8px;display:flex;align-items:center;justify-content:center"><span style="font-size:48px">ğŸ“±</span></div></div><button class="btn btn-success" style="width:100%" onclick="completePayment()">å·²å®Œæˆæ”¯ä»˜</button></div></div></div>
<div class="modal" id="chatSettingsModal"><div class="modal-content" style="max-width:450px"><div class="modal-header"><h3>å¯¹è¯è®¾ç½®</h3><button class="btn btn-icon btn-ghost" onclick="closeModal('chatSettingsModal')">âœ•</button></div><div class="modal-body">
<div class="setting-row"><div class="setting-row-label">æ¨¡å‹æ¸©åº¦</div><div class="slider-container"><input type="range" id="csTemp" min="0" max="2" step="0.1" value="0.7" oninput="$('csTempVal').textContent=this.value"><span class="slider-value" id="csTempVal">0.7</span></div></div>
<div class="setting-row"><div class="setting-row-label">ä¸Šä¸‹æ–‡æ•°</div><div class="slider-container"><input type="range" id="csContext" min="1" max="50" value="10" oninput="$('csContextVal').textContent=this.value"><span class="slider-value" id="csContextVal">10</span></div></div>
<div class="setting-row"><div class="setting-row-label">æµå¼è¾“å‡º</div><label class="switch"><input type="checkbox" id="csStream" checked><span class="switch-slider"></span></label></div>
<div class="setting-row"><div class="setting-row-label">æœ€å¤§ Token</div><div class="slider-container"><input type="range" id="csMaxTokens" min="256" max="8192" step="256" value="2048" oninput="$('csMaxTokensVal').textContent=this.value"><span class="slider-value" id="csMaxTokensVal">2048</span></div></div>
<button class="btn btn-primary" style="width:100%;margin-top:16px" onclick="saveChatSettings()">ä¿å­˜è®¾ç½®</button>
</div></div></div>
<div class="modal" id="shortcutModal"><div class="modal-content" style="max-width:450px"><div class="modal-header"><h3 id="shortcutModalTitle">æ·»åŠ å¿«æ·çŸ­è¯­</h3><button class="btn btn-icon btn-ghost" onclick="closeModal('shortcutModal')">âœ•</button></div><div class="modal-body">
<div class="form-group"><label>åç§°</label><input type="text" id="shortcutName" placeholder="ä¾‹å¦‚ï¼šç¿»è¯‘"></div>
<div class="form-group"><label>è§¦å‘è¯</label><input type="text" id="shortcutTrigger" placeholder="ä¾‹å¦‚ï¼š/translate"></div>
<div class="form-group"><label>å†…å®¹</label><textarea id="shortcutContent" rows="5" placeholder="è¯·å°†ä»¥ä¸‹å†…å®¹ç¿»è¯‘æˆä¸­æ–‡ï¼š&#10;&#10;{{input}}"></textarea></div>
<button class="btn btn-primary" style="width:100%" onclick="saveShortcutFromModal()">ä¿å­˜</button>
</div></div></div>
<div class="modal" id="memoryModal"><div class="modal-content" style="max-width:500px"><div class="modal-header"><h3>æ·»åŠ è®°å¿†</h3><button class="btn btn-icon btn-ghost" onclick="closeModal('memoryModal')">âœ•</button></div><div class="modal-body">
<div class="form-group"><label>è®°å¿†å†…å®¹<br><small style="color:var(--text2)">AI ä¼šåœ¨å¯¹è¯ä¸­è®°ä½è¿™äº›ä¿¡æ¯</small></label><textarea id="memoryContent" rows="4" placeholder="ä¾‹å¦‚ï¼šæˆ‘æ˜¯ä¸€åå‰ç«¯å¼€å‘è€…ï¼Œå–œæ¬¢ä½¿ç”¨ React å’Œ TypeScript"></textarea></div>
<div class="form-group"><label>åˆ†ç±»</label><select id="memoryModalCategory" style="width:100%"><option value="ä¸ªäºº">ğŸ‘¤ ä¸ªäººä¿¡æ¯</option><option value="å·¥ä½œ">ğŸ’¼ å·¥ä½œç›¸å…³</option><option value="åå¥½">â­ åå¥½è®¾ç½®</option><option value="å…¶ä»–">ğŸ“ å…¶ä»–</option></select></div>
<button class="btn btn-primary" style="width:100%" onclick="saveMemoryFromModal()">æ·»åŠ è®°å¿†</button>
</div></div></div>
<div class="modal" id="hotkeyHelpModal"><div class="modal-content" style="max-width:500px"><div class="modal-header"><h3>âŒ¨ï¸ å¿«æ·é”®</h3><button class="btn btn-icon btn-ghost" onclick="closeModal('hotkeyHelpModal')">âœ•</button></div><div class="modal-body">
<div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
<div class="hotkey-help-item"><span class="hotkey-help-key">Ctrl + N</span><span>æ–°å»ºå¯¹è¯</span></div>
<div class="hotkey-help-item"><span class="hotkey-help-key">Ctrl + E</span><span>å¿«æ·åŠ©æ‰‹</span></div>
<div class="hotkey-help-item"><span class="hotkey-help-key">Ctrl + ,</span><span>æ‰“å¼€è®¾ç½®</span></div>
<div class="hotkey-help-item"><span class="hotkey-help-key">Ctrl + /</span><span>å¿«æ·é”®å¸®åŠ©</span></div>
<div class="hotkey-help-item"><span class="hotkey-help-key">Enter</span><span>å‘é€æ¶ˆæ¯</span></div>
<div class="hotkey-help-item"><span class="hotkey-help-key">Shift + Enter</span><span>æ¢è¡Œ</span></div>
<div class="hotkey-help-item"><span class="hotkey-help-key">Escape</span><span>å…³é—­å¼¹çª—</span></div>
<div class="hotkey-help-item"><span class="hotkey-help-key">Ctrl + [</span><span>åˆ‡æ¢åŠ©æ‰‹</span></div>
<div class="hotkey-help-item"><span class="hotkey-help-key">Ctrl + ]</span><span>åˆ‡æ¢è¯é¢˜</span></div>
<div class="hotkey-help-item"><span class="hotkey-help-key">Ctrl + +</span><span>æ”¾å¤§ç•Œé¢</span></div>
<div class="hotkey-help-item"><span class="hotkey-help-key">Ctrl + -</span><span>ç¼©å°ç•Œé¢</span></div>
<div class="hotkey-help-item"><span class="hotkey-help-key">Ctrl + 0</span><span>é‡ç½®ç¼©æ”¾</span></div>
</div>
</div></div></div>
<script>
var currentUser=null,authToken=localStorage.getItem('token'),isRegisterMode=false,currentPaymentId=null;
var providers=JSON.parse(localStorage.getItem('providers')||'null')||[
{id:'openai',name:'OpenAI',url:'https://api.openai.com/v1',key:'',type:'openai',models:[{id:'gpt-4o',name:'GPT-4o'},{id:'gpt-4o-mini',name:'GPT-4o Mini'}]},
{id:'claude',name:'Claude',url:'https://api.anthropic.com/v1',key:'',type:'claude',models:[{id:'claude-sonnet-4-20250514',name:'Claude Sonnet 4'}]},
{id:'deepseek',name:'DeepSeek',url:'https://api.deepseek.com/v1',key:'',type:'openai',models:[{id:'deepseek-chat',name:'DeepSeek Chat'},{id:'deepseek-reasoner',name:'DeepSeek R1'}]},
{id:'qwen',name:'é€šä¹‰åƒé—®',url:'https://dashscope.aliyuncs.com/compatible-mode/v1',key:'',type:'openai',models:[{id:'qwen-turbo',name:'Qwen Turbo'},{id:'qwen-plus',name:'Qwen Plus'}]},
{id:'zhipu',name:'æ™ºè°±AI',url:'https://open.bigmodel.cn/api/paas/v4',key:'',type:'openai',models:[{id:'glm-4',name:'GLM-4'}]},
{id:'moonshot',name:'Moonshot',url:'https://api.moonshot.cn/v1',key:'',type:'openai',models:[{id:'moonshot-v1-8k',name:'Moonshot V1'}]}
];
var currentProviderId=providers[0]?providers[0].id:null;
var chats=JSON.parse(localStorage.getItem('chats')||'[]'),currentChatId=null;
var notes=[],currentNoteId=null,memories=[],shortcuts=JSON.parse(localStorage.getItem('shortcuts')||'[]'),uploadedDoc=null;
var assistants=JSON.parse(localStorage.getItem('assistants')||'null')||[
{id:'default',name:'é»˜è®¤åŠ©æ‰‹',emoji:'ğŸ˜€',desc:'é€šç”¨AIåŠ©æ‰‹',prompt:'ä½ æ˜¯ä¸€ä¸ªæœ‰å¸®åŠ©çš„AIåŠ©æ‰‹ã€‚',temp:0.7,context:10,stream:true,maxTokens:2048,isSystem:true},
{id:'pm',name:'äº§å“ç»ç†',emoji:'ğŸ‘¨â€ğŸ’¼',desc:'äº§å“è§„åˆ’ä¸éœ€æ±‚åˆ†æ',prompt:'ä½ æ˜¯ä¸€ä½èµ„æ·±äº§å“ç»ç†ï¼Œæ“…é•¿äº§å“è§„åˆ’ã€éœ€æ±‚åˆ†æã€ç”¨æˆ·ç ”ç©¶å’Œé¡¹ç›®ç®¡ç†ã€‚',temp:0.7,context:10,stream:true,maxTokens:2048},
{id:'strategy',name:'ç­–ç•¥äº§å“ç»ç†',emoji:'ğŸ¯',desc:'äº§å“ç­–ç•¥ä¸å•†ä¸šåˆ†æ',prompt:'ä½ æ˜¯ä¸€ä½ç­–ç•¥äº§å“ç»ç†ï¼Œæ“…é•¿å¸‚åœºåˆ†æã€ç«å“ç ”ç©¶å’Œå•†ä¸šæ¨¡å¼è®¾è®¡ã€‚',temp:0.7,context:10,stream:true,maxTokens:2048},
{id:'community',name:'ç¤¾ç¾¤è¿è¥',emoji:'ğŸ‘¥',desc:'ç¤¾ç¾¤ç®¡ç†ä¸ç”¨æˆ·è¿è¥',prompt:'ä½ æ˜¯ä¸€ä½ç¤¾ç¾¤è¿è¥ä¸“å®¶ï¼Œæ“…é•¿ç¤¾ç¾¤ç®¡ç†ã€ç”¨æˆ·å¢é•¿å’Œæ´»åŠ¨ç­–åˆ’ã€‚',temp:0.7,context:10,stream:true,maxTokens:2048},
{id:'content',name:'å†…å®¹è¿è¥',emoji:'ğŸ°',desc:'å†…å®¹åˆ›ä½œä¸ä¼ æ’­',prompt:'ä½ æ˜¯ä¸€ä½å†…å®¹è¿è¥ä¸“å®¶ï¼Œæ“…é•¿å†…å®¹ç­–åˆ’ã€æ–‡æ¡ˆæ’°å†™å’Œå†…å®¹åˆ†å‘ã€‚',temp:0.8,context:10,stream:true,maxTokens:2048},
{id:'merchant',name:'å•†å®¶è¿è¥',emoji:'ğŸ›ï¸',desc:'å•†å®¶ç®¡ç†ä¸æœåŠ¡',prompt:'ä½ æ˜¯ä¸€ä½å•†å®¶è¿è¥ä¸“å®¶ï¼Œæ“…é•¿å•†å®¶ç®¡ç†ã€æ‹›å•†å’Œå•†å®¶æœåŠ¡ã€‚',temp:0.7,context:10,stream:true,maxTokens:2048},
{id:'product',name:'äº§å“è¿è¥',emoji:'ğŸš€',desc:'äº§å“æ¨å¹¿ä¸å¢é•¿',prompt:'ä½ æ˜¯ä¸€ä½äº§å“è¿è¥ä¸“å®¶ï¼Œæ“…é•¿äº§å“æ¨å¹¿ã€ç”¨æˆ·å¢é•¿å’Œæ•°æ®åˆ†æã€‚',temp:0.7,context:10,stream:true,maxTokens:2048},
{id:'sales',name:'é”€å”®è¿è¥',emoji:'ğŸ’¼',desc:'é”€å”®ç­–ç•¥ä¸å®¢æˆ·ç®¡ç†',prompt:'ä½ æ˜¯ä¸€ä½é”€å”®è¿è¥ä¸“å®¶ï¼Œæ“…é•¿é”€å”®ç­–ç•¥ã€å®¢æˆ·ç®¡ç†å’Œä¸šç»©åˆ†æã€‚',temp:0.7,context:10,stream:true,maxTokens:2048},
{id:'user',name:'ç”¨æˆ·è¿è¥',emoji:'ğŸ‘¤',desc:'ç”¨æˆ·ç”Ÿå‘½å‘¨æœŸç®¡ç†',prompt:'ä½ æ˜¯ä¸€ä½ç”¨æˆ·è¿è¥ä¸“å®¶ï¼Œæ“…é•¿ç”¨æˆ·åˆ†å±‚ã€ç”¨æˆ·æ¿€åŠ±å’Œç”¨æˆ·ç•™å­˜ã€‚',temp:0.7,context:10,stream:true,maxTokens:2048},
{id:'marketing',name:'å¸‚åœºè¥é”€',emoji:'ğŸ“¢',desc:'å“ç‰Œæ¨å¹¿ä¸è¥é”€ç­–åˆ’',prompt:'ä½ æ˜¯ä¸€ä½å¸‚åœºè¥é”€ä¸“å®¶ï¼Œæ“…é•¿å“ç‰Œç­–åˆ’ã€è¥é”€æ´»åŠ¨å’Œå¸‚åœºæ¨å¹¿ã€‚',temp:0.8,context:10,stream:true,maxTokens:2048},
{id:'coder',name:'ç¨‹åºå‘˜',emoji:'ğŸ’»',desc:'ä»£ç å¼€å‘ä¸æŠ€æœ¯å’¨è¯¢',prompt:'ä½ æ˜¯ä¸€ä½èµ„æ·±ç¨‹åºå‘˜ï¼Œæ“…é•¿å¤šç§ç¼–ç¨‹è¯­è¨€ï¼Œèƒ½å¤Ÿå¸®åŠ©ç”¨æˆ·è§£å†³ç¼–ç¨‹é—®é¢˜ã€ä»£ç å®¡æŸ¥å’ŒæŠ€æœ¯æ–¹æ¡ˆè®¾è®¡ã€‚',temp:0.5,context:15,stream:true,maxTokens:4096},
{id:'translator',name:'ç¿»è¯‘ä¸“å®¶',emoji:'ğŸŒ',desc:'å¤šè¯­è¨€ç¿»è¯‘',prompt:'ä½ æ˜¯ä¸€ä½ä¸“ä¸šç¿»è¯‘ï¼Œç²¾é€šä¸­è‹±æ—¥éŸ©ç­‰å¤šç§è¯­è¨€ï¼Œèƒ½å¤Ÿå‡†ç¡®ä¼ è¾¾åŸæ–‡å«ä¹‰å¹¶ä¿æŒè¯­è¨€é£æ ¼ã€‚',temp:0.3,context:5,stream:true,maxTokens:2048}
];
var currentAssistantId=assistants[0]?assistants[0].id:null;
var chatSettings={temp:0.7,context:10,stream:false,maxTokens:2048};
function $(id){return document.getElementById(id)}
function save(){localStorage.setItem('providers',JSON.stringify(providers))}
function saveChats(){localStorage.setItem('chats',JSON.stringify(chats))}
function saveShortcuts(){localStorage.setItem('shortcuts',JSON.stringify(shortcuts))}
function saveAssistants(){localStorage.setItem('assistants',JSON.stringify(assistants))}
function escapeHtml(t){return t.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/\n/g,'<br>')}
function closeModal(id){$(id).classList.remove('show')}
function showModal(id){$(id).classList.add('show')}
function setAccent(c){document.documentElement.style.setProperty('--accent',c)}
function toggleCollapse(el){var content=el.nextElementSibling;content.classList.toggle('show');el.querySelector('span:last-child').textContent=content.classList.contains('show')?'â–²':'â–¼'}
function api(path,options){options=options||{};var headers=Object.assign({'Content-Type':'application/json'},options.headers||{});if(authToken)headers['Authorization']='Bearer '+authToken;return fetch(path,Object.assign({},options,{headers:headers})).then(function(res){if(!res.ok)return res.json().then(function(e){throw new Error(e.detail||'Error')});return res.json()})}
document.querySelectorAll('.nav-item[data-page]').forEach(function(n){n.onclick=function(){document.querySelectorAll('.nav-item').forEach(function(i){i.classList.remove('active')});document.querySelectorAll('.page').forEach(function(p){p.classList.remove('active')});n.classList.add('active');var page=$('page-'+n.dataset.page);if(page)page.classList.add('active');if(n.dataset.page==='stats')loadStats();if(n.dataset.page==='tokens')loadTokens();if(n.dataset.page==='teams')loadTeams();if(n.dataset.page==='knowledge')loadKnowledgeBases();closeMobileMenus()}});
function showAuthModal(){isRegisterMode=false;updateAuthUI();showModal('authModal')}
function toggleAuthMode(){isRegisterMode=!isRegisterMode;updateAuthUI()}
function updateAuthUI(){$('authTitle').textContent=isRegisterMode?'æ³¨å†Œ':'ç™»å½•';$('authSubmit').textContent=isRegisterMode?'æ³¨å†Œ':'ç™»å½•';$('authEmailGroup').style.display=isRegisterMode?'block':'none';$('authSwitch').innerHTML=isRegisterMode?'å·²æœ‰è´¦å·ï¼Ÿ<a href="#" onclick="toggleAuthMode()" style="color:var(--accent)">ç™»å½•</a>':'æ²¡æœ‰è´¦å·ï¼Ÿ<a href="#" onclick="toggleAuthMode()" style="color:var(--accent)">æ³¨å†Œ</a>'}
function submitAuth(){var username=$('authUsername').value.trim(),password=$('authPassword').value;if(!username||!password)return alert('è¯·å¡«å†™');if(isRegisterMode){api('/api/auth/register',{method:'POST',body:JSON.stringify({username:username,password:password,email:$('authEmail').value})}).then(function(){alert('æ³¨å†ŒæˆåŠŸ');toggleAuthMode()}).catch(function(e){alert(e.message)})}else{api('/api/auth/login',{method:'POST',body:JSON.stringify({username:username,password:password})}).then(function(res){authToken=res.token;localStorage.setItem('token',authToken);currentUser=res.user;closeModal('authModal');updateUserUI();loadUserData()}).catch(function(e){alert(e.message)})}}
function checkAuth(){if(!authToken)return;api('/api/auth/me').then(function(u){currentUser=u;updateUserUI();loadUserData()}).catch(function(){authToken=null;localStorage.removeItem('token')})}
function updateUserUI(){$('navUserName').textContent=currentUser?currentUser.username:'ç™»å½•'}
function loadUserData(){if(!currentUser)return;api('/api/notes').then(function(n){notes=n;renderNotes()}).catch(function(){});api('/api/memories').then(function(m){memories=m;renderMemories()}).catch(function(){})}
function showPricing(){api('/api/plans').then(function(plans){var html='';for(var key in plans){var p=plans[key];html+='<div class="price-card" onclick="selectPlan(\''+key+'\')"><h4>'+p.name+'</h4><div class="price">'+(p.price>0?'Â¥'+p.price:'å…è´¹')+'<span>/æœˆ</span></div><ul>'+p.features.map(function(f){return'<li>'+f+'</li>'}).join('')+'</ul><button class="btn '+(key==='free'?'btn-ghost':'btn-primary')+'" style="width:100%">'+(key==='free'?'å½“å‰':'è®¢é˜…')+'</button></div>'}$('priceCards').innerHTML=html;showModal('pricingModal')}).catch(function(e){alert(e.message)})}
function selectPlan(plan){if(plan==='free')return;if(!currentUser){closeModal('pricingModal');showAuthModal();return}api('/api/payments/create',{method:'POST',body:JSON.stringify({plan:plan})}).then(function(res){currentPaymentId=res.payment_id;$('paymentInfo').innerHTML='<h4>'+plan+'</h4><div style="font-size:32px;font-weight:700;color:var(--accent)">Â¥'+res.amount+'</div>';closeModal('pricingModal');showModal('paymentModal')}).catch(function(e){alert(e.message)})}
function completePayment(){if(!currentPaymentId)return;api('/api/payments/'+currentPaymentId+'/complete',{method:'POST'}).then(function(){alert('æ”¯ä»˜æˆåŠŸï¼');closeModal('paymentModal');checkAuth()}).catch(function(e){alert(e.message)})}
function checkUpdate(){alert('å½“å‰å·²æ˜¯æœ€æ–°ç‰ˆæœ¬')}
function showChatSettings(){$('csTemp').value=chatSettings.temp;$('csTempVal').textContent=chatSettings.temp;$('csContext').value=chatSettings.context;$('csContextVal').textContent=chatSettings.context;$('csStream').checked=chatSettings.stream;$('csMaxTokens').value=chatSettings.maxTokens;$('csMaxTokensVal').textContent=chatSettings.maxTokens;showModal('chatSettingsModal')}
function saveChatSettings(){chatSettings.temp=parseFloat($('csTemp').value);chatSettings.context=parseInt($('csContext').value);chatSettings.stream=$('csStream').checked;chatSettings.maxTokens=parseInt($('csMaxTokens').value);closeModal('chatSettingsModal');alert('è®¾ç½®å·²ä¿å­˜')}
</script>
<script>
// åŠ©æ‰‹ç®¡ç†
function renderAssistants(){var html=assistants.map(function(a){return'<div class="assistant-card'+(a.id===currentAssistantId?' active':'')+'" onclick="selectAssistant(\''+a.id+'\')"><div class="assistant-avatar" style="background:'+(a.isSystem?'linear-gradient(135deg,#fef3c7,#fde68a)':'linear-gradient(135deg,#e0e7ff,#c7d2fe)')+'">'+a.emoji+'</div><div class="assistant-info"><div class="assistant-name">'+a.name+'</div><div class="assistant-desc">'+a.desc+'</div></div>'+(a.isSystem?'<span class="assistant-tag">ç³»ç»Ÿ</span>':'')+'</div>'}).join('');$('assistantList').innerHTML=html;updateAssistantSelect()}
function selectAssistant(id){currentAssistantId=id;var a=assistants.find(function(x){return x.id===id});if(a){$('aName').value=a.name;$('aEmoji').value=a.emoji;$('aDesc').value=a.desc;$('aPrompt').value=a.prompt;$('aTemp').value=a.temp;$('aTempVal').textContent=a.temp;$('aContext').value=a.context;$('aContextVal').textContent=a.context;$('aStream').checked=a.stream;$('aMaxTokens').value=a.maxTokens;$('aMaxTokensVal').textContent=a.maxTokens}renderAssistants()}
function addAssistant(){var id='a_'+Date.now();assistants.push({id:id,name:'æ–°åŠ©æ‰‹',emoji:'ğŸ¤–',desc:'è‡ªå®šä¹‰åŠ©æ‰‹',prompt:'ä½ æ˜¯ä¸€ä¸ªæœ‰å¸®åŠ©çš„AIåŠ©æ‰‹ã€‚',temp:0.7,context:10,stream:true,maxTokens:2048});saveAssistants();renderAssistants();selectAssistant(id)}
function saveAssistant(){var a=assistants.find(function(x){return x.id===currentAssistantId});if(a){a.name=$('aName').value;a.emoji=$('aEmoji').value;a.desc=$('aDesc').value;a.prompt=$('aPrompt').value;a.temp=parseFloat($('aTemp').value);a.context=parseInt($('aContext').value);a.stream=$('aStream').checked;a.maxTokens=parseInt($('aMaxTokens').value);saveAssistants();renderAssistants();alert('ä¿å­˜æˆåŠŸ')}}
function deleteAssistant(){var a=assistants.find(function(x){return x.id===currentAssistantId});if(a&&a.isSystem)return alert('ç³»ç»ŸåŠ©æ‰‹ä¸èƒ½åˆ é™¤');if(!confirm('ç¡®å®šåˆ é™¤ï¼Ÿ'))return;assistants=assistants.filter(function(x){return x.id!==currentAssistantId});saveAssistants();currentAssistantId=assistants[0]?assistants[0].id:null;renderAssistants();if(currentAssistantId)selectAssistant(currentAssistantId)}
function switchAssistantTab(tab){document.querySelectorAll('#page-assistants .tab').forEach(function(t){t.classList.remove('active')});event.target.classList.add('active');$('assistantTabInfo').style.display=tab==='info'?'block':'none';$('assistantTabSettings').style.display=tab==='settings'?'block':'none'}
function updateAssistantSelect(){$('chatAssistant').innerHTML=assistants.map(function(a){return'<option value="'+a.id+'">'+a.emoji+' '+a.name+'</option>'}).join('')}
function onAssistantChange(){var a=assistants.find(function(x){return x.id===$('chatAssistant').value});if(a){chatSettings.temp=a.temp;chatSettings.context=a.context;chatSettings.stream=a.stream;chatSettings.maxTokens=a.maxTokens}}
// èŠå¤©
function renderChats(){var html='';if(chats.length===0){html='<div class="empty-state"><span>ğŸ“­</span><p>æš‚æ— å¯¹è¯</p></div>'}else{chats.forEach(function(c){html+='<div class="sidebar-item'+(c.id===currentChatId?' active':'')+'" onclick="selectChat(\''+c.id+'\')" oncontextmenu="showChatMenu(event,\''+c.id+'\')"><div class="sidebar-item-icon">ğŸ’¬</div><div class="sidebar-item-info"><div class="sidebar-item-title">'+(c.title||'æ–°å¯¹è¯')+'</div><div class="sidebar-item-desc">'+(c.messages?c.messages.length:0)+' æ¡æ¶ˆæ¯</div></div><button class="btn btn-ghost btn-sm chat-delete-btn" onclick="event.stopPropagation();deleteChat(\''+c.id+'\')" style="opacity:0;padding:4px 8px">ğŸ—‘ï¸</button></div>'})}$('chatList').innerHTML=html}
function selectChat(id){currentChatId=id;renderChats();renderMessages()}
function newChat(){var id='chat_'+Date.now();chats.unshift({id:id,title:'æ–°å¯¹è¯',messages:[],provider:providers[0]?providers[0].id:'',model:providers[0]&&providers[0].models[0]?providers[0].models[0].id:'',assistant:currentAssistantId});saveChats();renderChats();selectChat(id)}
function renderMessages(){var chat=chats.find(function(c){return c.id===currentChatId});if(!chat||!chat.messages||chat.messages.length===0){$('chatMessages').innerHTML='<div class="empty-state"><span>ğŸ’¬</span><p>å¼€å§‹æ–°çš„å¯¹è¯</p><p style="font-size:12px;margin-top:8px;color:var(--text2)">Ctrl+N æ–°å»ºå¯¹è¯ Â· Enter å‘é€æ¶ˆæ¯</p></div>';return}var html='';chat.messages.forEach(function(m,i){var timeInfo=m.time?'<div class="message-time">â±ï¸ '+m.time+'</div>':'';var imagesHtml='';if(m.images&&m.images.length>0){m.images.forEach(function(img){imagesHtml+='<img src="'+img.data+'" class="message-image" onclick="showImageModal(this.src)" alt="ä¸Šä¼ çš„å›¾ç‰‡">'});}var contentText=typeof m.content==='string'?m.content:(m.content||'');var actions=m.role==='assistant'?'<div class="message-actions"><button class="message-action-btn" onclick="copyMessage('+i+')" title="å¤åˆ¶">ğŸ“‹</button><button class="message-action-btn" onclick="regenerateMessage('+i+')" title="é‡æ–°ç”Ÿæˆ">ğŸ”„</button><button class="message-action-btn" onclick="branchFromMessage('+i+')" title="ä»æ­¤åˆ†æ”¯">ğŸŒ¿</button><button class="message-action-btn" onclick="rateMessage('+i+')" title="è¯„åˆ†">â­</button><button class="message-action-btn" onclick="readAloud('+i+')" title="æœ—è¯»">ğŸ”Š</button><button class="message-action-btn" onclick="pushMessageToGithub('+i+')" title="æ¨é€åˆ°GitHub">ğŸ™</button></div>':'<div class="message-actions"><button class="message-action-btn" onclick="copyMessage('+i+')" title="å¤åˆ¶">ğŸ“‹</button><button class="message-action-btn" onclick="editMessage('+i+')" title="ç¼–è¾‘">âœï¸</button><button class="message-action-btn" onclick="branchFromMessage('+i+')" title="ä»æ­¤åˆ†æ”¯">ğŸŒ¿</button></div>';html+='<div class="message '+m.role+(m.error?' error':'')+'"><div class="message-content">'+imagesHtml+(m.role==='assistant'?marked.parse(contentText):escapeHtml(contentText))+'</div>'+timeInfo+actions+'</div>'});$('chatMessages').innerHTML=html;$('chatMessages').scrollTop=$('chatMessages').scrollHeight;hljs.highlightAll()}
function showImageModal(src){var modal=document.createElement('div');modal.style.cssText='position:fixed;inset:0;background:rgba(0,0,0,0.9);display:flex;align-items:center;justify-content:center;z-index:2000;cursor:pointer';modal.innerHTML='<img src="'+src+'" style="max-width:90%;max-height:90%;border-radius:8px">';modal.onclick=function(){modal.remove()};document.body.appendChild(modal)}
function handleChatKey(e){if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();sendMessage()}e.target.style.height='auto';e.target.style.height=Math.min(e.target.scrollHeight,150)+'px'}
var chatTimer=null,chatStartTime=0;
function updateTimer(){var elapsed=((Date.now()-chatStartTime)/1000).toFixed(1);var timerEl=document.querySelector('.message-timer');if(timerEl)timerEl.textContent=elapsed+'s'}
function showLoading(){var model=$('chatModel').value||'æ¨¡å‹';$('chatMessages').innerHTML+='<div class="message assistant" id="loadingMsg"><div class="message-content"><div class="message-loading"><span>ğŸ¤– '+model+' æ­£åœ¨æ€è€ƒ</span><div class="dots"><span></span><span></span><span></span></div><span class="message-timer">0.0s</span></div></div></div>';$('chatMessages').scrollTop=$('chatMessages').scrollHeight;chatStartTime=Date.now();chatTimer=setInterval(updateTimer,100)}
function hideLoading(){if(chatTimer){clearInterval(chatTimer);chatTimer=null}var el=$('loadingMsg');if(el)el.remove()}
function sendMessage(){var input=$('chatInput'),text=input.value.trim();if(!text&&pendingImages.length===0)return;input.value='';input.style.height='auto';var chat=chats.find(function(c){return c.id===currentChatId});if(!chat){newChat();chat=chats[0]}var userMsg={role:'user',content:text};if(pendingImages.length>0){userMsg.images=pendingImages.slice();pendingImages=[];renderImagePreview()}chat.messages.push(userMsg);if(chat.messages.length===1)chat.title=text.slice(0,25);saveChats();renderChats();renderMessages();showLoading();var p=providers.find(function(x){return x.id===$('chatProvider').value}),key=p?cleanApiKey(p.key):'',stream=chatSettings.stream;var assistant=assistants.find(function(x){return x.id===$('chatAssistant').value});var messages=chat.messages.filter(function(m){return!m.error}).slice(-chatSettings.context).map(function(m){if(m.images&&m.images.length>0){var contentArr=[{type:'text',text:m.content||'è¯·æè¿°è¿™å¼ å›¾ç‰‡'}];m.images.forEach(function(img){contentArr.push({type:'image_url',image_url:{url:img.data}})});return{role:m.role,content:contentArr}}return{role:m.role,content:m.content}});if(assistant&&assistant.prompt){messages.unshift({role:'system',content:assistant.prompt})}$('sendBtn').disabled=true;var providerType=p?p.type:'openai';var payload={provider:providerType==='claude'?'claude':'custom',model:$('chatModel').value,messages:messages,custom_url:p?p.url:'',api_key:key,stream:stream,temperature:chatSettings.temp,max_tokens:chatSettings.maxTokens};if(stream){var headers={'Content-Type':'application/json'};if(authToken)headers['Authorization']='Bearer '+authToken;fetch('/v1/chat/completions',{method:'POST',headers:headers,body:JSON.stringify(payload)}).then(function(response){hideLoading();chat.messages.push({role:'assistant',content:''});renderMessages();var reader=response.body.getReader(),decoder=new TextDecoder(),content='';function read(){reader.read().then(function(result){if(result.done){saveChats();$('sendBtn').disabled=false;return}var chunk=decoder.decode(result.value),lines=chunk.split('\n');lines.forEach(function(line){if(line.indexOf('data: ')===0){var data=line.slice(6);if(data==='[DONE]')return;try{var parsed=JSON.parse(data);var delta=parsed.choices&&parsed.choices[0]&&parsed.choices[0].delta&&parsed.choices[0].delta.content;if(delta){content+=delta;chat.messages[chat.messages.length-1].content=content;renderMessages()}}catch(e){}}});read()})}read()}).catch(function(e){hideLoading();chat.messages.push({role:'assistant',content:'é”™è¯¯: '+e.message,error:true});saveChats();renderMessages();$('sendBtn').disabled=false})}else{var headers={'Content-Type':'application/json'};if(authToken)headers['Authorization']='Bearer '+authToken;fetch('/v1/chat/completions',{method:'POST',headers:headers,body:JSON.stringify(payload)}).then(function(r){return r.json()}).then(function(data){hideLoading();var elapsed=((Date.now()-chatStartTime)/1000).toFixed(1);var content='';if(data.error||data.detail){content=data.detail||JSON.stringify(data);chat.messages.push({role:'assistant',content:content,error:true})}else if(p&&p.type==='claude'){content=data.content&&data.content[0]?data.content[0].text:JSON.stringify(data);chat.messages.push({role:'assistant',content:content,time:elapsed+'s'})}else{content=data.choices&&data.choices[0]&&data.choices[0].message?data.choices[0].message.content:JSON.stringify(data);chat.messages.push({role:'assistant',content:content,time:elapsed+'s'})}saveChats();renderMessages();$('sendBtn').disabled=false}).catch(function(e){hideLoading();chat.messages.push({role:'assistant',content:'é”™è¯¯: '+e.message,error:true});saveChats();renderMessages();$('sendBtn').disabled=false})}}
function clearChat(){var chat=chats.find(function(c){return c.id===currentChatId});if(chat&&confirm('ç¡®å®šæ¸…ç©ºï¼Ÿ')){chat.messages=[];saveChats();renderMessages()}}
function exportChat(format){var chat=chats.find(function(c){return c.id===currentChatId});if(!chat)return;format=format||'txt';if(format==='json'){var data={id:chat.id,title:chat.title,messages:chat.messages,created:chat.created};var blob=new Blob([JSON.stringify(data,null,2)],{type:'application/json'});var a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download=(chat.title||'chat')+'.json';a.click()}else if(format==='md'){var lines=['# '+(chat.title||'å¯¹è¯è®°å½•'),'','---',''];chat.messages.forEach(function(m){lines.push('### '+(m.role==='user'?'ğŸ‘¤ ç”¨æˆ·':'ğŸ¤– åŠ©æ‰‹'));lines.push('');lines.push(m.content);lines.push('')});var blob=new Blob([lines.join('\n')],{type:'text/markdown'});var a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download=(chat.title||'chat')+'.md';a.click()}else{var text=chat.messages.map(function(m){return'['+m.role+']\n'+m.content}).join('\n\n---\n\n');var blob=new Blob([text],{type:'text/plain'});var a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download=(chat.title||'chat')+'.txt';a.click()}}
// ä½¿ç”¨ç»Ÿè®¡
function loadStats(){if(!authToken){$('statTodayCalls').textContent='è¯·ç™»å½•';return}api('/api/stats').then(function(data){$('statTodayCalls').textContent=data.today_calls||0;$('statTotalCalls').textContent=data.total_calls||0;$('statTokensInput').textContent=formatNumber(data.tokens_input||0);$('statTokensOutput').textContent=formatNumber(data.tokens_output||0);var inputCost=(data.tokens_input||0)/1000*0.03;var outputCost=(data.tokens_output||0)/1000*0.06;var totalCost=inputCost+outputCost;$('costTotal').textContent='$'+totalCost.toFixed(2);$('costToday').textContent='$'+(totalCost*0.1).toFixed(2);$('costMonth').textContent='$'+(totalCost*0.7).toFixed(2);if(data.daily_stats&&data.daily_stats.length>0){var maxCalls=Math.max.apply(null,data.daily_stats.map(function(d){return d.calls}));var chartHtml=data.daily_stats.map(function(d){var height=maxCalls>0?(d.calls/maxCalls*150):0;return'<div style="flex:1;display:flex;flex-direction:column;align-items:center"><div style="width:100%;background:var(--accent);border-radius:4px 4px 0 0;height:'+height+'px;min-height:4px"></div><div style="font-size:10px;color:var(--text2);margin-top:8px">'+d.day.slice(5)+'</div><div style="font-size:11px;color:var(--text)">'+d.calls+'</div></div>'}).join('');$('usageChart').innerHTML=chartHtml}if(data.model_stats&&data.model_stats.length>0){var html='<table style="width:100%;border-collapse:collapse"><tr style="background:var(--bg2)"><th style="padding:12px;text-align:left">æ¨¡å‹</th><th style="padding:12px;text-align:right">è°ƒç”¨æ¬¡æ•°</th><th style="padding:12px;text-align:right">Tokens</th></tr>';data.model_stats.forEach(function(s){html+='<tr style="border-top:1px solid var(--border)"><td style="padding:12px">'+s.provider+'/'+s.model+'</td><td style="padding:12px;text-align:right">'+s.calls+'</td><td style="padding:12px;text-align:right">'+formatNumber(s.tokens||0)+'</td></tr>'});html+='</table>';$('modelStatsTable').innerHTML=html}loadLogs();loadRatingStats()}).catch(function(e){console.error('åŠ è½½ç»Ÿè®¡å¤±è´¥:',e)})}
function loadRatingStats(){api('/api/ratings/stats').then(function(data){if(data.length===0){$('ratingStats').innerHTML='<div style="text-align:center;color:var(--text2)">æš‚æ— è¯„åˆ†æ•°æ®</div>';return}var html=data.map(function(r){var stars='â­'.repeat(Math.round(r.avg_rating));return'<div style="display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid var(--border)"><span>'+r.model+'</span><span>'+stars+' ('+r.avg_rating.toFixed(1)+') Â· '+r.count+'æ¬¡è¯„åˆ†</span></div>'}).join('');$('ratingStats').innerHTML=html}).catch(function(e){console.error(e)})}
function loadLogs(){api('/api/logs?limit=30').then(function(logs){if(logs&&logs.length>0){var html='<table style="width:100%;border-collapse:collapse;font-size:12px"><tr style="background:var(--bg2)"><th style="padding:10px;text-align:left">æ—¶é—´</th><th style="padding:10px">æ¨¡å‹</th><th style="padding:10px;text-align:right">Tokens</th><th style="padding:10px;text-align:right">è€—æ—¶</th><th style="padding:10px">çŠ¶æ€</th></tr>';logs.forEach(function(l){var statusColor=l.status==='success'?'var(--success)':'var(--error)';html+='<tr style="border-top:1px solid var(--border)"><td style="padding:10px">'+(l.created_at||'').slice(5,16)+'</td><td style="padding:10px;text-align:center">'+l.model+'</td><td style="padding:10px;text-align:right">'+(l.tokens_input+l.tokens_output)+'</td><td style="padding:10px;text-align:right">'+(l.latency_ms/1000).toFixed(1)+'s</td><td style="padding:10px;text-align:center;color:'+statusColor+'">'+(l.status==='success'?'âœ“':'âœ—')+'</td></tr>'});html+='</table>';$('apiLogsTable').innerHTML=html}}).catch(function(e){console.error('åŠ è½½æ—¥å¿—å¤±è´¥:',e)})}
function formatNumber(n){if(n>=1000000)return(n/1000000).toFixed(1)+'M';if(n>=1000)return(n/1000).toFixed(1)+'K';return n}
function updateChatProviders(){var html=providers.map(function(p){return'<option value="'+p.id+'">'+p.name+'</option>'}).join('');$('chatProvider').innerHTML=html;if($('defaultChatProvider'))$('defaultChatProvider').innerHTML=html;onProviderChange()}
function onProviderChange(){var p=providers.find(function(x){return x.id===$('chatProvider').value});$('chatModel').innerHTML=(p&&p.models?p.models:[]).map(function(m){return'<option value="'+m.id+'">'+m.name+'</option>'}).join('')}
</script>
<script>
// æ¨¡å‹æœåŠ¡
function renderProviders(){var html=providers.map(function(p){return'<div class="sidebar-item'+(p.id===currentProviderId?' active':'')+'" onclick="selectProvider(\''+p.id+'\')"><div class="sidebar-item-icon">'+p.name[0]+'</div><div class="sidebar-item-info"><div class="sidebar-item-title">'+p.name+'</div><div class="sidebar-item-desc">'+(p.models?p.models.length:0)+' ä¸ªæ¨¡å‹</div></div><div style="width:8px;height:8px;border-radius:50%;background:'+(p.key?'var(--success)':'var(--text2)')+'"></div></div>'}).join('');$('providerList').innerHTML=html}
function selectProvider(id){currentProviderId=id;var p=providers.find(function(x){return x.id===id});if(p){$('pName').value=p.name;$('pUrl').value=p.url;$('pKey').value=p.key;$('pType').value=p.type||'openai';renderModels(p.models||[])}renderProviders()}
function renderModels(models){if(models.length===0){$('modelList').innerHTML='<div class="empty-state"><span>ğŸ“­</span><p>æš‚æ— æ¨¡å‹</p></div>';return}var html=models.map(function(m){return'<div class="list-item"><div class="list-item-icon">ğŸ¤–</div><div class="list-item-content"><div class="list-item-title">'+m.name+'</div><div class="list-item-desc">'+m.id+'</div></div><button class="btn btn-ghost btn-sm" onclick="deleteModel(\''+m.id+'\')">ğŸ—‘ï¸</button></div>'}).join('');$('modelList').innerHTML=html}
function addProvider(){var id='p_'+Date.now();providers.push({id:id,name:'æ–°æœåŠ¡',url:'',key:'',type:'openai',models:[]});save();renderProviders();selectProvider(id);updateChatProviders()}
function saveProvider(){var p=providers.find(function(x){return x.id===currentProviderId});if(p){p.name=$('pName').value;p.url=$('pUrl').value;p.key=cleanApiKey($('pKey').value);p.type=$('pType').value;save();renderProviders();updateChatProviders();alert('ä¿å­˜æˆåŠŸ')}}
function deleteProvider(){if(!confirm('ç¡®å®šåˆ é™¤ï¼Ÿ'))return;providers=providers.filter(function(p){return p.id!==currentProviderId});save();currentProviderId=providers[0]?providers[0].id:null;renderProviders();if(currentProviderId)selectProvider(currentProviderId);updateChatProviders()}
function cleanApiKey(key){if(!key)return'';var result='';for(var i=0;i<key.length;i++){var c=key.charCodeAt(i);if(c>=32&&c<127)result+=key[i]}return result.trim()}
function toggleProviderKey(){var input=$('pKey'),btn=$('togglePKeyBtn');if(input.type==='password'){input.type='text';btn.textContent='ğŸ™ˆ'}else{input.type='password';btn.textContent='ğŸ‘ï¸'}}
function testProvider(){var url=$('pUrl').value,key=cleanApiKey($('pKey').value);if(!url||!key){alert('è¯·å¡«å†™ API åœ°å€å’Œ API Key');return}fetch('/api/proxy/test',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({url:url,key:key})}).then(function(r){return r.json()}).then(function(data){if(data.success){alert('âœ“ è¿æ¥æˆåŠŸ')}else{alert('âœ— å¤±è´¥: '+(data.error||'æœªçŸ¥é”™è¯¯'))}}).catch(function(e){alert('âœ— å¤±è´¥: '+e.message)})}
function fetchModels(){var url=$('pUrl').value,key=cleanApiKey($('pKey').value);if(!url||!key){alert('è¯·å¡«å†™ API åœ°å€å’Œ API Key');return}fetch('/api/proxy/models',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({url:url,key:key})}).then(function(r){return r.json()}).then(function(data){var p=providers.find(function(x){return x.id===currentProviderId});if(data.error){alert('è·å–å¤±è´¥: '+data.error);return}if(p&&data.data){p.models=data.data.slice(0,50).map(function(m){return{id:m.id,name:m.id}});save();renderModels(p.models);updateChatProviders();alert('è·å–æˆåŠŸ: '+p.models.length+' ä¸ªæ¨¡å‹')}else if(p&&data.models){p.models=data.models.slice(0,50).map(function(m){return{id:m.id||m,name:m.id||m}});save();renderModels(p.models);updateChatProviders();alert('è·å–æˆåŠŸ: '+p.models.length+' ä¸ªæ¨¡å‹')}else{alert('æœªæ‰¾åˆ°æ¨¡å‹åˆ—è¡¨')}}).catch(function(e){alert('å¤±è´¥: '+e.message)})}
function addModel(){var name=prompt('æ¨¡å‹åç§°:');if(!name)return;var id=prompt('æ¨¡å‹ID:',name);if(!id)return;var p=providers.find(function(x){return x.id===currentProviderId});if(p){p.models=p.models||[];p.models.push({id:id,name:name});save();renderModels(p.models);updateChatProviders()}}
function deleteModel(mid){var p=providers.find(function(x){return x.id===currentProviderId});if(p){p.models=p.models.filter(function(m){return m.id!==mid});save();renderModels(p.models);updateChatProviders()}}
// ç¬”è®°
function renderNotes(){if(notes.length===0){$('noteList').innerHTML='<div class="empty-state"><span>ğŸ“­</span><p>æš‚æ— ç¬”è®°</p></div>';return}var html=notes.map(function(n){return'<div class="sidebar-item'+(n.id===currentNoteId?' active':'')+'" onclick="selectNote(\''+n.id+'\')"><div class="sidebar-item-icon">ğŸ“</div><div class="sidebar-item-info"><div class="sidebar-item-title">'+(n.title||'æ— æ ‡é¢˜')+'</div></div></div>'}).join('');$('noteList').innerHTML=html}
function selectNote(id){currentNoteId=id;var n=notes.find(function(x){return x.id===id});if(n){$('noteTitle').value=n.title;$('noteContent').value=n.content}renderNotes()}
function newNote(){if(!currentUser)return alert('è¯·å…ˆç™»å½•');api('/api/notes',{method:'POST',body:JSON.stringify({title:'æ–°ç¬”è®°',content:'',tags:''})}).then(function(res){notes.unshift({id:res.id,title:'æ–°ç¬”è®°',content:''});renderNotes();selectNote(res.id)}).catch(function(e){alert(e.message)})}
function saveNote(){if(!currentNoteId)return;api('/api/notes/'+currentNoteId,{method:'PUT',body:JSON.stringify({title:$('noteTitle').value,content:$('noteContent').value,tags:''})}).then(function(){var n=notes.find(function(x){return x.id===currentNoteId});if(n){n.title=$('noteTitle').value;n.content=$('noteContent').value}renderNotes();alert('ä¿å­˜æˆåŠŸ')}).catch(function(e){alert(e.message)})}
function deleteNote(){if(!currentNoteId||!confirm('ç¡®å®šåˆ é™¤ï¼Ÿ'))return;api('/api/notes/'+currentNoteId,{method:'DELETE'}).then(function(){notes=notes.filter(function(n){return n.id!==currentNoteId});currentNoteId=notes[0]?notes[0].id:null;renderNotes();if(currentNoteId)selectNote(currentNoteId);else{$('noteTitle').value='';$('noteContent').value=''}}).catch(function(e){alert(e.message)})}
// è®°å¿†
function renderMemories(){if(memories.length===0){$('memoryList').innerHTML='<div class="empty-state" style="padding:60px"><span style="font-size:64px;display:block;margin-bottom:16px;opacity:0.5">ğŸ§ </span><p style="font-size:16px;margin-bottom:8px">æš‚æ— è®°å¿†</p><p style="font-size:13px">å¼€å§‹æ·»åŠ æ‚¨çš„ç¬¬ä¸€æ¡è®°å¿†å§</p><button class="btn btn-primary" style="margin-top:20px" onclick="showAddMemoryModal()">+ æ·»åŠ æ‚¨çš„ç¬¬ä¸€æ¡è®°å¿†</button></div>';return}var html=memories.map(function(m){return'<div class="memory-item"><div class="memory-item-content">'+escapeHtml(m.content)+'<div class="memory-item-meta">'+m.category+' Â· '+(m.created_at||'åˆšåˆš')+'</div></div><div class="memory-item-actions"><button class="btn btn-ghost btn-sm" onclick="editMemory('+m.id+')">âœï¸</button><button class="btn btn-ghost btn-sm" onclick="deleteMemory('+m.id+')">ğŸ—‘ï¸</button></div></div>'}).join('');$('memoryList').innerHTML=html}
function showAddMemoryModal(){$('memoryContent').value='';$('memoryModalCategory').value='ä¸ªäºº';showModal('memoryModal')}
function saveMemoryFromModal(){var content=$('memoryContent').value.trim();if(!content)return alert('è¯·è¾“å…¥è®°å¿†å†…å®¹');if(!currentUser){closeModal('memoryModal');return alert('è¯·å…ˆç™»å½•')}api('/api/memories',{method:'POST',body:JSON.stringify({content:content,category:$('memoryModalCategory').value})}).then(function(){return api('/api/memories')}).then(function(m){memories=m;renderMemories();closeModal('memoryModal');alert('è®°å¿†æ·»åŠ æˆåŠŸ')}).catch(function(e){alert(e.message)})}
function addMemoryContent(content){if(!currentUser)return alert('è¯·å…ˆç™»å½•');api('/api/memories',{method:'POST',body:JSON.stringify({content:content,category:$('memoryCategory')?$('memoryCategory').value:'ä¸ªäºº'})}).then(function(){return api('/api/memories')}).then(function(m){memories=m;renderMemories();alert('æ·»åŠ æˆåŠŸ')}).catch(function(e){alert(e.message)})}
function editMemory(id){var m=memories.find(function(x){return x.id===id});if(!m)return;var content=prompt('ç¼–è¾‘è®°å¿†ï¼š',m.content);if(content&&content.trim()){api('/api/memories/'+id,{method:'PUT',body:JSON.stringify({content:content.trim(),category:m.category})}).then(function(){m.content=content.trim();renderMemories()}).catch(function(e){alert(e.message)})}}
function addMemory(){if(!currentUser)return alert('è¯·å…ˆç™»å½•');var content=$('newMemory').value.trim();if(!content)return alert('è¯·è¾“å…¥å†…å®¹');api('/api/memories',{method:'POST',body:JSON.stringify({content:content,category:$('memoryCategory').value})}).then(function(){return api('/api/memories')}).then(function(m){memories=m;renderMemories();$('newMemory').value='';alert('æ·»åŠ æˆåŠŸ')}).catch(function(e){alert(e.message)})}
function deleteMemory(id){if(!confirm('ç¡®å®šåˆ é™¤ï¼Ÿ'))return;api('/api/memories/'+id,{method:'DELETE'}).then(function(){memories=memories.filter(function(m){return m.id!==id});renderMemories()}).catch(function(e){alert(e.message)})}
// æœç´¢è®¾ç½®
function onSearchProviderChange(){var provider=$('searchProvider').value;$('searchZhipuSection').style.display=provider==='zhipu'?'block':'none';$('searchSearxngSection').style.display=provider==='searxng'?'block':'none'}
function togglePassword(id){var input=$(id);input.type=input.type==='password'?'text':'password'}
function testSearchKey(){var key=$('zhipuSearchKey').value;if(!key)return alert('è¯·è¾“å…¥ API å¯†é’¥');alert('API å¯†é’¥æ ¼å¼æ­£ç¡®')}
function saveSearchSettings(){var settings={provider:$('searchProvider').value,enabled:$('searchEnabled').checked,resultCount:$('searchResultCount').value,blacklist:$('searchBlacklist').value};localStorage.setItem('searchSettings',JSON.stringify(settings));alert('æœç´¢è®¾ç½®å·²ä¿å­˜')}
function copyText(text){navigator.clipboard.writeText(text).then(function(){alert('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿')}).catch(function(){prompt('è¯·æ‰‹åŠ¨å¤åˆ¶ï¼š',text)})}
// å¯¹è¯åŠŸèƒ½å¢å¼º
function searchChats(){var input=$('chatSearchInput');input.style.display=input.style.display==='none'?'block':'none';if(input.style.display==='block')input.focus()}
function filterChats(keyword){var items=document.querySelectorAll('#chatList .sidebar-item');items.forEach(function(item){var title=item.querySelector('.sidebar-item-title').textContent.toLowerCase();item.style.display=title.includes(keyword.toLowerCase())?'flex':'none'})}
function toggleWebSearch(){var btn=$('webSearchBtn');btn.classList.toggle('btn-primary');btn.classList.toggle('btn-ghost');alert(btn.classList.contains('btn-primary')?'ç½‘ç»œæœç´¢å·²å¯ç”¨':'ç½‘ç»œæœç´¢å·²å…³é—­')}
var pendingImages=[];
function uploadImage(){$('imageInput').click()}
function handleImageSelect(e){var file=e.target.files[0];if(!file)return;if(!file.type.startsWith('image/')){alert('è¯·é€‰æ‹©å›¾ç‰‡æ–‡ä»¶');return}if(file.size>10*1024*1024){alert('å›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡10MB');return}var reader=new FileReader();reader.onload=function(ev){var base64=ev.target.result;pendingImages.push({name:file.name,data:base64,type:file.type});renderImagePreview()};reader.readAsDataURL(file);e.target.value=''}
function renderImagePreview(){var container=$('imagePreview');if(pendingImages.length===0){container.style.display='none';container.innerHTML='';return}container.style.display='block';var html=pendingImages.map(function(img,i){return'<div class="image-preview-item"><img src="'+img.data+'" alt="'+img.name+'"><span>'+img.name.slice(0,15)+(img.name.length>15?'...':'')+'</span><span class="remove-btn" onclick="removeImage('+i+')">âœ•</span></div>'}).join('');container.innerHTML=html}
function removeImage(index){pendingImages.splice(index,1);renderImagePreview()}
function uploadFile(){var input=document.createElement('input');input.type='file';input.accept='.txt,.md,.pdf,.doc,.docx,.json,.csv';input.onchange=function(e){var file=e.target.files[0];if(!file)return;if(file.size>10*1024*1024){alert('æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡10MB');return}var formData=new FormData();formData.append('file',file);var headers={};if(authToken)headers['Authorization']='Bearer '+authToken;fetch('/api/documents/parse',{method:'POST',headers:headers,body:formData}).then(function(r){return r.json()}).then(function(data){if(data.content){$('chatInput').value='è¯·åˆ†æä»¥ä¸‹æ–‡æ¡£å†…å®¹ï¼š\n\n'+data.content.slice(0,8000);showToast('æ–‡ä»¶å·²åŠ è½½: '+data.filename)}else{alert('è§£æå¤±è´¥')}}).catch(function(e){alert('ä¸Šä¼ å¤±è´¥: '+e.message)})};input.click()}
// è¯­éŸ³è¾“å…¥
var isRecording=false;
var mediaRecorder=null;
var audioChunks=[];
function voiceInput(){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){alert('æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³è¾“å…¥');return}if(isRecording){stopRecording();return}navigator.mediaDevices.getUserMedia({audio:true}).then(function(stream){isRecording=true;audioChunks=[];mediaRecorder=new MediaRecorder(stream);mediaRecorder.ondataavailable=function(e){audioChunks.push(e.data)};mediaRecorder.onstop=function(){var audioBlob=new Blob(audioChunks,{type:'audio/wav'});stream.getTracks().forEach(function(t){t.stop()});transcribeAudio(audioBlob)};mediaRecorder.start();showToast('ğŸ¤ æ­£åœ¨å½•éŸ³...ç‚¹å‡»åœæ­¢');document.querySelector('[onclick="voiceInput()"]').style.color='var(--error)'}).catch(function(e){alert('æ— æ³•è®¿é—®éº¦å…‹é£: '+e.message)})}
function stopRecording(){if(mediaRecorder&&isRecording){isRecording=false;mediaRecorder.stop();document.querySelector('[onclick="voiceInput()"]').style.color=''}}
function transcribeAudio(blob){showToast('æ­£åœ¨è¯†åˆ«è¯­éŸ³...');if('webkitSpeechRecognition' in window||'SpeechRecognition' in window){var SpeechRecognition=window.SpeechRecognition||window.webkitSpeechRecognition;var recognition=new SpeechRecognition();recognition.lang='zh-CN';recognition.continuous=false;recognition.interimResults=false;recognition.onresult=function(e){var text=e.results[0][0].transcript;$('chatInput').value+=text;showToast('è¯­éŸ³è¯†åˆ«å®Œæˆ')};recognition.onerror=function(e){showToast('è¯†åˆ«å¤±è´¥: '+e.error)};recognition.start()}else{showToast('æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³è¯†åˆ«ï¼Œè¯·ä½¿ç”¨Chrome')}}
function stopGeneration(){alert('å·²åœæ­¢ç”Ÿæˆ')}
function copyMessage(index){var chat=chats.find(function(c){return c.id===currentChatId});if(chat&&chat.messages[index]){navigator.clipboard.writeText(chat.messages[index].content).then(function(){alert('å·²å¤åˆ¶')})}}
function regenerateMessage(index){var chat=chats.find(function(c){return c.id===currentChatId});if(!chat)return;chat.messages=chat.messages.slice(0,index);saveChats();renderMessages();var lastUserMsg=chat.messages.filter(function(m){return m.role==='user'}).pop();if(lastUserMsg){$('chatInput').value=lastUserMsg.content;sendMessage()}}
function branchFromMessage(index){var chat=chats.find(function(c){return c.id===currentChatId});if(!chat)return;var branchId='chat_'+Date.now();var branchMessages=chat.messages.slice(0,index+1);chats.unshift({id:branchId,title:'åˆ†æ”¯: '+(chat.title||'å¯¹è¯').slice(0,15),messages:JSON.parse(JSON.stringify(branchMessages)),provider:chat.provider,model:chat.model,assistant:chat.assistant,parentId:currentChatId,branchIndex:index});saveChats();renderChats();selectChat(branchId);showToast('å·²åˆ›å»ºåˆ†æ”¯å¯¹è¯')}
function rateMessage(index){var chat=chats.find(function(c){return c.id===currentChatId});if(!chat||!chat.messages[index])return;var rating=prompt('ç»™è¿™æ¡å›å¤è¯„åˆ† (1-5åˆ†):',chat.messages[index].rating||'');if(rating===null)return;var score=parseInt(rating);if(isNaN(score)||score<1||score>5){alert('è¯·è¾“å…¥1-5çš„æ•°å­—');return}chat.messages[index].rating=score;saveChats();showToast('å·²è¯„åˆ†: '+score+'â­');if(authToken){api('/api/ratings',{method:'POST',body:JSON.stringify({conversation_id:currentChatId,message_index:index,rating:score,model:chat.model})}).catch(function(e){console.error('ä¿å­˜è¯„åˆ†å¤±è´¥:',e)})}}
function editMessage(index){var chat=chats.find(function(c){return c.id===currentChatId});if(!chat||!chat.messages[index])return;var newContent=prompt('ç¼–è¾‘æ¶ˆæ¯ï¼š',chat.messages[index].content);if(newContent!==null){chat.messages[index].content=newContent;saveChats();renderMessages()}}
function readAloud(index){var chat=chats.find(function(c){return c.id===currentChatId});if(chat&&chat.messages[index]&&'speechSynthesis' in window){var utterance=new SpeechSynthesisUtterance(chat.messages[index].content);utterance.lang='zh-CN';speechSynthesis.speak(utterance)}else{alert('æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³åˆæˆ')}}
function deleteChat(id){if(!confirm('ç¡®å®šåˆ é™¤æ­¤å¯¹è¯ï¼Ÿ'))return;chats=chats.filter(function(c){return c.id!==id});saveChats();if(currentChatId===id){currentChatId=chats[0]?chats[0].id:null;if(!currentChatId)newChat();else selectChat(currentChatId)}renderChats();showToast('å¯¹è¯å·²åˆ é™¤')}
function showChatMenu(e,id){e.preventDefault();var menu=document.createElement('div');menu.className='context-menu';menu.innerHTML='<div onclick="renameChat(\''+id+'\')">âœï¸ é‡å‘½å</div><div onclick="exportSingleChat(\''+id+'\')">ğŸ“¥ å¯¼å‡º</div><div onclick="deleteChat(\''+id+'\')" style="color:var(--error)">ğŸ—‘ï¸ åˆ é™¤</div>';menu.style.cssText='position:fixed;left:'+e.clientX+'px;top:'+e.clientY+'px;background:var(--bg2);border:1px solid var(--border);border-radius:8px;padding:4px;z-index:1000;min-width:120px';document.body.appendChild(menu);setTimeout(function(){document.addEventListener('click',function handler(){menu.remove();document.removeEventListener('click',handler)})},0)}
function renameChat(id){var chat=chats.find(function(c){return c.id===id});if(!chat)return;var newTitle=prompt('é‡å‘½åå¯¹è¯ï¼š',chat.title);if(newTitle){chat.title=newTitle;saveChats();renderChats();showToast('å·²é‡å‘½å')}}
function exportSingleChat(id){var chat=chats.find(function(c){return c.id===id});if(!chat)return;var text=chat.messages.map(function(m){return'['+m.role+']\n'+m.content}).join('\n\n---\n\n');var blob=new Blob([text],{type:'text/plain'}),a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download=(chat.title||'chat')+'.txt';a.click();showToast('å·²å¯¼å‡º')}
// ç¬”è®°è®¾ç½®
function selectNotesDir(){alert('è¯·åœ¨æ–‡ä»¶ç®¡ç†å™¨ä¸­é€‰æ‹©ç›®å½•')}
function applyNotesDir(){alert('å·¥ä½œç›®å½•å·²åº”ç”¨')}
function resetNotesDir(){$('notesWorkDir').value='C:\\Users\\legion\\AppData\\Roaming\\AIHub\\Data\\Notes';alert('å·²é‡ç½®ä¸ºé»˜è®¤ç›®å½•')}
// MCP
function refreshMcpServers(){alert('æ­£åœ¨åˆ·æ–° MCP æœåŠ¡å™¨çŠ¶æ€...')}
function showAddMcpModal(){alert('æ·»åŠ  MCP æœåŠ¡å™¨åŠŸèƒ½å¼€å‘ä¸­')}
// æ•°æ®ç®¡ç†
function openDataDir(){alert('è¯·åœ¨æ–‡ä»¶ç®¡ç†å™¨ä¸­æ‰“å¼€ï¼šC:\\Users\\legion\\AppData\\Roaming\\AIHub\\Data')}
function clearChats(){if(!confirm('ç¡®å®šæ¸…é™¤æ‰€æœ‰å¯¹è¯è®°å½•ï¼Ÿ'))return;chats=[];saveChats();renderChats();newChat();updateStats();alert('å¯¹è¯è®°å½•å·²æ¸…é™¤')}
function clearAssistants(){if(!confirm('ç¡®å®šæ¸…é™¤æ‰€æœ‰è‡ªå®šä¹‰åŠ©æ‰‹ï¼Ÿ'))return;assistants=assistants.filter(function(a){return a.isSystem});saveAssistants();renderAssistants();updateStats();alert('è‡ªå®šä¹‰åŠ©æ‰‹å·²æ¸…é™¤')}
function updateStats(){$('statChats').textContent=chats.length;$('statAssistants').textContent=assistants.length;$('statShortcuts').textContent=shortcuts.length;var size=0;for(var key in localStorage){if(localStorage.hasOwnProperty(key)){size+=localStorage[key].length*2}}$('statStorage').textContent=Math.round(size/1024)+' KB'}
// é»˜è®¤æ¨¡å‹
function initDefaultModelSelects(){var types=['chat','translate','summary','code','quick'];var html=providers.map(function(p){return'<option value="'+p.id+'">'+p.name+'</option>'}).join('');types.forEach(function(t){var pSel=$('default'+t.charAt(0).toUpperCase()+t.slice(1)+'Provider');var mSel=$('default'+t.charAt(0).toUpperCase()+t.slice(1)+'Model');if(pSel){pSel.innerHTML=html;onDefaultProviderChange(t)}})}
function onDefaultProviderChange(type){var pSel=$('default'+type.charAt(0).toUpperCase()+type.slice(1)+'Provider');var mSel=$('default'+type.charAt(0).toUpperCase()+type.slice(1)+'Model');if(!pSel||!mSel)return;var p=providers.find(function(x){return x.id===pSel.value});mSel.innerHTML=(p&&p.models?p.models:[]).map(function(m){return'<option value="'+m.id+'">'+m.name+'</option>'}).join('')}
function saveDefaultModels(){var settings={chat:{provider:$('defaultChatProvider').value,model:$('defaultChatModel').value},translate:{provider:$('defaultTranslateProvider').value,model:$('defaultTranslateModel').value},summary:{provider:$('defaultSummaryProvider').value,model:$('defaultSummaryModel').value},code:{provider:$('defaultCodeProvider').value,model:$('defaultCodeModel').value},quick:{provider:$('defaultQuickProvider').value,model:$('defaultQuickModel').value}};localStorage.setItem('defaultModels',JSON.stringify(settings));alert('é»˜è®¤æ¨¡å‹è®¾ç½®å·²ä¿å­˜')}
// æ˜¾ç¤ºè®¾ç½®
function setTheme(mode){document.body.dataset.theme=mode;localStorage.setItem('theme',mode)}
function setMsgFontSize(size){document.documentElement.style.setProperty('--msg-font-size',size+'px');event.target.nextElementSibling.textContent=size+'px'}
function saveDisplaySettings(){var settings={theme:$('themeMode').value,msgFontSize:$('msgFontSize').value,msgStyle:$('msgStyle').value,showTimestamp:$('showTimestamp').checked,showAvatar:$('showAvatar').checked,showLineNumbers:$('showLineNumbers').checked,sidebarWidth:$('sidebarWidth').value,chatListWidth:$('chatListWidth').value,showNavButtons:$('showNavButtons').checked};localStorage.setItem('displaySettings',JSON.stringify(settings));alert('æ˜¾ç¤ºè®¾ç½®å·²ä¿å­˜')}
function resetDisplaySettings(){$('themeMode').value='dark';$('msgFontSize').value=14;$('msgStyle').value='simple';$('showTimestamp').checked=false;$('showAvatar').checked=true;$('showLineNumbers').checked=false;$('sidebarWidth').value=220;$('chatListWidth').value=280;$('showNavButtons').checked=true;alert('å·²é‡ç½®ä¸ºé»˜è®¤è®¾ç½®')}
// å¸¸è§„è®¾ç½®
function saveGeneralSettings(){var settings={language:$('appLanguage').value,temp:parseFloat($('defaultTemp').value),topP:parseFloat($('defaultTopP').value),context:parseInt($('defaultContext').value),maxTokens:parseInt($('defaultMaxTokens').value),stream:$('defaultStream').checked,autoScroll:$('autoScroll').checked,msgSound:$('msgSound').checked,autoTitle:$('autoTitle').checked,enableLatex:$('enableLatex').checked,codeHighlight:$('codeHighlight').checked,codeLineNumbers:$('codeLineNumbers').checked,enterSend:$('enterSend').checked,ctrlEnterNewline:$('ctrlEnterNewline').checked,autoFocus:$('autoFocus').checked};localStorage.setItem('generalSettings',JSON.stringify(settings));chatSettings.temp=settings.temp;chatSettings.context=settings.context;chatSettings.maxTokens=settings.maxTokens;chatSettings.stream=settings.stream;alert('å¸¸è§„è®¾ç½®å·²ä¿å­˜')}
// å¿«æ·çŸ­è¯­
function renderShortcuts(){if(shortcuts.length===0){$('shortcutList').innerHTML='<div class="empty-state" style="padding:40px"><span>âš¡</span><p>æš‚æ— å¿«æ·çŸ­è¯­</p><p style="font-size:12px;margin-top:8px">ç‚¹å‡»å³ä¸Šè§’ + æ·»åŠ </p></div>';return}var html=shortcuts.map(function(s,i){return'<div class="shortcut-item" onclick="editShortcut('+i+')"><span class="shortcut-item-icon">ğŸŒ</span><span class="shortcut-item-name">'+s.name+'</span></div>'}).join('');$('shortcutList').innerHTML=html}
function showAddShortcutModal(){$('shortcutModalTitle').textContent='æ·»åŠ å¿«æ·çŸ­è¯­';$('shortcutName').value='';$('shortcutTrigger').value='';$('shortcutContent').value='';$('shortcutModal').dataset.editIndex='';showModal('shortcutModal')}
function editShortcut(i){$('shortcutModalTitle').textContent='ç¼–è¾‘å¿«æ·çŸ­è¯­';$('shortcutName').value=shortcuts[i].name;$('shortcutTrigger').value=shortcuts[i].trigger||'';$('shortcutContent').value=shortcuts[i].content;$('shortcutModal').dataset.editIndex=i;showModal('shortcutModal')}
function saveShortcutFromModal(){var name=$('shortcutName').value.trim(),content=$('shortcutContent').value.trim();if(!name||!content)return alert('è¯·å¡«å†™åç§°å’Œå†…å®¹');var idx=$('shortcutModal').dataset.editIndex;if(idx!==''){shortcuts[parseInt(idx)]={name:name,content:content,trigger:$('shortcutTrigger').value}}else{shortcuts.push({name:name,content:content,trigger:$('shortcutTrigger').value})}saveShortcuts();renderShortcuts();closeModal('shortcutModal')}
function deleteShortcut(i){if(!confirm('ç¡®å®šï¼Ÿ'))return;shortcuts.splice(i,1);saveShortcuts();renderShortcuts()}
function useShortcut(i){$('chatInput').value=shortcuts[i].content;document.querySelector('.nav-item[data-page="chat"]').click();$('chatInput').focus()}
// æ–‡æ¡£
function handleFileUpload(e){var file=e.target.files[0];if(!file)return;var formData=new FormData();formData.append('file',file);var headers={};if(authToken)headers['Authorization']='Bearer '+authToken;fetch('/api/documents/parse',{method:'POST',headers:headers,body:formData}).then(function(r){return r.json()}).then(function(data){uploadedDoc=data;$('docContent').textContent=data.content;$('docResult').style.display='block'}).catch(function(e){alert('å¤±è´¥: '+e.message)})}
function summarizeDoc(){if(!uploadedDoc)return;$('chatInput').value='è¯·æ€»ç»“ä»¥ä¸‹å†…å®¹ï¼š\n\n'+uploadedDoc.content.slice(0,5000);document.querySelector('.nav-item[data-page="chat"]').click();sendMessage()}
function askAboutDoc(){if(!uploadedDoc)return;var q=prompt('è¯·è¾“å…¥é—®é¢˜ï¼š');if(!q)return;$('chatInput').value='åŸºäºä»¥ä¸‹å†…å®¹å›ç­”ï¼š\n\n'+uploadedDoc.content.slice(0,4000)+'\n\né—®é¢˜ï¼š'+q;document.querySelector('.nav-item[data-page="chat"]').click();sendMessage()}
// æ•°æ®
function exportAllData(){var data={providers:providers,chats:chats,shortcuts:shortcuts,assistants:assistants,time:new Date().toISOString()};var blob=new Blob([JSON.stringify(data,null,2)],{type:'application/json'}),a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download='ai-hub-backup.json';a.click()}
function importData(){var input=document.createElement('input');input.type='file';input.accept='.json';input.onchange=function(e){var file=e.target.files[0];if(!file)return;var reader=new FileReader();reader.onload=function(ev){try{var data=JSON.parse(ev.target.result);if(data.providers){providers=data.providers;save()}if(data.chats){chats=data.chats;saveChats()}if(data.shortcuts){shortcuts=data.shortcuts;saveShortcuts()}if(data.assistants){assistants=data.assistants;saveAssistants()}alert('å¯¼å…¥æˆåŠŸ');location.reload()}catch(e){alert('å¤±è´¥: '+e.message)}};reader.readAsText(file)};input.click()}
function clearAllData(){if(!confirm('ç¡®å®šæ¸…é™¤æ‰€æœ‰æ•°æ®ï¼Ÿ'))return;localStorage.clear();location.reload()}
// æ•°æ®è®¾ç½®é¡µé¢åˆ‡æ¢
function switchDataTab(tab){document.querySelectorAll('.settings-sidebar-item').forEach(function(i){i.classList.remove('active')});event.target.classList.add('active');alert('åˆ‡æ¢åˆ°: '+tab+' è®¾ç½®')}
// GitHub æ¨é€
var githubSettings=JSON.parse(localStorage.getItem('githubSettings')||'{}');
function loadGithubSettings(){if(githubSettings.repoUrl)$('githubRepoUrl').value=githubSettings.repoUrl;if(githubSettings.token)$('githubToken').value=githubSettings.token;if(githubSettings.branch)$('githubBranch').value=githubSettings.branch}
function saveGithubSettings(){githubSettings={repoUrl:$('githubRepoUrl').value.trim(),token:$('githubToken').value.trim(),branch:$('githubBranch').value.trim()||'main'};localStorage.setItem('githubSettings',JSON.stringify(githubSettings));alert('GitHub è®¾ç½®å·²ä¿å­˜')}
function testGithub(){var url=$('githubRepoUrl').value.trim(),token=$('githubToken').value.trim();if(!url||!token){alert('è¯·å¡«å†™ä»“åº“åœ°å€å’Œ Token');return}fetch('/api/git/test',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({repo_url:url,token:token})}).then(function(r){return r.json()}).then(function(data){if(data.success){alert('âœ“ è¿æ¥æˆåŠŸ: '+data.repo)}else{alert('âœ— å¤±è´¥: '+data.error)}}).catch(function(e){alert('âœ— å¤±è´¥: '+e.message)})}
function pushToGithub(content,filename,message){if(!githubSettings.repoUrl||!githubSettings.token){alert('è¯·å…ˆåœ¨æ•°æ®è®¾ç½®ä¸­é…ç½® GitHub');return}var filePath=prompt('æ–‡ä»¶è·¯å¾„:',filename||'code.txt');if(!filePath)return;var commitMsg=prompt('æäº¤ä¿¡æ¯:',message||'Add code from AI Hub');if(!commitMsg)return;fetch('/api/git/push',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({repo_url:githubSettings.repoUrl,token:githubSettings.token,file_path:filePath,content:content,commit_message:commitMsg,branch:githubSettings.branch||'main'})}).then(function(r){return r.json()}).then(function(data){if(data.success){alert('âœ“ æ¨é€æˆåŠŸ!\n'+data.url)}else{alert('âœ— å¤±è´¥: '+(data.detail||'æœªçŸ¥é”™è¯¯'))}}).catch(function(e){alert('âœ— å¤±è´¥: '+e.message)})}
function pushMessageToGithub(index){var chat=chats.find(function(c){return c.id===currentChatId});if(!chat||!chat.messages[index])return;var content=chat.messages[index].content;var codeMatch=content.match(/```[\w]*\n([\s\S]*?)```/);if(codeMatch){content=codeMatch[1]}var ext=detectFileExtension(content);var choice=confirm('æ¨é€åˆ° GitHubï¼Ÿ\n\nç‚¹å‡»"ç¡®å®š"æ¨é€åˆ° GitHub\nç‚¹å‡»"å–æ¶ˆ"æ¨é€åˆ°æœ¬åœ° Git');if(choice){pushToGithub(content,'code'+ext,'Add code from AI conversation')}else{pushToLocalGit(content,'code'+ext,'Add code from AI conversation')}}
function detectFileExtension(content){if(content.includes('def ')||content.includes('import ')||content.includes('print('))return'.py';if(content.includes('function ')||content.includes('const ')||content.includes('let '))return'.js';if(content.includes('<html')||content.includes('<!DOCTYPE'))return'.html';if(content.includes('package ')||content.includes('public class'))return'.java';if(content.includes('#include'))return'.cpp';return'.txt'}
// æœ¬åœ° Git
var localGitSettings=JSON.parse(localStorage.getItem('localGitSettings')||'{}');
function loadLocalGitSettings(){if(localGitSettings.repoPath&&$('localGitPath'))$('localGitPath').value=localGitSettings.repoPath}
function saveLocalGitSettings(){localGitSettings={repoPath:$('localGitPath').value.trim()};localStorage.setItem('localGitSettings',JSON.stringify(localGitSettings));alert('æœ¬åœ° Git è®¾ç½®å·²ä¿å­˜')}
function testLocalGit(){var path=$('localGitPath').value.trim();if(!path){alert('è¯·å¡«å†™ä»“åº“è·¯å¾„');return}fetch('/api/git/local/test',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({repo_path:path})}).then(function(r){return r.json()}).then(function(data){if(data.success){alert('âœ“ ä»“åº“æœ‰æ•ˆ\nè¿œç¨‹: '+(data.remotes||'æ— '))}else{alert('âœ— å¤±è´¥: '+data.error)}}).catch(function(e){alert('âœ— å¤±è´¥: '+e.message)})}
function pushToLocalGit(content,filename,message){if(!localGitSettings.repoPath){alert('è¯·å…ˆåœ¨æ•°æ®è®¾ç½®ä¸­é…ç½®æœ¬åœ° Git ä»“åº“è·¯å¾„');return}var filePath=prompt('æ–‡ä»¶è·¯å¾„:',filename||'code.txt');if(!filePath)return;var commitMsg=prompt('æäº¤ä¿¡æ¯:',message||'Add code from AI Hub');if(!commitMsg)return;fetch('/api/git/local/push',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({repo_path:localGitSettings.repoPath,file_path:filePath,content:content,commit_message:commitMsg})}).then(function(r){return r.json()}).then(function(data){if(data.success){alert('âœ“ '+data.message)}else{alert('âœ— å¤±è´¥: '+(data.detail||data.error||'æœªçŸ¥é”™è¯¯'))}}).catch(function(e){alert('âœ— å¤±è´¥: '+e.message)})}
// åˆå§‹åŒ–
marked.setOptions({breaks:true,highlight:function(code,lang){return lang&&hljs.getLanguage(lang)?hljs.highlight(code,{language:lang}).value:code}});
renderProviders();if(providers.length)selectProvider(providers[0].id);updateChatProviders();initDefaultModelSelects();initCompareModels();loadPrompts();renderAssistants();if(assistants.length)selectAssistant(assistants[0].id);renderChats();if(chats.length===0)newChat();else selectChat(chats[0].id);renderShortcuts();renderNotes();renderMemories();checkAuth();updateStats();loadGithubSettings();loadLocalGitSettings();
// å¿«æ·é”®
document.addEventListener('keydown',function(e){
if((e.ctrlKey||e.metaKey)&&e.key==='n'){e.preventDefault();newChat();showToast('æ–°å»ºå¯¹è¯')}
if((e.ctrlKey||e.metaKey)&&e.key==='/'){e.preventDefault();showModal('hotkeyHelpModal')}
if((e.ctrlKey||e.metaKey)&&e.key===','){e.preventDefault();document.querySelector('.nav-item[data-page="general"]').click()}
if((e.ctrlKey||e.metaKey)&&e.key==='k'){e.preventDefault();showSearchModal()}
if((e.ctrlKey||e.metaKey)&&e.key==='d'){e.preventDefault();toggleTheme()}
if((e.ctrlKey||e.metaKey)&&e.shiftKey&&e.key==='E'){e.preventDefault();exportChat('md')}
if(e.key==='Escape'){document.querySelectorAll('.modal.show').forEach(function(m){m.classList.remove('show')});hideSearchModal()}
});
// ä¸»é¢˜åˆ‡æ¢
function toggleTheme(){var current=document.documentElement.getAttribute('data-theme');var newTheme=current==='light'?'dark':'light';document.documentElement.setAttribute('data-theme',newTheme);localStorage.setItem('theme',newTheme);showToast(newTheme==='light'?'â˜€ï¸ äº®è‰²æ¨¡å¼':'ğŸŒ™ æš—è‰²æ¨¡å¼')}
function initTheme(){var saved=localStorage.getItem('theme');if(saved)document.documentElement.setAttribute('data-theme',saved)}
initTheme();
// å…¨å±€æœç´¢
var searchModal=null;
function showSearchModal(){if(!searchModal){searchModal=document.createElement('div');searchModal.innerHTML='<div style="position:fixed;inset:0;background:rgba(0,0,0,0.6);z-index:2000;display:flex;align-items:flex-start;justify-content:center;padding-top:100px" onclick="if(event.target===this)hideSearchModal()"><div style="background:var(--bg2);border-radius:16px;width:90%;max-width:600px;overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,0.3)"><div style="padding:16px;border-bottom:1px solid var(--border)"><input type="text" id="globalSearchInput" placeholder="æœç´¢å¯¹è¯å†…å®¹... (Ctrl+K)" style="width:100%;padding:12px 16px;border:none;background:var(--bg);border-radius:8px;color:var(--text);font-size:16px" oninput="doGlobalSearch(this.value)"></div><div id="searchResults" style="max-height:400px;overflow-y:auto;padding:8px"></div><div style="padding:12px 16px;border-top:1px solid var(--border);font-size:12px;color:var(--text2)">ğŸ’¡ Ctrl+D åˆ‡æ¢ä¸»é¢˜ Â· Ctrl+N æ–°å»ºå¯¹è¯ Â· Ctrl+Shift+E å¯¼å‡º</div></div></div>';document.body.appendChild(searchModal)}searchModal.style.display='block';setTimeout(function(){$('globalSearchInput').focus()},100)}
function hideSearchModal(){if(searchModal)searchModal.style.display='none'}
function doGlobalSearch(q){if(!q||q.length<2){$('searchResults').innerHTML='<div style="padding:40px;text-align:center;color:var(--text2)">è¾“å…¥å…³é”®è¯æœç´¢...</div>';return}var results=[];chats.forEach(function(c){c.messages.forEach(function(m,i){if(typeof m.content==='string'&&m.content.toLowerCase().includes(q.toLowerCase())){results.push({chatId:c.id,chatTitle:c.title,msgIndex:i,role:m.role,content:m.content,match:q})}})});if(results.length===0){$('searchResults').innerHTML='<div style="padding:40px;text-align:center;color:var(--text2)">æœªæ‰¾åˆ°ç»“æœ</div>';return}var html=results.slice(0,20).map(function(r){var snippet=r.content.substring(0,150).replace(new RegExp('('+q+')','gi'),'<mark style="background:var(--warning);color:#000;padding:0 2px;border-radius:2px">$1</mark>');return'<div style="padding:12px 16px;cursor:pointer;border-bottom:1px solid var(--border)" onclick="goToSearchResult(\''+r.chatId+'\','+r.msgIndex+')" onmouseover="this.style.background=\'var(--bg3)\'" onmouseout="this.style.background=\'\'"><div style="font-size:13px;color:var(--text2);margin-bottom:4px">'+(r.role==='user'?'ğŸ‘¤':'ğŸ¤–')+' '+r.chatTitle+'</div><div style="font-size:14px;line-height:1.5">'+snippet+'...</div></div>'}).join('');$('searchResults').innerHTML=html}
function goToSearchResult(chatId,msgIndex){hideSearchModal();selectChat(chatId);setTimeout(function(){var msgs=document.querySelectorAll('.message');if(msgs[msgIndex]){msgs[msgIndex].scrollIntoView({behavior:'smooth',block:'center'});msgs[msgIndex].style.background='var(--accent)';msgs[msgIndex].style.transition='background 0.3s';setTimeout(function(){msgs[msgIndex].style.background=''},1500)}},200)}
// Token ä¼°ç®—
function estimateTokens(){var text=$('chatInput').value;if(!text)return;fetch('/api/tokens/estimate',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({text:text,model:$('chatModel').value})}).then(function(r){return r.json()}).then(function(data){showToast('é¢„ä¼° '+data.tokens+' tokens'+(data.estimated?' (ä¼°ç®—)':''))}).catch(function(e){console.error(e)})}
function showToast(msg){var toast=document.createElement('div');toast.className='toast';toast.textContent=msg;document.body.appendChild(toast);setTimeout(function(){toast.remove()},2000)}
// Prompt æ¨¡æ¿
var promptTemplates=[];
var currentPromptCategory='all';
function loadPrompts(){api('/api/prompts').then(function(data){promptTemplates=data;renderPrompts()}).catch(function(e){console.error('åŠ è½½æ¨¡æ¿å¤±è´¥:',e)})}
function renderPrompts(){var filtered=currentPromptCategory==='all'?promptTemplates:promptTemplates.filter(function(p){return p.category===currentPromptCategory});if(filtered.length===0){$('promptList').innerHTML='<div style="grid-column:1/-1;text-align:center;padding:40px;color:var(--text2)"><span style="font-size:48px;display:block;margin-bottom:16px">ğŸ“‹</span><p>æš‚æ— æ¨¡æ¿</p><p style="font-size:12px;margin-top:8px">ç‚¹å‡»å³ä¸Šè§’æ–°å»ºæ¨¡æ¿</p></div>';return}var html=filtered.map(function(p){return'<div style="background:var(--bg);border-radius:12px;padding:16px;cursor:pointer" onclick="usePrompt('+p.id+')" oncontextmenu="showPromptMenu(event,'+p.id+')"><div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px"><strong style="font-size:14px">'+p.name+'</strong><span style="font-size:11px;padding:2px 8px;background:var(--bg3);border-radius:4px">'+getCategoryEmoji(p.category)+'</span></div><div style="font-size:13px;color:var(--text2);line-height:1.5;max-height:60px;overflow:hidden">'+p.content.slice(0,100)+'...</div><div style="margin-top:12px;font-size:11px;color:var(--text2)">ä½¿ç”¨ '+p.use_count+' æ¬¡</div></div>'}).join('');$('promptList').innerHTML=html}
function getCategoryEmoji(cat){var map={writing:'âœï¸',coding:'ğŸ’»',translate:'ğŸŒ',analysis:'ğŸ“Š',creative:'ğŸ¨',general:'ğŸ“‹'};return map[cat]||'ğŸ“‹'}
function filterPrompts(cat,btn){currentPromptCategory=cat;document.querySelectorAll('.prompt-cat-btn').forEach(function(b){b.classList.remove('active')});if(btn)btn.classList.add('active');renderPrompts()}
function usePrompt(id){var p=promptTemplates.find(function(x){return x.id===id});if(!p)return;$('chatInput').value=p.content;document.querySelector('.nav-item[data-page="chat"]').click();$('chatInput').focus();fetch('/api/prompts/'+id+'/use',{method:'POST'});showToast('å·²åº”ç”¨æ¨¡æ¿')}
function showAddPromptModal(){var html='<div class="form-group"><label>åç§°</label><input type="text" id="promptName" placeholder="æ¨¡æ¿åç§°"></div><div class="form-group"><label>åˆ†ç±»</label><select id="promptCategory"><option value="general">é€šç”¨</option><option value="writing">å†™ä½œ</option><option value="coding">ç¼–ç¨‹</option><option value="translate">ç¿»è¯‘</option><option value="analysis">åˆ†æ</option><option value="creative">åˆ›æ„</option></select></div><div class="form-group"><label>å†…å®¹</label><textarea id="promptContent" rows="6" placeholder="è¾“å…¥ Prompt å†…å®¹..."></textarea></div><div style="display:flex;gap:12px"><button class="btn btn-primary" onclick="savePrompt()">ä¿å­˜</button><button class="btn btn-ghost" onclick="closeModal(\'promptModal\')">å–æ¶ˆ</button></div>';showCustomModal('æ–°å»º Prompt æ¨¡æ¿',html,'promptModal')}
function savePrompt(){var name=$('promptName').value.trim(),content=$('promptContent').value.trim(),category=$('promptCategory').value;if(!name||!content){alert('è¯·å¡«å†™åç§°å’Œå†…å®¹');return}api('/api/prompts',{method:'POST',body:JSON.stringify({name:name,content:content,category:category})}).then(function(){closeModal('promptModal');loadPrompts();showToast('æ¨¡æ¿å·²ä¿å­˜')}).catch(function(e){alert('ä¿å­˜å¤±è´¥: '+e.message)})}
function showCustomModal(title,content,id){var modal=document.createElement('div');modal.id=id;modal.className='modal show';modal.innerHTML='<div class="modal-content"><div class="modal-header"><h3>'+title+'</h3><span style="cursor:pointer;font-size:20px" onclick="closeModal(\''+id+'\')">&times;</span></div><div class="modal-body">'+content+'</div></div>';document.body.appendChild(modal)}
function closeModal(id){var m=document.getElementById(id);if(m)m.remove()}
function showPromptMenu(e,id){e.preventDefault();var menu=document.createElement('div');menu.className='context-menu';menu.innerHTML='<div onclick="editPrompt('+id+')">âœï¸ ç¼–è¾‘</div><div onclick="deletePrompt('+id+')" style="color:var(--error)">ğŸ—‘ï¸ åˆ é™¤</div>';menu.style.cssText='position:fixed;left:'+e.clientX+'px;top:'+e.clientY+'px;background:var(--bg2);border:1px solid var(--border);border-radius:8px;padding:4px;z-index:1000;min-width:100px';document.body.appendChild(menu);setTimeout(function(){document.addEventListener('click',function handler(){menu.remove();document.removeEventListener('click',handler)})},0)}
function deletePrompt(id){if(!confirm('ç¡®å®šåˆ é™¤ï¼Ÿ'))return;api('/api/prompts/'+id,{method:'DELETE'}).then(function(){loadPrompts();showToast('å·²åˆ é™¤')}).catch(function(e){alert('åˆ é™¤å¤±è´¥: '+e.message)})}
// æ¨¡å‹å¯¹æ¯”
var selectedCompareModels=[];
function initCompareModels(){var html='';providers.forEach(function(p){if(p.models&&p.models.length>0){p.models.slice(0,5).forEach(function(m){var id=p.id+'_'+m.id;var checked=selectedCompareModels.includes(id)?'checked':'';html+='<label style="display:flex;align-items:center;gap:6px;padding:8px 12px;background:var(--bg);border-radius:8px;cursor:pointer;font-size:13px"><input type="checkbox" onchange="toggleCompareModel(\''+p.id+'\',\''+m.id+'\',\''+p.url+'\',\''+p.key+'\')" '+checked+'><span>'+p.name+'/'+m.name+'</span></label>'})}});$('compareModelList').innerHTML=html||'<span style="color:var(--text2)">è¯·å…ˆåœ¨æ¨¡å‹æœåŠ¡ä¸­æ·»åŠ æ¨¡å‹</span>'}
function toggleCompareModel(pid,mid,url,key){var id=pid+'_'+mid;var idx=selectedCompareModels.findIndex(function(m){return m.id===id});if(idx>=0){selectedCompareModels.splice(idx,1)}else if(selectedCompareModels.length<5){selectedCompareModels.push({id:id,provider:pid,model:mid,custom_url:url,api_key:key})}}
function runCompare(){var question=$('compareQuestion').value.trim();if(!question){alert('è¯·è¾“å…¥é—®é¢˜');return}if(selectedCompareModels.length<2){alert('è¯·è‡³å°‘é€‰æ‹©2ä¸ªæ¨¡å‹');return}$('compareResults').style.display='block';$('compareResultsContent').innerHTML='<div style="text-align:center;padding:40px;color:var(--text2)"><div class="message-loading"><div class="dots"><span></span><span></span><span></span></div></div><p style="margin-top:12px">æ­£åœ¨å¯¹æ¯” '+selectedCompareModels.length+' ä¸ªæ¨¡å‹...</p></div>';var models=selectedCompareModels.map(function(m){var p=providers.find(function(x){return x.id===m.provider});return{provider:m.provider,model:m.model,custom_url:p?p.url:'',api_key:p?p.key:''}});fetch('/api/compare',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({message:question,models:models})}).then(function(r){return r.json()}).then(function(data){renderCompareResults(data)}).catch(function(e){$('compareResultsContent').innerHTML='<div style="color:var(--error);padding:20px">å¯¹æ¯”å¤±è´¥: '+e.message+'</div>'})}
function renderCompareResults(data){var html='<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:16px">';data.results.forEach(function(r){var statusColor=r.success?'var(--success)':'var(--error)';html+='<div style="background:var(--bg);border-radius:12px;padding:16px;border-left:4px solid '+statusColor+'"><div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px"><strong>'+r.provider+'/'+r.model+'</strong><span style="font-size:12px;color:var(--text2)">'+r.latency+'s</span></div>';if(r.success){html+='<div style="font-size:14px;line-height:1.6;max-height:200px;overflow-y:auto">'+marked.parse(r.content)+'</div><div style="margin-top:12px;font-size:12px;color:var(--text2)">Tokens: '+r.tokens+'</div>'}else{html+='<div style="color:var(--error)">é”™è¯¯: '+r.error+'</div>'}html+='</div>'});html+='</div>';$('compareResultsContent').innerHTML=html}
// åˆ†äº«å¯¹è¯
function shareChat(){if(!authToken){alert('è¯·å…ˆç™»å½•');return}if(!currentChatId){alert('è¯·å…ˆé€‰æ‹©å¯¹è¯');return}api('/api/conversations/'+currentChatId+'/share',{method:'POST'}).then(function(data){var url=window.location.origin+data.url;if(navigator.clipboard){navigator.clipboard.writeText(url);showToast('åˆ†äº«é“¾æ¥å·²å¤åˆ¶!')}prompt('åˆ†äº«é“¾æ¥ (7å¤©æœ‰æ•ˆ):',url)}).catch(function(e){alert('åˆ†äº«å¤±è´¥: '+e.message)})}
// API Token ç®¡ç†
function loadTokens(){api('/api/tokens').then(function(data){if(data.length===0){$('tokenList').innerHTML='<div style="text-align:center;padding:40px;color:var(--text2)">æš‚æ—  Token</div>';return}var html=data.map(function(t){return'<div style="display:flex;justify-content:space-between;align-items:center;padding:16px;background:var(--bg);border-radius:10px;margin-bottom:8px"><div><strong>'+t.name+'</strong><div style="font-size:12px;color:var(--text2);margin-top:4px;font-family:monospace">'+t.token+'</div><div style="font-size:11px;color:var(--text2);margin-top:4px">åˆ›å»ºäº '+(t.created_at||'').slice(0,10)+'</div></div><button class="btn btn-danger btn-sm" onclick="deleteToken('+t.id+')">åˆ é™¤</button></div>'}).join('');$('tokenList').innerHTML=html}).catch(function(e){$('tokenList').innerHTML='<div style="color:var(--error);padding:20px">åŠ è½½å¤±è´¥ï¼Œè¯·å…ˆç™»å½•</div>'})}
function showCreateTokenModal(){var html='<div class="form-group"><label>åç§°</label><input type="text" id="tokenName" placeholder="æˆ‘çš„åº”ç”¨"></div><div class="form-group"><label>æœ‰æ•ˆæœŸï¼ˆå¤©ï¼‰</label><input type="number" id="tokenExpires" value="30" min="1" max="365"></div><div style="display:flex;gap:12px"><button class="btn btn-primary" onclick="createToken()">åˆ›å»º</button><button class="btn btn-ghost" onclick="closeModal(\'tokenModal\')">å–æ¶ˆ</button></div>';showCustomModal('åˆ›å»º API Token',html,'tokenModal')}
function createToken(){var name=$('tokenName').value.trim()||'API Token';var days=parseInt($('tokenExpires').value)||30;api('/api/tokens',{method:'POST',body:JSON.stringify({name:name,expires_days:days})}).then(function(data){closeModal('tokenModal');prompt('Token å·²åˆ›å»ºï¼ˆä»…æ˜¾ç¤ºä¸€æ¬¡ï¼‰:',data.token);loadTokens()}).catch(function(e){alert('åˆ›å»ºå¤±è´¥: '+e.message)})}
function deleteToken(id){if(!confirm('ç¡®å®šåˆ é™¤ï¼Ÿ'))return;api('/api/tokens/'+id,{method:'DELETE'}).then(function(){loadTokens();showToast('å·²åˆ é™¤')}).catch(function(e){alert('åˆ é™¤å¤±è´¥: '+e.message)})}
// å›¢é˜Ÿç©ºé—´
function loadTeams(){api('/api/teams').then(function(data){if(data.length===0){$('teamList').innerHTML='<div style="text-align:center;padding:40px;color:var(--text2)">æš‚æ— å›¢é˜Ÿ</div>';return}var html=data.map(function(t){return'<div style="display:flex;justify-content:space-between;align-items:center;padding:16px;background:var(--bg);border-radius:10px;margin-bottom:8px"><div><strong>'+t.name+'</strong><div style="font-size:12px;color:var(--text2);margin-top:4px">è§’è‰²: '+t.role+'</div></div><button class="btn btn-ghost btn-sm" onclick="manageTeam('+t.id+')">ç®¡ç†</button></div>'}).join('');$('teamList').innerHTML=html}).catch(function(e){$('teamList').innerHTML='<div style="color:var(--error);padding:20px">åŠ è½½å¤±è´¥ï¼Œè¯·å…ˆç™»å½•</div>'})}
function showCreateTeamModal(){var html='<div class="form-group"><label>å›¢é˜Ÿåç§°</label><input type="text" id="teamName" placeholder="æˆ‘çš„å›¢é˜Ÿ"></div><div style="display:flex;gap:12px"><button class="btn btn-primary" onclick="createTeam()">åˆ›å»º</button><button class="btn btn-ghost" onclick="closeModal(\'teamModal\')">å–æ¶ˆ</button></div>';showCustomModal('åˆ›å»ºå›¢é˜Ÿ',html,'teamModal')}
function createTeam(){var name=$('teamName').value.trim();if(!name){alert('è¯·è¾“å…¥å›¢é˜Ÿåç§°');return}api('/api/teams',{method:'POST',body:JSON.stringify({name:name})}).then(function(){closeModal('teamModal');loadTeams();showToast('å›¢é˜Ÿå·²åˆ›å»º')}).catch(function(e){alert('åˆ›å»ºå¤±è´¥: '+e.message)})}
function manageTeam(id){alert('å›¢é˜Ÿç®¡ç†åŠŸèƒ½å¼€å‘ä¸­')}
// çŸ¥è¯†åº“
function loadKnowledgeBases(){api('/api/knowledge-bases').then(function(data){if(data.length===0){$('kbList').innerHTML='<div style="text-align:center;padding:40px;color:var(--text2)">æš‚æ— çŸ¥è¯†åº“</div>';return}var html=data.map(function(kb){return'<div style="display:flex;justify-content:space-between;align-items:center;padding:16px;background:var(--bg);border-radius:10px;margin-bottom:8px"><div><strong>ğŸ“š '+kb.name+'</strong><div style="font-size:12px;color:var(--text2);margin-top:4px">'+(kb.description||'æ— æè¿°')+'</div></div><div style="display:flex;gap:8px"><button class="btn btn-ghost btn-sm" onclick="uploadToKB('+kb.id+')">ä¸Šä¼ æ–‡æ¡£</button><button class="btn btn-ghost btn-sm" onclick="searchKB('+kb.id+')">æœç´¢</button></div></div>'}).join('');$('kbList').innerHTML=html}).catch(function(e){$('kbList').innerHTML='<div style="color:var(--error);padding:20px">åŠ è½½å¤±è´¥ï¼Œè¯·å…ˆç™»å½•</div>'})}
function showCreateKBModal(){var html='<div class="form-group"><label>åç§°</label><input type="text" id="kbName" placeholder="æˆ‘çš„çŸ¥è¯†åº“"></div><div class="form-group"><label>æè¿°</label><input type="text" id="kbDesc" placeholder="å¯é€‰"></div><div style="display:flex;gap:12px"><button class="btn btn-primary" onclick="createKB()">åˆ›å»º</button><button class="btn btn-ghost" onclick="closeModal(\'kbModal\')">å–æ¶ˆ</button></div>';showCustomModal('åˆ›å»ºçŸ¥è¯†åº“',html,'kbModal')}
function createKB(){var name=$('kbName').value.trim();if(!name){alert('è¯·è¾“å…¥åç§°');return}api('/api/knowledge-bases',{method:'POST',body:JSON.stringify({name:name,description:$('kbDesc').value})}).then(function(){closeModal('kbModal');loadKnowledgeBases();showToast('çŸ¥è¯†åº“å·²åˆ›å»º')}).catch(function(e){alert('åˆ›å»ºå¤±è´¥: '+e.message)})}
function uploadToKB(kbId){var input=document.createElement('input');input.type='file';input.accept='.txt,.md,.pdf,.doc,.docx';input.onchange=function(e){var file=e.target.files[0];if(!file)return;var formData=new FormData();formData.append('file',file);var headers={};if(authToken)headers['Authorization']='Bearer '+authToken;fetch('/api/knowledge-bases/'+kbId+'/documents',{method:'POST',headers:headers,body:formData}).then(function(r){return r.json()}).then(function(data){if(data.success){showToast('æ–‡æ¡£å·²ä¸Šä¼ : '+data.filename)}else{alert('ä¸Šä¼ å¤±è´¥')}}).catch(function(e){alert('ä¸Šä¼ å¤±è´¥: '+e.message)})};input.click()}
function searchKB(kbId){var q=prompt('è¾“å…¥æœç´¢å…³é”®è¯:');if(!q)return;api('/api/knowledge-bases/'+kbId+'/search?q='+encodeURIComponent(q)).then(function(data){if(data.length===0){alert('æœªæ‰¾åˆ°ç»“æœ');return}var result=data.map(function(d){return d.filename+': '+d.content.slice(0,200)+'...'}).join('\n\n');alert('æœç´¢ç»“æœ:\n\n'+result)}).catch(function(e){alert('æœç´¢å¤±è´¥: '+e.message)})}
// ç§»åŠ¨ç«¯èœå•
function toggleMobileNav(){document.querySelector('.nav').classList.toggle('show');document.querySelector('.mobile-overlay').classList.toggle('show')}
function toggleMobileSidebar(){document.querySelector('.sidebar').classList.toggle('show');document.querySelector('.mobile-overlay').classList.toggle('show')}
function closeMobileMenus(){document.querySelector('.nav').classList.remove('show');document.querySelector('.sidebar').classList.remove('show');document.querySelector('.mobile-overlay').classList.remove('show')}
console.log('ğŸ¤– AI Hub v1.8.0');
</script>
</body>
</html>
